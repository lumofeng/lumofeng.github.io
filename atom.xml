<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å¢¨æ«ä¸ªäººåšå®¢</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2023-08-06T15:22:07.141Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>å¢¨æ«</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>è‹¥ä¾æ¡†æ¶ä½¿ç”¨æ•™ç¨‹</title>
    <link href="http://example.com/2023/08/07/%E8%8B%A5%E4%BE%9D%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <id>http://example.com/2023/08/07/%E8%8B%A5%E4%BE%9D%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</id>
    <published>2023-08-06T17:07:30.562Z</published>
    <updated>2023-08-06T15:22:07.141Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è‹¥ä¾ä½¿ç”¨æ•™ç¨‹"><a href="#è‹¥ä¾ä½¿ç”¨æ•™ç¨‹" class="headerlink" title="è‹¥ä¾ä½¿ç”¨æ•™ç¨‹"></a>è‹¥ä¾ä½¿ç”¨æ•™ç¨‹</h1><h2 id="è‹¥ä¾æ¡†æ¶ä»‹ç»"><a href="#è‹¥ä¾æ¡†æ¶ä»‹ç»" class="headerlink" title="è‹¥ä¾æ¡†æ¶ä»‹ç»"></a>è‹¥ä¾æ¡†æ¶ä»‹ç»</h2><p>å®˜ç½‘ï¼š<a href="https://doc.ruoyi.vip/">RuoYi</a></p><p>gitee æºç ä¸‹è½½ï¼š<a href="https://gitee.com/y_project/RuoYi-Vue">RuoYi-Vue: ğŸ‰ åŸºäºSpringBootï¼ŒSpring Securityï¼ŒJWTï¼ŒVue &amp; Element çš„å‰åç«¯åˆ†ç¦»æƒé™ç®¡ç†ç³»ç»Ÿï¼ŒåŒæ—¶æä¾›äº† Vue3 çš„ç‰ˆæœ¬ (gitee.com)</a></p><h3 id="é‡‡ç”¨çš„æŠ€æœ¯ï¼š"><a href="#é‡‡ç”¨çš„æŠ€æœ¯ï¼š" class="headerlink" title="é‡‡ç”¨çš„æŠ€æœ¯ï¼š"></a>é‡‡ç”¨çš„æŠ€æœ¯ï¼š</h3><ul><li>å‰ç«¯é‡‡ç”¨Vueã€Element UIã€‚</li><li>åç«¯é‡‡ç”¨Spring Bootã€Spring Securityã€Redis &amp; Jwtã€‚</li><li>æƒé™è®¤è¯ä½¿ç”¨ Jwtï¼Œæ”¯æŒå¤šç»ˆç«¯è®¤è¯ç³»ç»Ÿã€‚</li><li>æ”¯æŒåŠ è½½åŠ¨æ€æƒé™èœå•ï¼Œå¤šæ–¹å¼è½»æ¾æƒé™æ§åˆ¶ã€‚</li><li>é«˜æ•ˆç‡å¼€å‘ï¼Œä½¿ç”¨ä»£ç ç”Ÿæˆå™¨å¯ä»¥ä¸€é”®ç”Ÿæˆå‰åç«¯ä»£ç ã€‚</li><li>æä¾›äº†æŠ€æœ¯æ ˆï¼ˆ<a href="https://gitee.com/link?target=https://v3.cn.vuejs.org">Vue3</a> <a href="https://gitee.com/link?target=https://element-plus.org/zh-CN">Element Plus</a> <a href="https://gitee.com/link?target=https://cn.vitejs.dev">Vite</a>ï¼‰ç‰ˆæœ¬<a href="https://gitee.com/link?target=https://github.com/yangzongzhuan/RuoYi-Vue3">RuoYi-Vue3</a>ï¼Œä¿æŒåŒæ­¥æ›´æ–°ã€‚</li></ul><h3 id="å†…ç½®åŠŸèƒ½"><a href="#å†…ç½®åŠŸèƒ½" class="headerlink" title="å†…ç½®åŠŸèƒ½"></a>å†…ç½®åŠŸèƒ½</h3><ol><li>ç”¨æˆ·ç®¡ç†ï¼šç”¨æˆ·æ˜¯ç³»ç»Ÿæ“ä½œè€…ï¼Œè¯¥åŠŸèƒ½ä¸»è¦å®Œæˆç³»ç»Ÿç”¨æˆ·é…ç½®ã€‚</li><li>éƒ¨é—¨ç®¡ç†ï¼šé…ç½®ç³»ç»Ÿç»„ç»‡æœºæ„ï¼ˆå…¬å¸ã€éƒ¨é—¨ã€å°ç»„ï¼‰ï¼Œæ ‘ç»“æ„å±•ç°æ”¯æŒæ•°æ®æƒé™ã€‚</li><li>å²—ä½ç®¡ç†ï¼šé…ç½®ç³»ç»Ÿç”¨æˆ·æ‰€å±æ‹…ä»»èŒåŠ¡ã€‚</li><li>èœå•ç®¡ç†ï¼šé…ç½®ç³»ç»Ÿèœå•ï¼Œæ“ä½œæƒé™ï¼ŒæŒ‰é’®æƒé™æ ‡è¯†ç­‰ã€‚</li><li>è§’è‰²ç®¡ç†ï¼šè§’è‰²èœå•æƒé™åˆ†é…ã€è®¾ç½®è§’è‰²æŒ‰æœºæ„è¿›è¡Œæ•°æ®èŒƒå›´æƒé™åˆ’åˆ†ã€‚</li><li>å­—å…¸ç®¡ç†ï¼šå¯¹ç³»ç»Ÿä¸­ç»å¸¸ä½¿ç”¨çš„ä¸€äº›è¾ƒä¸ºå›ºå®šçš„æ•°æ®è¿›è¡Œç»´æŠ¤ã€‚</li><li>å‚æ•°ç®¡ç†ï¼šå¯¹ç³»ç»ŸåŠ¨æ€é…ç½®å¸¸ç”¨å‚æ•°ã€‚</li><li>é€šçŸ¥å…¬å‘Šï¼šç³»ç»Ÿé€šçŸ¥å…¬å‘Šä¿¡æ¯å‘å¸ƒç»´æŠ¤ã€‚</li><li>æ“ä½œæ—¥å¿—ï¼šç³»ç»Ÿæ­£å¸¸æ“ä½œæ—¥å¿—è®°å½•å’ŒæŸ¥è¯¢ï¼›ç³»ç»Ÿå¼‚å¸¸ä¿¡æ¯æ—¥å¿—è®°å½•å’ŒæŸ¥è¯¢ã€‚</li><li>ç™»å½•æ—¥å¿—ï¼šç³»ç»Ÿç™»å½•æ—¥å¿—è®°å½•æŸ¥è¯¢åŒ…å«ç™»å½•å¼‚å¸¸ã€‚</li><li>åœ¨çº¿ç”¨æˆ·ï¼šå½“å‰ç³»ç»Ÿä¸­æ´»è·ƒç”¨æˆ·çŠ¶æ€ç›‘æ§ã€‚</li><li>å®šæ—¶ä»»åŠ¡ï¼šåœ¨çº¿ï¼ˆæ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤)ä»»åŠ¡è°ƒåº¦åŒ…å«æ‰§è¡Œç»“æœæ—¥å¿—ã€‚</li><li>ä»£ç ç”Ÿæˆï¼šå‰åç«¯ä»£ç çš„ç”Ÿæˆï¼ˆjavaã€htmlã€xmlã€sqlï¼‰æ”¯æŒCRUDä¸‹è½½ ã€‚</li><li>ç³»ç»Ÿæ¥å£ï¼šæ ¹æ®ä¸šåŠ¡ä»£ç è‡ªåŠ¨ç”Ÿæˆç›¸å…³çš„apiæ¥å£æ–‡æ¡£ã€‚</li><li>æœåŠ¡ç›‘æ§ï¼šç›‘è§†å½“å‰ç³»ç»ŸCPUã€å†…å­˜ã€ç£ç›˜ã€å †æ ˆç­‰ç›¸å…³ä¿¡æ¯ã€‚</li><li>ç¼“å­˜ç›‘æ§ï¼šå¯¹ç³»ç»Ÿçš„ç¼“å­˜ä¿¡æ¯æŸ¥è¯¢ï¼Œå‘½ä»¤ç»Ÿè®¡ç­‰ã€‚</li><li>åœ¨çº¿æ„å»ºå™¨ï¼šæ‹–åŠ¨è¡¨å•å…ƒç´ ç”Ÿæˆç›¸åº”çš„HTMLä»£ç ã€‚</li><li>è¿æ¥æ± ç›‘è§†ï¼šç›‘è§†å½“å‰ç³»ç»Ÿæ•°æ®åº“è¿æ¥æ± çŠ¶æ€ï¼Œå¯è¿›è¡Œåˆ†æSQLæ‰¾å‡ºç³»ç»Ÿæ€§èƒ½ç“¶é¢ˆã€‚</li></ol><h2 id="å¦‚ä½•å¿«é€Ÿæ­å»ºè‹¥ä¾é¡¹ç›®"><a href="#å¦‚ä½•å¿«é€Ÿæ­å»ºè‹¥ä¾é¡¹ç›®" class="headerlink" title="å¦‚ä½•å¿«é€Ÿæ­å»ºè‹¥ä¾é¡¹ç›®"></a>å¦‚ä½•å¿«é€Ÿæ­å»ºè‹¥ä¾é¡¹ç›®</h2><h3 id="ä¸‹è½½æºç "><a href="#ä¸‹è½½æºç " class="headerlink" title="ä¸‹è½½æºç "></a>ä¸‹è½½æºç </h3><p>RuoYi-Vue: ğŸ‰ åŸºäºSpringBootï¼ŒSpring Securityï¼ŒJWTï¼ŒVue &amp; Element çš„å‰åç«¯åˆ†ç¦»æƒé™ç®¡ç†ç³»ç»Ÿï¼ŒåŒæ—¶æä¾›äº† Vue3 çš„ç‰ˆæœ¬ (gitee.com)</p><h3 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h3><ol><li>ruoyi-ui ç›®å½•å­˜æ”¾çš„æ˜¯å‰ç«¯ä»£ç </li><li>sql ç›®å½•å­˜æ”¾çš„æ˜¯ SQL è„šæœ¬ï¼Œéœ€è¦å»æ•°æ®åº“æ‰§è¡Œ</li><li>å…¶ä½™ä¸ºåç«¯ä»£ç </li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062252185.png" alt="image-20230806225219176"></p><h3 id="å¯åŠ¨åç«¯é¡¹ç›®"><a href="#å¯åŠ¨åç«¯é¡¹ç›®" class="headerlink" title="å¯åŠ¨åç«¯é¡¹ç›®"></a>å¯åŠ¨åç«¯é¡¹ç›®</h3><h4 id="ä¿®æ”¹åœ¨-ruoyi-admin-ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹åœ¨-ruoyi-admin-ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹åœ¨ ruoyi-admin ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹åœ¨ ruoyi-admin ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶</h4><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062302157.png" alt="image-20230806230239418"></p><h4 id="ä¿®æ”¹-application-druid-yml-æ•°æ®åº“è¿æ¥"><a href="#ä¿®æ”¹-application-druid-yml-æ•°æ®åº“è¿æ¥" class="headerlink" title="ä¿®æ”¹ application-druid.yml æ•°æ®åº“è¿æ¥"></a>ä¿®æ”¹ application-druid.yml æ•°æ®åº“è¿æ¥</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸»åº“æ•°æ®æº</span></span><br><span class="line"><span class="attr">master:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/database?useUnicode=true&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=true&amp;serverTimezone=GMT%2B8</span></span><br><span class="line">    <span class="attr">username:</span> <span class="number">123456</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br></pre></td></tr></table></figure><h4 id="ä¿®æ”¹-application-yml-å¯åŠ¨ç«¯å£ã€redisç­‰é…ç½®"><a href="#ä¿®æ”¹-application-yml-å¯åŠ¨ç«¯å£ã€redisç­‰é…ç½®" class="headerlink" title="ä¿®æ”¹ application.yml å¯åŠ¨ç«¯å£ã€redisç­‰é…ç½®"></a>ä¿®æ”¹ application.yml å¯åŠ¨ç«¯å£ã€redisç­‰é…ç½®</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¡¹ç›®ç›¸å…³é…ç½®</span></span><br><span class="line"><span class="attr">ruoyi:</span></span><br><span class="line">  <span class="comment"># åç§°</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">RuoYi</span></span><br><span class="line">  <span class="comment"># ç‰ˆæœ¬</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">3.8</span><span class="number">.6</span></span><br><span class="line">  <span class="comment"># ç‰ˆæƒå¹´ä»½</span></span><br><span class="line">  <span class="attr">copyrightYear:</span> <span class="number">2023</span></span><br><span class="line">  <span class="comment"># å®ä¾‹æ¼”ç¤ºå¼€å…³</span></span><br><span class="line">  <span class="attr">demoEnabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># æ–‡ä»¶è·¯å¾„ ç¤ºä¾‹ï¼ˆ Windowsé…ç½®D:/ruoyi/uploadPathï¼ŒLinuxé…ç½® /home/ruoyi/uploadPathï¼‰</span></span><br><span class="line">  <span class="attr">profile:</span> <span class="string">D:/ruoyi/uploadPath</span></span><br><span class="line">  <span class="comment"># è·å–ipåœ°å€å¼€å…³</span></span><br><span class="line">  <span class="attr">addressEnabled:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># éªŒè¯ç ç±»å‹ math æ•°å­—è®¡ç®— char å­—ç¬¦éªŒè¯</span></span><br><span class="line">  <span class="attr">captchaType:</span> <span class="string">math</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å‘ç¯å¢ƒé…ç½®</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="comment"># æœåŠ¡å™¨çš„HTTPç«¯å£ï¼Œé»˜è®¤ä¸º8080</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8085</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="comment"># åº”ç”¨çš„è®¿é—®è·¯å¾„</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/</span></span><br><span class="line">  <span class="attr">tomcat:</span></span><br><span class="line">    <span class="comment"># tomcatçš„URIç¼–ç </span></span><br><span class="line">    <span class="attr">uri-encoding:</span> <span class="string">UTF-8</span></span><br><span class="line">    <span class="comment"># è¿æ¥æ•°æ»¡åçš„æ’é˜Ÿæ•°ï¼Œé»˜è®¤ä¸º100</span></span><br><span class="line">    <span class="attr">accept-count:</span> <span class="number">1000</span></span><br><span class="line">    <span class="attr">threads:</span></span><br><span class="line">      <span class="comment"># tomcatæœ€å¤§çº¿ç¨‹æ•°ï¼Œé»˜è®¤ä¸º200</span></span><br><span class="line">      <span class="attr">max:</span> <span class="number">800</span></span><br><span class="line">      <span class="comment"># Tomcatå¯åŠ¨åˆå§‹åŒ–çš„çº¿ç¨‹æ•°ï¼Œé»˜è®¤å€¼10</span></span><br><span class="line">      <span class="attr">min-spare:</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¥å¿—é…ç½®</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com.ruoyi:</span> <span class="string">debug</span></span><br><span class="line">    <span class="attr">org.springframework:</span> <span class="string">warn</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æˆ·é…ç½®</span></span><br><span class="line"><span class="attr">user:</span></span><br><span class="line">  <span class="attr">password:</span></span><br><span class="line">    <span class="comment"># å¯†ç æœ€å¤§é”™è¯¯æ¬¡æ•°</span></span><br><span class="line">    <span class="attr">maxRetryCount:</span> <span class="number">5</span></span><br><span class="line">    <span class="comment"># å¯†ç é”å®šæ—¶é—´ï¼ˆé»˜è®¤10åˆ†é’Ÿï¼‰</span></span><br><span class="line">    <span class="attr">lockTime:</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Springé…ç½®</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="comment"># èµ„æºä¿¡æ¯</span></span><br><span class="line">  <span class="attr">messages:</span></span><br><span class="line">    <span class="comment"># å›½é™…åŒ–èµ„æºæ–‡ä»¶è·¯å¾„</span></span><br><span class="line">    <span class="attr">basename:</span> <span class="string">i18n/messages</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">druid</span></span><br><span class="line">  <span class="comment"># æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">multipart:</span></span><br><span class="line">      <span class="comment"># å•ä¸ªæ–‡ä»¶å¤§å°</span></span><br><span class="line">      <span class="attr">max-file-size:</span> <span class="string">10MB</span></span><br><span class="line">      <span class="comment"># è®¾ç½®æ€»ä¸Šä¼ çš„æ–‡ä»¶å¤§å°</span></span><br><span class="line">      <span class="attr">max-request-size:</span> <span class="string">20MB</span></span><br><span class="line">  <span class="comment"># æœåŠ¡æ¨¡å—</span></span><br><span class="line">  <span class="attr">devtools:</span></span><br><span class="line">    <span class="attr">restart:</span></span><br><span class="line">      <span class="comment"># çƒ­éƒ¨ç½²å¼€å…³</span></span><br><span class="line">      <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># redis é…ç½®</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="comment"># åœ°å€</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">    <span class="comment"># ç«¯å£ï¼Œé»˜è®¤ä¸º6379</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br><span class="line">    <span class="comment"># æ•°æ®åº“ç´¢å¼•</span></span><br><span class="line">    <span class="attr">database:</span> <span class="number">0</span></span><br><span class="line">    <span class="comment"># å¯†ç </span></span><br><span class="line">    <span class="attr">password:</span></span><br><span class="line">    <span class="comment"># è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="string">10s</span></span><br><span class="line">    <span class="attr">lettuce:</span></span><br><span class="line">      <span class="attr">pool:</span></span><br><span class="line">        <span class="comment"># è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥</span></span><br><span class="line">        <span class="attr">min-idle:</span> <span class="number">0</span></span><br><span class="line">        <span class="comment"># è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥</span></span><br><span class="line">        <span class="attr">max-idle:</span> <span class="number">8</span></span><br><span class="line">        <span class="comment"># è¿æ¥æ± çš„æœ€å¤§æ•°æ®åº“è¿æ¥æ•°</span></span><br><span class="line">        <span class="attr">max-active:</span> <span class="number">8</span></span><br><span class="line">        <span class="comment"># #è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span></span><br><span class="line">        <span class="attr">max-wait:</span> <span class="string">-1ms</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># tokené…ç½®</span></span><br><span class="line"><span class="attr">token:</span></span><br><span class="line">  <span class="comment"># ä»¤ç‰Œè‡ªå®šä¹‰æ ‡è¯†</span></span><br><span class="line">  <span class="attr">header:</span> <span class="string">Authorization</span></span><br><span class="line">  <span class="comment"># ä»¤ç‰Œå¯†é’¥</span></span><br><span class="line">  <span class="attr">secret:</span> <span class="string">abcdefghijklmnopqrstuvwxyz</span></span><br><span class="line">  <span class="comment"># ä»¤ç‰Œæœ‰æ•ˆæœŸï¼ˆé»˜è®¤30åˆ†é’Ÿï¼‰</span></span><br><span class="line">  <span class="attr">expireTime:</span> <span class="number">30</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MyBatisé…ç½®</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="comment"># æœç´¢æŒ‡å®šåŒ…åˆ«å</span></span><br><span class="line">  <span class="attr">typeAliasesPackage:</span> <span class="string">com.ruoyi.**.domain</span></span><br><span class="line">  <span class="comment"># é…ç½®mapperçš„æ‰«æï¼Œæ‰¾åˆ°æ‰€æœ‰çš„mapper.xmlæ˜ å°„æ–‡ä»¶</span></span><br><span class="line">  <span class="attr">mapperLocations:</span> <span class="string">classpath*:mapper/**/*Mapper.xml</span></span><br><span class="line">  <span class="comment"># åŠ è½½å…¨å±€çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line">  <span class="attr">configLocation:</span> <span class="string">classpath:mybatis/mybatis-config.xml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PageHelperåˆ†é¡µæ’ä»¶</span></span><br><span class="line"><span class="attr">pagehelper:</span></span><br><span class="line">  <span class="attr">helperDialect:</span> <span class="string">mysql</span></span><br><span class="line">  <span class="attr">supportMethodsArguments:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">params:</span> <span class="string">count=countSql</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Swaggeré…ç½®</span></span><br><span class="line"><span class="attr">swagger:</span></span><br><span class="line">  <span class="comment"># æ˜¯å¦å¼€å¯swagger</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># è¯·æ±‚å‰ç¼€</span></span><br><span class="line">  <span class="attr">pathMapping:</span> <span class="string">/dev-api</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é˜²æ­¢XSSæ”»å‡»</span></span><br><span class="line"><span class="attr">xss:</span></span><br><span class="line">  <span class="comment"># è¿‡æ»¤å¼€å…³</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># æ’é™¤é“¾æ¥ï¼ˆå¤šä¸ªç”¨é€—å·åˆ†éš”ï¼‰</span></span><br><span class="line">  <span class="attr">excludes:</span> <span class="string">/system/notice</span></span><br><span class="line">  <span class="comment"># åŒ¹é…é“¾æ¥</span></span><br><span class="line">  <span class="attr">urlPatterns:</span> <span class="string">/system/*,/monitor/*,/tool/*</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="å¯åŠ¨-RuoYiApplication"><a href="#å¯åŠ¨-RuoYiApplication" class="headerlink" title="å¯åŠ¨ RuoYiApplication"></a>å¯åŠ¨ RuoYiApplication</h4><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062304894.png" alt="image-20230806230454732"></p><p>å¯åŠ¨æˆåŠŸ<br><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062308608.png" alt="image-20230806230846269"></p><h3 id="å¯åŠ¨å‰ç«¯é¡¹ç›®"><a href="#å¯åŠ¨å‰ç«¯é¡¹ç›®" class="headerlink" title="å¯åŠ¨å‰ç«¯é¡¹ç›®"></a>å¯åŠ¨å‰ç«¯é¡¹ç›®</h3><h4 id="æ‰“å¼€å‰ç«¯é¡¹ç›®"><a href="#æ‰“å¼€å‰ç«¯é¡¹ç›®" class="headerlink" title="æ‰“å¼€å‰ç«¯é¡¹ç›®"></a>æ‰“å¼€å‰ç«¯é¡¹ç›®</h4><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062309818.png" alt="image-20230806230935097"></p><h4 id="å®‰è£…-npm"><a href="#å®‰è£…-npm" class="headerlink" title="å®‰è£… npm"></a>å®‰è£… npm</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure><h4 id="ä¿®æ”¹å‰ç«¯é…ç½®"><a href="#ä¿®æ”¹å‰ç«¯é…ç½®" class="headerlink" title="ä¿®æ”¹å‰ç«¯é…ç½®"></a>ä¿®æ”¹å‰ç«¯é…ç½®</h4><p>å¦‚æœåœ¨åç«¯é¡¹ç›® application.yml ä¿®æ”¹äº†åç«¯é¡¹ç›®çš„ç«¯å£ï¼Œé‚£ä¹ˆä¿®æ”¹ vue.config.js é…ç½®æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062316147.png" alt="image-20230806231635520"></p><h4 id="å¯åŠ¨é¡¹ç›®"><a href="#å¯åŠ¨é¡¹ç›®" class="headerlink" title="å¯åŠ¨é¡¹ç›®"></a>å¯åŠ¨é¡¹ç›®</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h4 id="å¯åŠ¨æˆåŠŸ"><a href="#å¯åŠ¨æˆåŠŸ" class="headerlink" title="å¯åŠ¨æˆåŠŸ"></a>å¯åŠ¨æˆåŠŸ</h4><p>è®¿é—®é“¾æ¥å³å¯</p><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062313820.png" alt="image-20230806231343822"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è‹¥ä¾ä½¿ç”¨æ•™ç¨‹&quot;&gt;&lt;a href=&quot;#è‹¥ä¾ä½¿ç”¨æ•™ç¨‹&quot; class=&quot;headerlink&quot; title=&quot;è‹¥ä¾ä½¿ç”¨æ•™ç¨‹&quot;&gt;&lt;/a&gt;è‹¥ä¾ä½¿ç”¨æ•™ç¨‹&lt;/h1&gt;&lt;h2 id=&quot;è‹¥ä¾æ¡†æ¶ä»‹ç»&quot;&gt;&lt;a href=&quot;#è‹¥ä¾æ¡†æ¶ä»‹ç»&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    <category term="è‹¥ä¾é¡¹ç›®" scheme="http://example.com/categories/%E8%8B%A5%E4%BE%9D%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="å¼€æºé¡¹ç›®" scheme="http://example.com/tags/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>è‹¥ä¾ç”Ÿæˆä»£ç </title>
    <link href="http://example.com/2023/08/07/%E8%8B%A5%E4%BE%9D%E7%94%9F%E6%88%90%E4%BB%A3%E7%A0%81/"/>
    <id>http://example.com/2023/08/07/%E8%8B%A5%E4%BE%9D%E7%94%9F%E6%88%90%E4%BB%A3%E7%A0%81/</id>
    <published>2023-08-06T17:07:30.558Z</published>
    <updated>2023-08-07T14:09:42.975Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è‹¥ä¾ç”Ÿæˆä»£ç "><a href="#è‹¥ä¾ç”Ÿæˆä»£ç " class="headerlink" title="è‹¥ä¾ç”Ÿæˆä»£ç "></a>è‹¥ä¾ç”Ÿæˆä»£ç </h1><h2 id="æ–°å»ºæ–°çš„ç›®å½•"><a href="#æ–°å»ºæ–°çš„ç›®å½•" class="headerlink" title="æ–°å»ºæ–°çš„ç›®å½•"></a>æ–°å»ºæ–°çš„ç›®å½•</h2><p>åœ¨èœå•ç®¡ç†é¡µé¢</p><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308072208303.png" alt="image-20230806233533421"></p><p>æ–°å¢</p><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062349653.png" alt="image-20230806233338535"></p><h2 id="å»ºè¡¨"><a href="#å»ºè¡¨" class="headerlink" title="å»ºè¡¨"></a>å»ºè¡¨</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for sys_student</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `sys_student`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `sys_student`  (</span><br><span class="line">  `student_id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ç¼–å·&#x27;</span>,</span><br><span class="line">  `student_name` <span class="type">varchar</span>(<span class="number">30</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;å­¦ç”Ÿåç§°&#x27;</span>,</span><br><span class="line">  `student_age` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¹´é¾„&#x27;</span>,</span><br><span class="line">  `student_hobby` <span class="type">varchar</span>(<span class="number">30</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;çˆ±å¥½ï¼ˆ0ä»£ç  1éŸ³ä¹ 2ç”µå½±ï¼‰&#x27;</span>,</span><br><span class="line">  `student_sex` <span class="type">char</span>(<span class="number">1</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æ€§åˆ«ï¼ˆ0ç”· 1å¥³ 2æœªçŸ¥ï¼‰&#x27;</span>,</span><br><span class="line">  `student_status` <span class="type">char</span>(<span class="number">1</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;çŠ¶æ€ï¼ˆ0æ­£å¸¸ 1åœç”¨ï¼‰&#x27;</span>,</span><br><span class="line">  `student_birthday` datetime <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”Ÿæ—¥&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`student_id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">1</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci COMMENT <span class="operator">=</span> <span class="string">&#x27;å­¦ç”Ÿä¿¡æ¯è¡¨&#x27;</span> ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><h2 id="ä»£ç ç”Ÿæˆæ“ä½œ"><a href="#ä»£ç ç”Ÿæˆæ“ä½œ" class="headerlink" title="ä»£ç ç”Ÿæˆæ“ä½œ"></a>ä»£ç ç”Ÿæˆæ“ä½œ</h2><ol><li>åœ¨ ç³»ç»Ÿå·¥å…· ç›®å½•ä¸‹çš„ ä»£ç ç”Ÿæˆ</li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062349905.png" alt="image-20230806234101539"></p><ol start="2"><li>ç‚¹å‡»å¯¼å…¥ï¼Œå‹¾é€‰æ‰€è¦ç”Ÿæˆçš„è¡¨</li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062349495.png" alt="image-20230806234232289"></p><ol start="3"><li>ä¿®æ”¹åŸºæœ¬ä¿¡æ¯</li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062349273.png" alt="image-20230806234325499"></p><ol start="4"><li>ä¿®æ”¹å­—æ®µä¿¡æ¯ï¼Œæ ¹æ®éœ€æ±‚å‹¾é€‰æ˜¯å¦ç”¨å­—æ®µæ¥è¿›è¡ŒæŸ¥è¯¢</li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308072209119.png" alt="image-20230806234355542"></p><ol start="5"><li><p>ä¿®æ”¹ç”Ÿæˆä¿¡æ¯<br><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062349501.png" alt="image-20230806234743717"></p></li><li><p>ç”Ÿæˆä»£ç </p></li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062350956.png" alt="image-20230806235051938"></p><ol start="7"><li>é¢„è§ˆä»£ç ï¼Œå»æ•°æ®åº“æ‰§è¡Œ sql è„šæœ¬</li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062352109.png" alt="image-20230806235242362"></p><h2 id="åç«¯é¡¹ç›®å¤„ç†"><a href="#åç«¯é¡¹ç›®å¤„ç†" class="headerlink" title="åç«¯é¡¹ç›®å¤„ç†"></a>åç«¯é¡¹ç›®å¤„ç†</h2><ol><li>æ–°å»º module</li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308062354414.png" alt="image-20230806235425316"></p><ol start="2"><li>åœ¨æ–°å»ºçš„ ruoyi-student çš„ pom æ–‡ä»¶ï¼Œæ·»åŠ  ruoyi-common å…¬å…±éƒ¨åˆ†ä¾èµ–</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.ruoyi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ruoyi-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>åœ¨æ•´ä¸ªé¡¹ç›®ä¸‹ çš„ pom æ–‡ä»¶å¼•å…¥åˆšæ‰æ–°å»ºçš„æ¨¡å—</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å­¦ç”Ÿæ¨¡å—--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.ruoyi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ruoyi-student<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;ruoyi.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>åœ¨ ruoyi-admin é¡¹ç›®ä¸‹çš„ pom æ–‡ä»¶å¼•å…¥æ–°å»ºçš„ä¾èµ–</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--å­¦ç”Ÿæ¨¡å—--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.ruoyi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ruoyi-student<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="5"><li>ä¸‹è½½ç”Ÿæˆçš„ä»£ç å‹ç¼©åŒ…åï¼Œè§£å‹ï¼Œæ›¿æ¢ ruoyi-student æ¨¡å—ä¸‹ main æ–‡ä»¶å¤¹</li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308070004675.png" alt="image-20230807000451791"></p><ol start="6"><li>é‡æ–°å¯åŠ¨åç«¯é¡¹ç›®</li></ol><h2 id="å‰ç«¯é¡¹ç›®å¤„ç†"><a href="#å‰ç«¯é¡¹ç›®å¤„ç†" class="headerlink" title="å‰ç«¯é¡¹ç›®å¤„ç†"></a>å‰ç«¯é¡¹ç›®å¤„ç†</h2><ol><li>å¤åˆ¶ vue&#x2F;api ç”Ÿæˆçš„æ–‡ä»¶åˆ°å‰ç«¯é¡¹ç›®çš„ api ç›®å½•ä¸‹</li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308072209469.png" alt="image-20230807000707852"></p><ol start="2"><li>å¤åˆ¶ vue&#x2F;views ç”Ÿæˆçš„æ–‡ä»¶åˆ°å‰ç«¯é¡¹ç›®çš„ views ç›®å½•ä¸‹</li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308070010506.png" alt="image-20230807001042669"></p><ol start="3"><li>é‡æ–°å¯åŠ¨å‰ç«¯é¡¹ç›®ï¼ŒæˆåŠŸ</li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308070012349.png" alt="image-20230807001248095"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è‹¥ä¾ç”Ÿæˆä»£ç &quot;&gt;&lt;a href=&quot;#è‹¥ä¾ç”Ÿæˆä»£ç &quot; class=&quot;headerlink&quot; title=&quot;è‹¥ä¾ç”Ÿæˆä»£ç &quot;&gt;&lt;/a&gt;è‹¥ä¾ç”Ÿæˆä»£ç &lt;/h1&gt;&lt;h2 id=&quot;æ–°å»ºæ–°çš„ç›®å½•&quot;&gt;&lt;a href=&quot;#æ–°å»ºæ–°çš„ç›®å½•&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    <category term="è‹¥ä¾é¡¹ç›®" scheme="http://example.com/categories/%E8%8B%A5%E4%BE%9D%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="å¼€æºé¡¹ç›®" scheme="http://example.com/tags/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>è‹¥ä¾æ•´åˆ ECharts</title>
    <link href="http://example.com/2023/08/07/%E8%8B%A5%E4%BE%9D%E6%95%B4%E5%90%88-ECharts/"/>
    <id>http://example.com/2023/08/07/%E8%8B%A5%E4%BE%9D%E6%95%B4%E5%90%88-ECharts/</id>
    <published>2023-08-06T17:07:30.556Z</published>
    <updated>2023-08-07T14:07:11.832Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è‹¥ä¾æ•´åˆ-ECharts"><a href="#è‹¥ä¾æ•´åˆ-ECharts" class="headerlink" title="è‹¥ä¾æ•´åˆ ECharts"></a>è‹¥ä¾æ•´åˆ ECharts</h1><h2 id="ECharts-ç®€ä»‹"><a href="#ECharts-ç®€ä»‹" class="headerlink" title="ECharts ç®€ä»‹"></a>ECharts ç®€ä»‹</h2><p>å®˜ç½‘åœ°å€ï¼š<a href="https://echarts.apache.org/zh/index.html">Apache ECharts</a></p><p>ç¤ºä¾‹ï¼š<a href="https://echarts.apache.org/examples/zh/index.html#chart-type-line">Examples - Apache ECharts</a></p><p>é¥¼å›¾ç¤ºä¾‹ï¼š<a href="https://echarts.apache.org/examples/zh/editor.html?c=pie-roseType-simple">Examples - Apache ECharts</a></p><h2 id="å‰ç«¯é¡¹ç›®"><a href="#å‰ç«¯é¡¹ç›®" class="headerlink" title="å‰ç«¯é¡¹ç›®"></a>å‰ç«¯é¡¹ç›®</h2><h3 id="å®‰è£…-ECharts"><a href="#å®‰è£…-ECharts" class="headerlink" title="å®‰è£… ECharts"></a>å®‰è£… ECharts</h3><h4 id="ä»-npm-è·å–"><a href="#ä»-npm-è·å–" class="headerlink" title="ä» npm è·å–"></a>ä» npm è·å–</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install echarts --save</span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ èœå•"><a href="#æ·»åŠ èœå•" class="headerlink" title="æ·»åŠ èœå•"></a>æ·»åŠ èœå•</h3><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308070034394.png" alt="image-20230807003319018"></p><h3 id="æ·»åŠ è·¯ç”±"><a href="#æ·»åŠ è·¯ç”±" class="headerlink" title="æ·»åŠ è·¯ç”±"></a>æ·»åŠ è·¯ç”±</h3><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308070033515.png" alt="image-20230807003216708"></p><h3 id="è¯·æ±‚æ¥å£"><a href="#è¯·æ±‚æ¥å£" class="headerlink" title="è¯·æ±‚æ¥å£"></a>è¯·æ±‚æ¥å£</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŸ¥è¯¢å­¦ç”Ÿå…´è¶£</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">listStudentHobby</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/manage/student/pie&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308070049535.png" alt="image-20230807004921146"></p><h3 id="Pie-vue"><a href="#Pie-vue" class="headerlink" title="Pie.vue"></a>Pie.vue</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;myChart&quot; :style=&quot;&#123;width: &#x27;800px&#x27;, height: &#x27;600px&#x27;&#125;&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import * as echarts from &#x27;echarts&#x27;;</span><br><span class="line">import &#123;listStudentHobby&#125; from &quot;@/api/manage/student&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;Pie&quot;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      myChart: &#123;&#125;,</span><br><span class="line">      sortData: [], //åŠ¨æ€æ’åºæ•°æ®</span><br><span class="line">      myChartStyle: &#123; float: &quot;left&quot;, width: &quot;800px&quot;, height: &quot;600px&quot;&#125;, //å›¾è¡¨æ ·å¼</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    listStudentHobby().then(response =&gt; &#123;</span><br><span class="line">      // åŸºäºå‡†å¤‡å¥½çš„domï¼Œåˆå§‹åŒ–echartså®ä¾‹</span><br><span class="line">      let myChart = echarts.init(document.getElementById(&#x27;myChart&#x27;))</span><br><span class="line">      // ç»˜åˆ¶å›¾è¡¨</span><br><span class="line">      myChart.setOption(&#123;</span><br><span class="line">        title: &#123;</span><br><span class="line">          text: &#x27;å­¦ç”Ÿå…´è¶£åˆ†å¸ƒ&#x27;,</span><br><span class="line">          left: &#x27;center&#x27;</span><br><span class="line">        &#125;,</span><br><span class="line">        tooltip: &#123;</span><br><span class="line">          trigger: &#x27;item&#x27;,</span><br><span class="line">          formatter: &#x27;&#123;a&#125; &lt;br/&gt;&#123;b&#125; : &#123;c&#125; (&#123;d&#125;%)&#x27;</span><br><span class="line">        &#125;,</span><br><span class="line">        legend: &#123;</span><br><span class="line">          top: &#x27;bottom&#x27;</span><br><span class="line">        &#125;,</span><br><span class="line">        toolbox: &#123;</span><br><span class="line">          show: true,</span><br><span class="line">          feature: &#123;</span><br><span class="line">            mark: &#123; show: true &#125;,</span><br><span class="line">            dataView: &#123; show: true, readOnly: false &#125;,</span><br><span class="line">            restore: &#123; show: true &#125;,</span><br><span class="line">            saveAsImage: &#123; show: true &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        series: [</span><br><span class="line">          &#123;</span><br><span class="line">            name: &#x27;Nightingale Chart&#x27;,</span><br><span class="line">            type: &#x27;pie&#x27;,</span><br><span class="line">            radius: [50, 250],</span><br><span class="line">            center: [&#x27;50%&#x27;, &#x27;50%&#x27;],</span><br><span class="line">            roseType: &#x27;area&#x27;,</span><br><span class="line">            itemStyle: &#123;</span><br><span class="line">              borderRadius: 8</span><br><span class="line">            &#125;,</span><br><span class="line">            data: response.data</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;)</span><br><span class="line">      console.log(response.data)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="åç«¯é¡¹ç›®"><a href="#åç«¯é¡¹ç›®" class="headerlink" title="åç«¯é¡¹ç›®"></a>åç«¯é¡¹ç›®</h2><h3 id="å‰ç«¯æ¥æ”¶æ•°æ®çš„ç±»å‹"><a href="#å‰ç«¯æ¥æ”¶æ•°æ®çš„ç±»å‹" class="headerlink" title="å‰ç«¯æ¥æ”¶æ•°æ®çš„ç±»å‹"></a>å‰ç«¯æ¥æ”¶æ•°æ®çš„ç±»å‹</h3><p>æŸ¥çœ‹å®ä¾‹ï¼Œç¤ºä¾‹ data ä¸º { value: int, name: string }</p><p>æ‰€ä»¥åç«¯çš„è¿”å›çš„æ•°æ®ç±»å‹è¦ä»¥æ­¤ä¸ºå‡†</p><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308070037071.png" alt="image-20230807003716117"></p><h3 id="åœ¨-Mapper-å±‚å†™-SQL-è¯­å¥"><a href="#åœ¨-Mapper-å±‚å†™-SQL-è¯­å¥" class="headerlink" title="åœ¨ Mapper å±‚å†™ SQL è¯­å¥"></a>åœ¨ Mapper å±‚å†™ SQL è¯­å¥</h3><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308070041506.png" alt="image-20230807004112592"></p><p>ä¸€å®šé‡å‘½åä¸º name,å› ä¸ºå‰ç«¯æ¥æ”¶çš„æ•°æ®ç±»å‹ {value: int, name: string}</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å„ä¸ªå…´è¶£åŠæ¯ä¸ªå­¦ç”Ÿçš„æ•°é‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Select(&quot;select student_hobby name, count(student_name) value from sys_student group by student_hobby&quot;)</span></span><br><span class="line">List&lt;Map&lt;Integer, String&gt;&gt; <span class="title function_">selectHobbyAndCount</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><h3 id="controller-ä»£ç "><a href="#controller-ä»£ç " class="headerlink" title="controller ä»£ç "></a>controller ä»£ç </h3><p>è§„èŒƒä»£ç æ˜¯è°ƒç”¨ service (çœç•¥)</p><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308070044519.png" alt="image-20230807004448267"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> SysStudentMapper sysStudentMapper;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢å­¦ç”Ÿå…´è¶£é¥¼å›¾</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/pie&quot;)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">pie</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;Map&lt;Integer, String&gt;&gt; maps = sysStudentMapper.selectHobbyAndCount();</span><br><span class="line">    <span class="keyword">return</span> AjaxResult.success(maps);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡å¯åç«¯é¡¹ç›®</p><h3 id="å±•ç¤º"><a href="#å±•ç¤º" class="headerlink" title="å±•ç¤º"></a>å±•ç¤º</h3><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308072207162.png" alt="image-20230807010211872"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è‹¥ä¾æ•´åˆ-ECharts&quot;&gt;&lt;a href=&quot;#è‹¥ä¾æ•´åˆ-ECharts&quot; class=&quot;headerlink&quot; title=&quot;è‹¥ä¾æ•´åˆ ECharts&quot;&gt;&lt;/a&gt;è‹¥ä¾æ•´åˆ ECharts&lt;/h1&gt;&lt;h2 id=&quot;ECharts-ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ECh</summary>
      
    
    
    
    <category term="è‹¥ä¾é¡¹ç›®" scheme="http://example.com/categories/%E8%8B%A5%E4%BE%9D%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="ECharts" scheme="http://example.com/tags/ECharts/"/>
    
  </entry>
  
  <entry>
    <title>è¯»ã€Šä»Šæ—¥æ‘„å½±ã€‹</title>
    <link href="http://example.com/2023/06/28/%E8%AF%BB%E3%80%8A%E4%BB%8A%E6%97%A5%E6%91%84%E5%BD%B1%E3%80%8B/"/>
    <id>http://example.com/2023/06/28/%E8%AF%BB%E3%80%8A%E4%BB%8A%E6%97%A5%E6%91%84%E5%BD%B1%E3%80%8B/</id>
    <published>2023-06-27T16:21:53.105Z</published>
    <updated>2023-06-27T16:21:14.970Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ã€Šä»Šæ—¥æ‘„å½±ã€‹"><a href="#ã€Šä»Šæ—¥æ‘„å½±ã€‹" class="headerlink" title="ã€Šä»Šæ—¥æ‘„å½±ã€‹"></a>ã€Šä»Šæ—¥æ‘„å½±ã€‹</h1><h2 id="ç¬¬ä¸€ç« ï¼šæ‘¹ä»¿â€“åŸåˆ›ä¸å¤åˆ¶"><a href="#ç¬¬ä¸€ç« ï¼šæ‘¹ä»¿â€“åŸåˆ›ä¸å¤åˆ¶" class="headerlink" title="ç¬¬ä¸€ç« ï¼šæ‘¹ä»¿â€“åŸåˆ›ä¸å¤åˆ¶"></a>ç¬¬ä¸€ç« ï¼šæ‘¹ä»¿â€“åŸåˆ›ä¸å¤åˆ¶</h2><h3 id="ä½œå“"><a href="#ä½œå“" class="headerlink" title="ä½œå“"></a>ä½œå“</h3><ol><li>åŸƒå¾·Â·æ‹‰æ–¯æŸ¥ ã€Šæ—¥è½å¤§é“ä¸Šçš„æ¯æ ‹å»ºç­‘ã€‹</li><li>æ‰˜é©¬æ–¯Â·æ–¯ç‰¹é²æ–¯ ã€ŠèŠåŠ å“¥è‰ºæœ¯å­¦é™¢2ã€‹ã€Šè§‚ä¼— 1ã€‹ ã€Šä¼¦æ•¦å›½å®¶ç¾æœ¯é¦† 1ã€‹</li><li>è´æ­‡å°”å¤«å¦‡ é€šè¿‡å…¨é¢è¯¦å°½çš„æ‘„å½±æ‰€è¡¨ç°å‡ºæ¥çš„ç²¾ç¡®å’Œæ˜æ™°é¢‚æ‰¬äº†è¿™äº›å·¥ä¸šå»ºç­‘çš„ç¾æ„Ÿ ã€Šå·æ‰¬å¡”ã€‹<br>ç”±äºè¿™äº›å»ºç­‘æ­£æ—¥æ¸æ¶ˆå¤±ï¼Œå¯ä»¥æƒ³è±¡ï¼Œç”¨æ‘„å½±ä¿å­˜è¿™äº›å»ºç­‘æ€»æœ‰ä¸€å¤©ä¼šæ˜¯å¤§å®¶æ‰€å¸Œæœ›çš„</li></ol><h2 id="ç¬¬äºŒç« ï¼šé¢å­”â€“å§¿æ€ä¸ä¼ªè£…"><a href="#ç¬¬äºŒç« ï¼šé¢å­”â€“å§¿æ€ä¸ä¼ªè£…" class="headerlink" title="ç¬¬äºŒç« ï¼šé¢å­”â€“å§¿æ€ä¸ä¼ªè£…"></a>ç¬¬äºŒç« ï¼šé¢å­”â€“å§¿æ€ä¸ä¼ªè£…</h2><p>æ‘„å½±èƒ½å¤Ÿæ‰­æ›²ä¹Ÿèƒ½ç¾åŒ–ã€‚äººä»¬æœŸæœ›è‚–åƒå¯ä»¥æ­ç¤ºæ‹æ‘„å¯¹è±¡çš„æŸäº›ä¸ªæ€§ç‰¹å¾ã€‚<br>å¤§ä½“ä¸Šè‚–åƒæ‘„å½±åˆ†æˆä¸¤å¤§æ–¹å‘ï¼šä¸€éƒ¨åˆ†ä½œå“åšæŒå°è¯•æ­ç¤ºå†…å¿ƒï¼›è€Œå¦ä¸€äº›ä½œå“åˆ™æ’‡å¼€è¿™ç§é¢„æœŸä¸”æ‰¿è®¤æ‘„å½±è‚–åƒæœ€ç»ˆå¹¶æ²¡æœ‰èƒ½åŠ›åˆ»ç”»äººç‰©æ€§æ ¼ã€‚</p><p>é»›å®‰Â·é˜¿å‹ƒä¸ï¼šâ€œæˆ‘ä»¬æ‰€æœ‰çš„ä¼ªè£…å°±å¥½åƒæ˜¯è¦æç¤ºå¤–ç•Œåº”è¯¥å¦‚ä½•æ¥çœ‹å¾…æˆ‘ä»¬ï¼Œä½†ä½ å¸Œæœ›äººä»¬çœ‹åˆ°çš„ä½ ï¼Œä¸ä½ æ— æ³•æ§åˆ¶çš„ï¼Œäººä»¬å®é™…çœ‹åˆ°çš„ä½ ï¼Œè¿™ä¸¤è€…ä¹‹é—´æ€»æ˜¯å­˜åœ¨åˆ†æ­§ã€‚â€</p><h3 id="ä½œå“-1"><a href="#ä½œå“-1" class="headerlink" title="ä½œå“"></a>ä½œå“</h3><ol><li>è¾›è¿ªÂ·èˆæ›¼  æµ´å®¤ä¸­çš„å¥³å­é¢å¯¹é•œå­æ”é¦–å¼„å§¿ã€Šæ— åç”µå½±å‰§ç…§2å·ã€‹</li><li>è±æ¶…å…‹Â·è¿ªå…‹æ–¯ç‰¹æ‹‰ã€Šå¼ºè€…ä¹‹å®¶ã€‹ ã€Šå¸Œæ‹‰è‡ªç”±é•‡ã€‹</li><li>å¤å±‹åŸä¸€</li><li>å®‰å¨œÂ·ç¦å…‹æ–¯ ã€Šé»‘å½¼å¾—ã€‹</li></ol><p>â€œæˆ‘ä»¬æ‰€æœ‰çš„ä¼ªè£…å°±å¥½åƒæ˜¯è¦æç¤ºå¤–ç•Œåº”è¯¥å¦‚ä½•æ¥çœ‹å¾…æˆ‘ä»¬ï¼Œä½†ä½ å¸Œæœ›äººä»¬çœ‹åˆ°çš„ä½ ï¼Œä¸ä½ æ— æ³•æ§åˆ¶çš„ï¼Œäººä»¬å®é™…çœ‹åˆ°çš„ä½ ï¼Œè¿™ä¸¤è€…ä¹‹é—´æ€»æ˜¯å­˜åœ¨åˆ†æ­§ã€‚â€</p><h2 id="ç¬¬ä¸‰ç« ï¼šè‰²å½©â€“è¡¨è±¡ä¸æ·±åº¦"><a href="#ç¬¬ä¸‰ç« ï¼šè‰²å½©â€“è¡¨è±¡ä¸æ·±åº¦" class="headerlink" title="ç¬¬ä¸‰ç« ï¼šè‰²å½©â€“è¡¨è±¡ä¸æ·±åº¦"></a>ç¬¬ä¸‰ç« ï¼šè‰²å½©â€“è¡¨è±¡ä¸æ·±åº¦</h2><p>åœ¨å“ªäº›è‚¤æµ…ã€çº·ç¹ã€åªšä¿—ä¹‹ç‰©åˆ©ç”¨è‰²å½©å¸å¼•çœ¼çƒçš„åŒæ—¶ï¼Œè‰²å½©ä¹Ÿä¸ºæ‘„å½±å¸¦æ¥äº†ç§¯ææ„ä¹‰ã€‚</p><h3 id="ä½œå“-2"><a href="#ä½œå“-2" class="headerlink" title="ä½œå“"></a>ä½œå“</h3><ol><li>è¥¿è’™Â·è¯ºç¦å…‹ ã€Šæµè¡€ã€‹</li><li>ä¸¹å¦®æ‹‰Â·ç½—å¡å°” ã€Šåå®«ã€‹</li><li>å½¼å¾—Â·å¼—é›·æ³½ ã€Šé€šä¿¡å«æ˜Ÿã€‹ã€Šææ–™ã€‹</li></ol><h2 id="ç¬¬å››ç« ï¼šè¡—å¤´ï¼šçº·äº‰ä¸å’Œè°"><a href="#ç¬¬å››ç« ï¼šè¡—å¤´ï¼šçº·äº‰ä¸å’Œè°" class="headerlink" title="ç¬¬å››ç« ï¼šè¡—å¤´ï¼šçº·äº‰ä¸å’Œè°"></a>ç¬¬å››ç« ï¼šè¡—å¤´ï¼šçº·äº‰ä¸å’Œè°</h2><h3 id="ä½œå“-3"><a href="#ä½œå“-3" class="headerlink" title="ä½œå“"></a>ä½œå“</h3><ol><li>åŠ é‡ŒÂ·ç»´è¯ºæ ¼å…°å¾· ã€Šçº½çº¦ã€‹</li><li>æ£®å±±å¤§é“ ã€Šç”·å­©ã€‹ ã€Šæµæµªç‹—ã€‹</li><li>æ°å¤«Â·æ²ƒå°” ã€Šæ¨¡ä»¿ã€‹ ã€Šç‰›å¥¶ã€‹ ã€Šäººè¡Œé“æå‡»æœ¯ã€‹</li><li>æ±¤å§†Â·ä¼å¾· ã€Šæ–¯å¦åˆ©è¡—ã€‹</li></ol><h2 id="ç¬¬äº”ç« ï¼šæ™¯è§‚â€“è‡ªç„¶ï¼Œæ–‡åŒ–ä¸æƒåŠ›"><a href="#ç¬¬äº”ç« ï¼šæ™¯è§‚â€“è‡ªç„¶ï¼Œæ–‡åŒ–ä¸æƒåŠ›" class="headerlink" title="ç¬¬äº”ç« ï¼šæ™¯è§‚â€“è‡ªç„¶ï¼Œæ–‡åŒ–ä¸æƒåŠ›"></a>ç¬¬äº”ç« ï¼šæ™¯è§‚â€“è‡ªç„¶ï¼Œæ–‡åŒ–ä¸æƒåŠ›</h2><h3 id="ä½œå“-4"><a href="#ä½œå“-4" class="headerlink" title="ä½œå“"></a>ä½œå“</h3><ol><li>å®‰å¾·çƒˆäºšæ–¯Â·å¤æ–¯åŸº ã€Šè±èŒµæ²³äºŒå·ã€‹</li><li>ç½—ä¼¯ç‰¹Â·æ–¯å¯†æ£® ã€Šé•œå­çš„é•¿åº¦ã€‹</li><li>ç†æŸ¥å¾·Â·æœ— ã€Šèµ°å‡ºçš„çº¿ã€‹</li><li>ä¹”å°”Â·æ–¯å¦è²å°”å¾· ã€Šç­‹ç–²åŠ›å°½çš„èƒŒå›å¤§è±¡ã€‹</li><li>çº¦å°”é©¬Â·æ™®æ‹‰å® ã€Šæƒ³è±¡ä¸­çš„å›å®¶ã€‹</li></ol><h2 id="ç¬¬å…­ç« ï¼šå†å²â€“è§è¯æš´è¡Œ"><a href="#ç¬¬å…­ç« ï¼šå†å²â€“è§è¯æš´è¡Œ" class="headerlink" title="ç¬¬å…­ç« ï¼šå†å²â€“è§è¯æš´è¡Œ"></a>ç¬¬å…­ç« ï¼šå†å²â€“è§è¯æš´è¡Œ</h2><h3 id="ä½œå“-5"><a href="#ä½œå“-5" class="headerlink" title="ä½œå“"></a>ä½œå“</h3><ol><li>è©¹å§†æ–¯Â·çº³åˆ‡å¨ ã€Šåœ°ç‹±ã€‹ ã€Šæ³¢æ–¯å°¼äºšã€‹</li><li>æ‹‰é‡ŒÂ·æ³¢ç½—æ–¯ ã€Šè¢«ç¾å†›æ±½æ²¹å¼¹çƒ§ä¼¤çš„å¥³å­©ã€‹</li><li>å‰åˆ—æ–¯Â·çš®é‡Œæ–¯ ã€Šæ²‰é»˜ã€‹</li></ol><h2 id="ç¬¬ä¸ƒç« ï¼šèº«ä½“â€“ç†æƒ³ä¸ç°å®"><a href="#ç¬¬ä¸ƒç« ï¼šèº«ä½“â€“ç†æƒ³ä¸ç°å®" class="headerlink" title="ç¬¬ä¸ƒç« ï¼šèº«ä½“â€“ç†æƒ³ä¸ç°å®"></a>ç¬¬ä¸ƒç« ï¼šèº«ä½“â€“ç†æƒ³ä¸ç°å®</h2><p>èº«ä½“è¡¨æ˜ï¼Œäººç±»ä¹‹é—´å­˜åœ¨ç€å…±æ€§å’Œè”ç³»ï¼›èº«ä½“æ‰€æŒ‡å‘çš„æ˜¯æˆ‘ä»¬çš„äººæ€§ã€‚</p><h3 id="ä½œå“-6"><a href="#ä½œå“-6" class="headerlink" title="ä½œå“"></a>ä½œå“</h3><ol><li>ä¼Šå¤«Â·å…‹è±å›  ã€Šå å…¥ç©ºæ— ã€‹ã€Šè·Œè½2ã€‹</li><li>èµ«å°”ç©†ç‰¹Â·ç‰›é¡¿ ã€ŠåŒå¦»å­ç¼åŠå…¶æ¨¡ç‰¹åœ¨å·´é» Vogue å·¥ä½œå®¤çš„è‡ªæ‹ç…§ã€‹</li><li>ç†æŸ¥å¾·Â·åˆ©è¯ºä¼Šå¾· ã€Šè£¸ä½“çš„è´¾æ€æ•ã€‹</li></ol><h2 id="ç¬¬å…«ç« ï¼šçºªå®â€“ä»‹å…¥ä¸åˆ©ç”¨"><a href="#ç¬¬å…«ç« ï¼šçºªå®â€“ä»‹å…¥ä¸åˆ©ç”¨" class="headerlink" title="ç¬¬å…«ç« ï¼šçºªå®â€“ä»‹å…¥ä¸åˆ©ç”¨"></a>ç¬¬å…«ç« ï¼šçºªå®â€“ä»‹å…¥ä¸åˆ©ç”¨</h2><h3 id="ä½œå“-7"><a href="#ä½œå“-7" class="headerlink" title="ä½œå“"></a>ä½œå“</h3><ol><li>å¤§å«Â·å“¥çš„å¸ƒæ‹‰ç‰¹ ã€Šå†œåœºä¸»çš„å„¿å­å’Œä»–çš„ä¿å§†ã€‹ ã€Šè¶³å°–ä¸Šç©¿æ–°èˆè£™çš„å¥³å­©ã€‹</li><li>æ‹‰é‡ŒÂ·è¨å°”å¦ ã€Šå¤ä¼¦Â·æ€€å°”å¾·ã€‹</li><li>å¥¥å°”åŠ Â·åˆ‡å°¼è°¢å¨ƒ ã€Šå€¼ç­ã€‹ã€Šåˆ—è½¦ã€‹</li></ol><h2 id="ç¬¬ä¹ç« ï¼šè‡ªæˆ‘ï¼šè§‚ç…§ä¸è¡¨æ¼”"><a href="#ç¬¬ä¹ç« ï¼šè‡ªæˆ‘ï¼šè§‚ç…§ä¸è¡¨æ¼”" class="headerlink" title="ç¬¬ä¹ç« ï¼šè‡ªæˆ‘ï¼šè§‚ç…§ä¸è¡¨æ¼”"></a>ç¬¬ä¹ç« ï¼šè‡ªæˆ‘ï¼šè§‚ç…§ä¸è¡¨æ¼”</h2><h3 id="ä½œå“-8"><a href="#ä½œå“-8" class="headerlink" title="ä½œå“"></a>ä½œå“</h3><ol><li>è’æœ¨ç»æƒŸ ã€Šæ„Ÿä¼¤ä¹‹æ—…ã€‹</li><li>æ£®æ‘æ³°æ˜Œ ã€Šå®‰é­‚æ›²ï¼š1968å¹´è¶Šå—æˆ˜äº‰ã€‹</li></ol><h2 id="ç¬¬åç« ï¼šå»ºæ„â€“ç¬¦å·ï¼Œå¹»æƒ³ä¸åœºæ™¯"><a href="#ç¬¬åç« ï¼šå»ºæ„â€“ç¬¦å·ï¼Œå¹»æƒ³ä¸åœºæ™¯" class="headerlink" title="ç¬¬åç« ï¼šå»ºæ„â€“ç¬¦å·ï¼Œå¹»æƒ³ä¸åœºæ™¯"></a>ç¬¬åç« ï¼šå»ºæ„â€“ç¬¦å·ï¼Œå¹»æƒ³ä¸åœºæ™¯</h2><h3 id="ä½œå“-9"><a href="#ä½œå“-9" class="headerlink" title="ä½œå“"></a>ä½œå“</h3><ol><li>è±æ–¯Â·å…‹é‡Œå§†æ–¯ ã€ŠåŠ ä¸€æ¡£æ›å…‰ã€‹ã€Šæ€é¹¿è€…ä¸é¹¿çš„åŒé‡åƒã€‹</li><li>ç»´å…‹å¤šÂ·ä¼¯é‡‘ ã€Šè´¢äº§ã€‹ 7% çš„äººå£æ‹¥æœ‰ 84% çš„è´¢å¯Œ</li><li>æ ¼é‡Œé«˜åˆ©Â·å…‹é²å¾·æ£® ã€Šæš®å…‰ã€‹</li><li>ç›å°¼Â·æ–¯é‡Œä¸‡å°¼å¥‡æ™®ç©† ã€Šè¿™çœ‹ä¸è§è¡€çš„æˆ˜äº‰ã€‹</li></ol><h2 id="ç¬¬åä¸€ç« ï¼šæ‘„å½±çš„æœªæ¥"><a href="#ç¬¬åä¸€ç« ï¼šæ‘„å½±çš„æœªæ¥" class="headerlink" title="ç¬¬åä¸€ç« ï¼šæ‘„å½±çš„æœªæ¥"></a>ç¬¬åä¸€ç« ï¼šæ‘„å½±çš„æœªæ¥</h2><h3 id="ä½œå“-10"><a href="#ä½œå“-10" class="headerlink" title="ä½œå“"></a>ä½œå“</h3><ol><li>é˜¿æ³•ç“¦å¤šÂ·åŠ å°” ã€Šå›¾åƒçš„æŒ½æ­Œã€‹</li><li>ä¿å§†Â·æ ¼æ‹‰æ±‰å§† ã€Šå¯èƒ½æ€§çš„å¾®å…‰ã€‹</li></ol><h2 id="æ‘˜æŠ„"><a href="#æ‘˜æŠ„" class="headerlink" title="æ‘˜æŠ„"></a>æ‘˜æŠ„</h2><ol><li><p>ç”±äºè¿™äº›å»ºç­‘æ­£æ—¥æ¸æ¶ˆå¤±ï¼Œå¯ä»¥æƒ³è±¡ï¼Œç”¨æ‘„å½±ä¿å­˜è¿™äº›å»ºç­‘æ€»æœ‰ä¸€å¤©ä¼šæ˜¯å¤§å®¶æ‰€å¸Œæœ›çš„</p></li><li><p>æˆ‘ä»¬æ‰€æœ‰çš„ä¼ªè£…å°±å¥½åƒæ˜¯è¦æç¤ºå¤–ç•Œåº”è¯¥å¦‚ä½•æ¥çœ‹å¾…æˆ‘ä»¬ï¼Œä½†ä½ å¸Œæœ›äººä»¬çœ‹åˆ°çš„ä½ ï¼Œä¸ä½ æ— æ³•æ§åˆ¶çš„ï¼Œäººä»¬å®é™…çœ‹åˆ°çš„ä½ ï¼Œè¿™ä¸¤è€…ä¹‹é—´æ€»æ˜¯å­˜åœ¨åˆ†æ­§ã€‚</p></li><li><p>å¦‚æœä½ è¿‘è·ç¦»çš„æ£€è§†ç°å®ï¼Œå¦‚æœä½ çœŸæ­£çš„äº†è§£åˆ°äº†å®ƒï¼Œå®ƒå°±å˜å¾—éš¾ä»¥ç½®ä¿¡äº†ã€‚</p></li><li><p>é»‘ç™½æ‘„å½±æ›´ä¸ºæŠ½è±¡ï¼Œæ›´å…·æ¦‚å¿µæ€§ï¼Œæ„è¯†å½¢æ€æ›´é²œæ˜ï¼Œè‰²å½©åˆ™æ˜¯æ„Ÿå®˜ä¸Šçš„ã€‚</p></li><li><p>æˆ‘ä»¬æ˜¯å¦‚ä½•è¢«å„ç§æ¶ˆè´¹å•†å“åŒ…å›´ï¼Œä½†åˆä»æ ¹æœ¬ä¸Šä¸è¿™äº›ä¸œè¥¿çš„æ¥æºæ¯«æ— å…³ç³»ã€‚æˆ‘ä»¬çš„ç”Ÿæ´»æ–¹å¼é€šè¿‡ä¸–ç•Œå„åœ°çš„äº§ä¸šå¾—ä»¥å®ç°ï¼Œä½†æˆ‘ä»¬å´å¯¹æ­¤ä¹ ä»¥ä¸ºå¸¸ã€‚å¥½åƒä»–ä»¬æ˜¯æˆ‘ä»¬å­˜åœ¨çš„èƒŒæ™¯ã€‚</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ã€Šä»Šæ—¥æ‘„å½±ã€‹&quot;&gt;&lt;a href=&quot;#ã€Šä»Šæ—¥æ‘„å½±ã€‹&quot; class=&quot;headerlink&quot; title=&quot;ã€Šä»Šæ—¥æ‘„å½±ã€‹&quot;&gt;&lt;/a&gt;ã€Šä»Šæ—¥æ‘„å½±ã€‹&lt;/h1&gt;&lt;h2 id=&quot;ç¬¬ä¸€ç« ï¼šæ‘¹ä»¿â€“åŸåˆ›ä¸å¤åˆ¶&quot;&gt;&lt;a href=&quot;#ç¬¬ä¸€ç« ï¼šæ‘¹ä»¿â€“åŸåˆ›ä¸å¤åˆ¶&quot; class=&quot;head</summary>
      
    
    
    
    <category term="å¢¨æ«çš„è¯»ä¹¦æ„Ÿæƒ³" scheme="http://example.com/categories/%E5%A2%A8%E6%9E%AB%E7%9A%84%E8%AF%BB%E4%B9%A6%E6%84%9F%E6%83%B3/"/>
    
    
    <category term="è¯»ä¹¦æ„Ÿæƒ³" scheme="http://example.com/tags/%E8%AF%BB%E4%B9%A6%E6%84%9F%E6%83%B3/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€ã€èšåˆæœç´¢å¹³å°ç®€ä»‹</title>
    <link href="http://example.com/2023/05/03/%E4%B8%80%E3%80%81%E8%81%9A%E5%90%88%E6%90%9C%E7%B4%A2%E5%B9%B3%E5%8F%B0%E7%AE%80%E4%BB%8B/"/>
    <id>http://example.com/2023/05/03/%E4%B8%80%E3%80%81%E8%81%9A%E5%90%88%E6%90%9C%E7%B4%A2%E5%B9%B3%E5%8F%B0%E7%AE%80%E4%BB%8B/</id>
    <published>2023-05-03T15:27:51.304Z</published>
    <updated>2023-03-21T14:27:35.470Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èšåˆæœç´¢å¹³å°ç®€ä»‹"><a href="#èšåˆæœç´¢å¹³å°ç®€ä»‹" class="headerlink" title="èšåˆæœç´¢å¹³å°ç®€ä»‹"></a>èšåˆæœç´¢å¹³å°ç®€ä»‹</h1><h2 id="æŠ€æœ¯æ ˆä»‹ç»"><a href="#æŠ€æœ¯æ ˆä»‹ç»" class="headerlink" title="æŠ€æœ¯æ ˆä»‹ç»"></a>æŠ€æœ¯æ ˆä»‹ç»</h2><p>å…¨æ ˆ</p><h3 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h3><ul><li>Vue</li><li>Ant Design Vue</li><li>Lodash</li></ul><h3 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h3><ul><li>Spring Boot </li><li>MySQL</li><li>Elasticsearch (Elastic Stack) æœç´¢å¼•æ“</li><li>æ•°æ®æŠ“å–</li><li>æ•°æ®åŒæ­¥<ul><li>4ç§</li><li>logstash</li><li>Canal</li></ul></li><li>Guava Retrying</li><li>æ€ä¹ˆä¿è¯ API çš„ç¨³å®šæ€§</li></ul><h2 id="ä¸šåŠ¡æµç¨‹"><a href="#ä¸šåŠ¡æµç¨‹" class="headerlink" title="ä¸šåŠ¡æµç¨‹"></a>ä¸šåŠ¡æµç¨‹</h2><ol><li>å…ˆå¾—åˆ°å„ç§ä¸åŒåˆ†ç±»çš„æ•°æ®</li><li>æä¾›ä¸€ä¸ªæœç´¢é¡µé¢ï¼ˆå•ä¸€æœç´¢ã€èšåˆæœç´¢ï¼‰ï¼Œæ”¯æŒæœç´¢</li></ol><p>å¯ä»¥å»åšä¸€äº›ä¼˜åŒ–ï¼Œæ¯”å¦‚å…³é”®è¯é«˜äº®ã€é˜²æŠ–èŠ‚æµ</p><p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20230321215555548.png" alt="image-20230321215555548"></p><h2 id="é¡¹ç›®è®¡åˆ’"><a href="#é¡¹ç›®è®¡åˆ’" class="headerlink" title="é¡¹ç›®è®¡åˆ’"></a>é¡¹ç›®è®¡åˆ’</h2><h3 id="ç¬¬ä¸€æœŸ"><a href="#ç¬¬ä¸€æœŸ" class="headerlink" title="ç¬¬ä¸€æœŸ"></a>ç¬¬ä¸€æœŸ</h3><ul><li>å‰ç«¯åç«¯é¡¹ç›®åˆå§‹åŒ–</li><li>å‰ç«¯æœç´¢é¡µé¢å¼€å‘å®Œæˆ</li><li>åç«¯åŸºæœ¬æœç´¢æ¥å£å¼€å‘å®Œæˆ</li></ul><h3 id="ç¬¬äºŒæœŸ"><a href="#ç¬¬äºŒæœŸ" class="headerlink" title="ç¬¬äºŒæœŸ"></a>ç¬¬äºŒæœŸ</h3><ul><li>æ•°æ®æŠ“å–</li><li>èšåˆæœç´¢æ¥å£çš„å¼€å‘<ul><li>é€‚é…å™¨</li><li>é—¨é¢æ¨¡å¼</li></ul></li><li>Elasticsearch æ­å»ºåŠçƒ­é—¨</li></ul><h3 id="ç¬¬ä¸‰æœŸ"><a href="#ç¬¬ä¸‰æœŸ" class="headerlink" title="ç¬¬ä¸‰æœŸ"></a>ç¬¬ä¸‰æœŸ</h3><ul><li><p>Elasticsearch çš„ä½¿ç”¨ï¼ˆå»ºè¡¨ã€è¯»å†™æ•°æ®ã€è°ƒ API ã€å’Œ Java æ•´åˆï¼‰</p></li><li><p>æ•°æ®åŒæ­¥ï¼ˆå››ç§åŒæ­¥æ–¹å¼ï¼‰</p></li></ul><h3 id="ç¬¬å››æœŸ"><a href="#ç¬¬å››æœŸ" class="headerlink" title="ç¬¬å››æœŸ"></a>ç¬¬å››æœŸ</h3><ul><li>æ¥å£ç¨³å®šæ€§ä¿éšœ</li><li>é¡¹ç›®ä¼˜åŒ–ï¼ˆå…³é”®è¯é«˜äº®ã€æœç´¢å»ºè®®ã€é˜²æŠ–èŠ‚æµï¼‰</li></ul><h2 id="æ—¶é—´å®‰æ’"><a href="#æ—¶é—´å®‰æ’" class="headerlink" title="æ—¶é—´å®‰æ’"></a>æ—¶é—´å®‰æ’</h2><ol><li>å‰ç«¯åˆå§‹åŒ– 10 min </li><li>åç«¯é¡¹ç›®åˆå§‹åŒ– 10 min</li><li>å‰ç«¯æœç´¢é¡µé¢å¼€å‘ 20 min</li><li>æ•´åˆ Axios 10 min</li><li>åç«¯æœç´¢æ¥å£å¼€å‘ 10 min</li></ol><h2 id="å‰ç«¯åˆå§‹åŒ–"><a href="#å‰ç«¯åˆå§‹åŒ–" class="headerlink" title="å‰ç«¯åˆå§‹åŒ–"></a>å‰ç«¯åˆå§‹åŒ–</h2><ol><li>å‚è€ƒ Ant Design ç»„ä»¶åº“çš„å®˜æ–¹æ–‡æ¡£æ¥æ­å»ºåˆå§‹åŒ–é¡¹ç›®<br>ï¼ˆ<a href="https://2x.antdv.com/docs/vue/getting-started-cn%EF%BC%89%EF%BC%8C%E5%B9%B6%E6%95%B4%E5%90%88%E7%BB%84%E4%BB%B6%E5%BA%93">https://2x.antdv.com/docs/vue/getting-started-cnï¼‰ï¼Œå¹¶æ•´åˆç»„ä»¶åº“</a></li><li>åˆ å‡ä¸éœ€è¦çš„é¡µé¢å’Œè·¯ç”±</li></ol><h2 id="åç«¯åˆå§‹åŒ–"><a href="#åç«¯åˆå§‹åŒ–" class="headerlink" title="åç«¯åˆå§‹åŒ–"></a>åç«¯åˆå§‹åŒ–</h2><ol><li>ä½¿ç”¨æ˜Ÿçƒ springboot-init ä¸‡ç”¨é¡¹ç›®æ¨¡æ¿å³å¯</li><li>ç›´æ¥ä½¿ç”¨ Swagger æ–‡æ¡£åœ¨çº¿æµ‹è¯•æ¥å£</li></ol><h2 id="å‰ç«¯å¼€å‘"><a href="#å‰ç«¯å¼€å‘" class="headerlink" title="å‰ç«¯å¼€å‘"></a>å‰ç«¯å¼€å‘</h2><h3 id="è®°å½•æœç´¢çŠ¶æ€"><a href="#è®°å½•æœç´¢çŠ¶æ€" class="headerlink" title="è®°å½•æœç´¢çŠ¶æ€"></a>è®°å½•æœç´¢çŠ¶æ€</h3><p>ç›®æ ‡ï¼šç”¨ url è®°å½•é¡µé¢æœç´¢çŠ¶æ€ï¼Œå½“ç”¨æˆ·åˆ·æ–°é¡µé¢æ—¶ï¼Œèƒ½å¤Ÿä» url è¿˜åŸä¹‹å‰çš„æœç´¢çŠ¶æ€éœ€è¦åŒå‘åŒæ­¥ï¼šurl &lt;&#x3D;&gt; é¡µé¢çŠ¶æ€</p><p>æ ¸å¿ƒå°æŠ€å·§ï¼šæŠŠåŒæ­¥çŠ¶æ€è¯¥ä¸ºå•å‘ï¼Œå³åªå…è®¸ url æ¥æ”¹å˜é¡µé¢çŠ¶æ€ï¼Œä¸å…è®¸åå‘</p><p>åˆ†æ­¥éª¤æ¥å®ç°ï¼Œæ€è·¯æ›´æ¸…æ™°ï¼š</p><ol><li>è®©ç”¨æˆ·åœ¨æ“ä½œçš„æ—¶å€™ï¼Œæ”¹å˜ url åœ°å€ï¼ˆç‚¹å‡»æœç´¢æ¡†ï¼Œæœç´¢å†…å®¹å¡«å……åˆ° url ä¸Šï¼Œåˆ‡æ¢ tab æ—¶ï¼Œä¹Ÿè¦å¡«å……ï¼‰</li><li>å½“ url æ”¹å˜çš„æ—¶å€™ï¼Œå»æ”¹å˜é¡µé¢çŠ¶æ€ï¼ˆç›‘å¬ url çš„æ”¹å˜ï¼‰</li></ol><h2 id="å‰åç«¯è”è°ƒ"><a href="#å‰åç«¯è”è°ƒ" class="headerlink" title="å‰åç«¯è”è°ƒ"></a>å‰åç«¯è”è°ƒ</h2><p>å‰ç«¯æ•´åˆ Axiosï¼Œå¹¶è‡ªå®šä¹‰ Axios å®ä¾‹ï¼Œå®Œæˆè¯·æ±‚ï¼š<a href="https://www.axios-http.cn/docs/intro">https://www.axios-http.cn/docs/intro</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;èšåˆæœç´¢å¹³å°ç®€ä»‹&quot;&gt;&lt;a href=&quot;#èšåˆæœç´¢å¹³å°ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;èšåˆæœç´¢å¹³å°ç®€ä»‹&quot;&gt;&lt;/a&gt;èšåˆæœç´¢å¹³å°ç®€ä»‹&lt;/h1&gt;&lt;h2 id=&quot;æŠ€æœ¯æ ˆä»‹ç»&quot;&gt;&lt;a href=&quot;#æŠ€æœ¯æ ˆä»‹ç»&quot; class=&quot;headerlink</summary>
      
    
    
    
    <category term="èšåˆæœç´¢å¹³å°" scheme="http://example.com/categories/%E8%81%9A%E5%90%88%E6%90%9C%E7%B4%A2%E5%B9%B3%E5%8F%B0/"/>
    
    
    <category term="æ˜Ÿçƒé¡¹ç›®" scheme="http://example.com/tags/%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>èšåˆæœç´¢ä¼˜åŒ–</title>
    <link href="http://example.com/2023/05/03/%E8%81%9A%E5%90%88%E6%90%9C%E7%B4%A2%E4%BC%98%E5%8C%96/"/>
    <id>http://example.com/2023/05/03/%E8%81%9A%E5%90%88%E6%90%9C%E7%B4%A2%E4%BC%98%E5%8C%96/</id>
    <published>2023-05-03T15:27:51.302Z</published>
    <updated>2023-05-03T15:25:29.166Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èšåˆæœç´¢ä¼˜åŒ–"><a href="#èšåˆæœç´¢ä¼˜åŒ–" class="headerlink" title="èšåˆæœç´¢ä¼˜åŒ–"></a>èšåˆæœç´¢ä¼˜åŒ–</h1><p>é—®é¢˜ï¼šæ€æ ·èƒ½è®©å‰ç«¯ä¸€æ¬¡æœå‡ºæ‰€æœ‰æ•°æ®ã€åˆèƒ½åˆ†åˆ«è·å–æŸä¸€ç±»æ•°æ®ï¼ˆæ¯”å¦‚åˆ†é¡µåœºæ™¯ï¼‰</p><p>è§£å†³æ–¹æ¡ˆï¼š</p><p>æ–°å¢ type å­—æ®µï¼šå‰ç«¯ä¼  type è°ƒç”¨ååç«¯åŒä¸€ä¸ªæ¥å£ï¼Œåç«¯æ ¹æ® type ä¸åŒè°ƒç”¨ä¸åŒçš„ service æŸ¥è¯¢</p><p>æ¯”å¦‚å‰ç«¯ä¼ é€’ type &#x3D; post ï¼Œåç«¯æ‰§è¡Œ postService.query</p><p>é€»è¾‘ï¼š</p><ol><li>å¦‚æœ type ä¸ºç©ºï¼Œé‚£ä¹ˆæœç´¢å‡ºæ‰€æœ‰æ•°æ®</li><li>å¦‚æœ é€šå“Ÿé¢ ä¸ä¸ºç©º<ol><li>å¦‚æœ type åˆæ³•ï¼ŒæŸ¥å‡ºå¯¹åº”æ•°æ®</li><li>å¦åˆ™æŠ¥é”™</li></ol></li></ol><p>å­˜åœ¨çš„é—®é¢˜ï¼š type å¢å¤šåï¼Œè¦æŠŠæŸ¥è¯¢é€»è¾‘å †ç§¯åœ¨ controller ä»£ç é‡Œå—ï¼Ÿ</p><p>æ€è€ƒï¼šå¦‚ä½•è®©æœç´¢ç³»ç»Ÿ <strong>æ›´æœ‰æ•ˆåœ°</strong>æ¥å…¥æ›´å¤šçš„æ•°æ®æºï¼Ÿ</p><h2 id="é—¨é¢æ¨¡å¼"><a href="#é—¨é¢æ¨¡å¼" class="headerlink" title="é—¨é¢æ¨¡å¼"></a>é—¨é¢æ¨¡å¼</h2><p>ä»‹ç»ï¼šå¸®åŠ©æˆ‘ä»¬ç”¨æˆ·ï¼ˆå®¢æˆ·ç«¯ï¼‰æ›´è½»æ¾åœ°å®ç°åŠŸèƒ½ï¼Œä¸éœ€è¦å…³æ³¨é—¨é¢èƒŒåçš„ç»†èŠ‚</p><p>èšåˆæœç´¢ä¸šåŠ¡åŸºæœ¬éƒ½æ˜¯é—¨é¢æ¨¡å¼ï¼Œå³å‰ç«¯ä¸åŒå…³å¿ƒåç«¯ä»å“ªé‡Œæ¥ã€æ€ä¹ˆå»å–ä¸åŒæ¥æºã€æ€ä¹ˆå»èšåˆä¸åŒæ¥æºçš„æ•°æ®ï¼Œæ›´æ–¹ä¾¿åœ°è·å–åˆ°å†…å®¹ã€‚</p><p>å½“è°ƒç”¨ç³»ç»Ÿï¼ˆæ¥å£ï¼‰çš„å®¢æˆ·ç«¯è§‰å¾—éº»çƒ¦æ—¶ï¼Œéœ€è¦è€ƒè™‘æ˜¯å¦å¯ä»¥æŠ½è±¡ä¸€ä¸ªé—¨é¢ã€‚</p><h2 id="é€‚é…å™¨æ¨¡å¼"><a href="#é€‚é…å™¨æ¨¡å¼" class="headerlink" title="é€‚é…å™¨æ¨¡å¼"></a>é€‚é…å™¨æ¨¡å¼</h2><p>1ï¼‰å®šåˆ¶ç»Ÿä¸€çš„æ•°æ®æºæ¥å…¥è§„èŒƒï¼ˆæ ‡å‡†ï¼‰ï¼š</p><ul><li>ä»€ä¹ˆæ•°æ®æºå…è®¸æ¥å…¥ï¼Ÿ</li><li>æ•°æ®æºæ¥å…¥çš„æ—¶å€™éœ€è¦æ»¡è¶³ä»€ä¹ˆæ¡ä»¶</li><li>éœ€è¦æ¥å…¥æ–¹çš„æ³¨æ„äº‹é¡¹</li></ul><p>èšåˆæœç´¢ç³»ç»Ÿè¦æ±‚ï¼šä»»ä½•æ¥å…¥ç³»ç»Ÿçš„æ•°æ®ï¼Œéƒ½å¿…é¡»èƒ½å¤Ÿæ ¹æ®å…³é”®è¯æœç´¢ã€å¹¶ä¸”æ”¯æŒåˆ†é¡µæœç´¢</p><p>é€šè¿‡å£°æ˜æ¥å£çš„æ–¹å¼æ¥å®šä¹‰è§„èŒƒã€‚</p><p>2ï¼‰å¦‚æœæ•°æ®æºå·²ç»æ”¯æŒäº†æœç´ ï¼Œä½†æ˜¯åŸæœ‰çš„æ–¹æ³•å‚æ•°å’Œæˆ‘ä»¬è§„èŒƒçš„ä¸ä¸€è‡´ï¼Œå¦‚ä½•è§£å†³ï¼Ÿ</p><p>ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ï¼šé€šè¿‡è½¬æ¢ï¼Œè®©ä¸¤ä¸ªç³»ç»Ÿèƒ½å¤Ÿå®Œæˆå¯¹æ¥ã€‚</p><h2 id="æ³¨å†Œå™¨æ¨¡å¼"><a href="#æ³¨å†Œå™¨æ¨¡å¼" class="headerlink" title="æ³¨å†Œå™¨æ¨¡å¼"></a>æ³¨å†Œå™¨æ¨¡å¼</h2><p>æå‰é€šè¿‡ä¸€ä¸ª map æˆ–è€…å…¶ä»–ç±»å‹å­˜å‚¨å¥½åé¢éœ€è¦è°ƒç”¨çš„å¯¹è±¡ã€‚</p><p>æ•ˆæœï¼šæ›¿æ¢äº† if â€¦ else â€¦, ä»£ç é‡å¤§å¹…åº¦å‡å°‘ï¼Œå¯ç»´æŠ¤å¯æ‰©å±•ã€‚</p><h2 id="æœç´¢ä¼˜åŒ–"><a href="#æœç´¢ä¼˜åŒ–" class="headerlink" title="æœç´¢ä¼˜åŒ–"></a>æœç´¢ä¼˜åŒ–</h2><p>ç°æœ‰é—®é¢˜ï¼šæœç´¢ä¸çµæ´»</p><p>æ¯”å¦‚æœ â€å¢¨æ«rapperâ€œ æ— æ³•æœç´¢åˆ° â€å¢¨æ«æ˜¯rapperâ€œ å› ä¸º MySQL æ•°æ®åº“çš„ like æ˜¯åŒ…å«æŸ¥è¯¢ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;èšåˆæœç´¢ä¼˜åŒ–&quot;&gt;&lt;a href=&quot;#èšåˆæœç´¢ä¼˜åŒ–&quot; class=&quot;headerlink&quot; title=&quot;èšåˆæœç´¢ä¼˜åŒ–&quot;&gt;&lt;/a&gt;èšåˆæœç´¢ä¼˜åŒ–&lt;/h1&gt;&lt;p&gt;é—®é¢˜ï¼šæ€æ ·èƒ½è®©å‰ç«¯ä¸€æ¬¡æœå‡ºæ‰€æœ‰æ•°æ®ã€åˆèƒ½åˆ†åˆ«è·å–æŸä¸€ç±»æ•°æ®ï¼ˆæ¯”å¦‚åˆ†é¡µåœºæ™¯ï¼‰&lt;/p&gt;
&lt;p&gt;è§£å†³æ–¹æ¡ˆï¼š&lt;/p&gt;</summary>
      
    
    
    
    <category term="èšåˆæœç´¢å¹³å°" scheme="http://example.com/categories/%E8%81%9A%E5%90%88%E6%90%9C%E7%B4%A2%E5%B9%B3%E5%8F%B0/"/>
    
    
    <category term="æ˜Ÿçƒé¡¹ç›®" scheme="http://example.com/tags/%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>äºŒã€èšåˆæœç´¢å¹³å°æ•°æ®æŠ“å–</title>
    <link href="http://example.com/2023/05/03/%E4%BA%8C%E3%80%81%E8%81%9A%E5%90%88%E6%90%9C%E7%B4%A2%E5%B9%B3%E5%8F%B0%E6%95%B0%E6%8D%AE%E6%8A%93%E5%8F%96/"/>
    <id>http://example.com/2023/05/03/%E4%BA%8C%E3%80%81%E8%81%9A%E5%90%88%E6%90%9C%E7%B4%A2%E5%B9%B3%E5%8F%B0%E6%95%B0%E6%8D%AE%E6%8A%93%E5%8F%96/</id>
    <published>2023-05-03T15:27:51.300Z</published>
    <updated>2023-03-21T14:58:08.522Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èšåˆæœç´¢å¹³å°æ•°æ®æŠ“å–"><a href="#èšåˆæœç´¢å¹³å°æ•°æ®æŠ“å–" class="headerlink" title="èšåˆæœç´¢å¹³å°æ•°æ®æŠ“å–"></a>èšåˆæœç´¢å¹³å°æ•°æ®æŠ“å–</h1><p>æœ¬ç« å†…å®¹</p><ol><li>è·å–å¤šç§ä¸åŒç±»å‹çš„æ•°æ®æº<ol><li>æ–‡ç« ï¼ˆå†…éƒ¨ï¼‰</li><li>ç”¨æˆ·ï¼ˆå†…éƒ¨ï¼‰</li><li>å›¾ç‰‡ï¼ˆå¤–éƒ¨ï¼Œä¸æ˜¯æˆ‘ä»¬è‡ªå·±çš„é¡¹ç›®ã€è‡ªå·±çš„ç”¨æˆ·ç”Ÿäº§çš„æ•°æ®ï¼‰</li></ol></li><li>å‰åç«¯å•ç‹¬çš„æœç´¢æ¥å£è”è°ƒï¼Œè·‘é€šæ•´ä¸ªé¡µé¢</li><li>åˆ†æç°æœ‰é¡¹ç›®çš„é—®é¢˜ &#x3D;&gt; ä¼˜åŒ–ï¼Œèšåˆæ¥å£çš„å¼€å‘</li></ol><h2 id="è·å–ä¸åŒç±»å‹çš„æ•°æ®æº"><a href="#è·å–ä¸åŒç±»å‹çš„æ•°æ®æº" class="headerlink" title="è·å–ä¸åŒç±»å‹çš„æ•°æ®æº"></a>è·å–ä¸åŒç±»å‹çš„æ•°æ®æº</h2><h3 id="æ•°æ®æŠ“å–æµç¨‹"><a href="#æ•°æ®æŠ“å–æµç¨‹" class="headerlink" title="æ•°æ®æŠ“å–æµç¨‹"></a>æ•°æ®æŠ“å–æµç¨‹</h3><ol><li>åˆ†ææ•°æ®æºï¼ˆæ€ä¹ˆè·å–ï¼Ÿï¼‰</li><li>æ‹¿åˆ°æ•°æ®åï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ</li><li>å†™å…¥æ•°æ®ç­‰å­˜å‚¨</li></ol><h3 id="æ•°æ®æŠ“å–çš„å‡ ç§æ–¹å¼"><a href="#æ•°æ®æŠ“å–çš„å‡ ç§æ–¹å¼" class="headerlink" title="æ•°æ®æŠ“å–çš„å‡ ç§æ–¹å¼"></a>æ•°æ®æŠ“å–çš„å‡ ç§æ–¹å¼</h3><ol><li>ç›´æ¥è¯·æ±‚æ•°æ®ç»“æ„ï¼ˆæœ€æ–¹ä¾¿ï¼‰ HttpClientã€OkHttpã€RestTemplateã€Hutool(<a href="https://hutool.cn/">https://hutool.cn/</a>)</li><li>ç­‰ç½‘é¡µæ¸²æŸ“å‡ºæ˜æ–‡å†…å®¹åï¼Œä»å‰ç«¯é¡µé¢çš„å†…å®¹æŠ“å–</li><li>æœ‰ä¸€äº›ç½‘ç«™å¯èƒ½æ˜¯åŠ¨æ€è¯·æ±‚çš„ï¼Œå®ƒä¸ä¼šä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰çš„æ•°æ®ï¼Œè€Œæ˜¯è¦ä½ ç‚¹å‡»æŸä¸€ä¸ªæŒ‰é’®ã€è¾“å…¥æŸä¸ªéªŒè¯ç æ‰ä¼šæ˜¾ç¤ºå‡ºæ•°æ®ã€‚ &#x3D;&gt; æ— å¤´æµè§ˆå™¨ï¼š seleniumã€node.js puppeteer</li></ol><p><strong>æ³¨æ„ï¼šçˆ¬è™«æŠ€æœ¯ä¸èƒ½æ»¥ç”¨ï¼Œä¸èƒ½ç»™åˆ«äººçš„ç³»ç»Ÿé€ æˆå‹åŠ›ã€ä¸è¦ä¾µçŠ¯ä»–äººæƒç›Šï¼</strong></p><h3 id="1ã€è·å–æ–‡ç« "><a href="#1ã€è·å–æ–‡ç« " class="headerlink" title="1ã€è·å–æ–‡ç« "></a>1ã€è·å–æ–‡ç« </h3><p>è¦æ˜¯å†…éƒ¨æ²¡æœ‰æ–‡ç« ï¼Œå¯ä»¥ä»äº’è”ç½‘ä¸Šè·å–åŸºç¡€æ•°æ® &#x3D;&gt; çˆ¬è™«</p><p>æŠ“å–ï¼š<a href="https://www.code-nav.cn/learn/passage">https://www.code-nav.cn/learn/passage</a></p><p>è·å–æ–‡ç« åè¦å…¥åº“ï¼ˆå®šæ—¶è·å–æˆ–è€…åªè·å–ä¸€æ¬¡ï¼‰ï¼Œ<strong>ç¦»çº¿æŠ“å–</strong></p><h3 id="2ã€ç”¨æˆ·è·å–"><a href="#2ã€ç”¨æˆ·è·å–" class="headerlink" title="2ã€ç”¨æˆ·è·å–"></a>2ã€ç”¨æˆ·è·å–</h3><p>æ¯ä¸ªç½‘ç«™çš„ç”¨æˆ·åŸºæœ¬éƒ½æ˜¯è‡ªå·±çš„ï¼Œä¸€èˆ¬æ— éœ€ä»ç«™å¤–è·å–</p><h3 id="3ã€å›¾ç‰‡è·å–"><a href="#3ã€å›¾ç‰‡è·å–" class="headerlink" title="3ã€å›¾ç‰‡è·å–"></a>3ã€å›¾ç‰‡è·å–</h3><p>å®æ—¶æŠ“å–ï¼šæˆ‘ä»¬è‡ªå·±çš„ç½‘ç«™ä¸å­˜å‚¨è¿™äº›æ•°æ®ï¼Œç”¨æˆ·è¦æœç´¢çš„æ—¶å€™ï¼Œç›´æ¥ä»åˆ«äººçš„æ¥å£ï¼ˆç½‘ç«™ï¼‰å»æœç´¢</p><p>jsoup åº“ï¼šè·å–åˆ° HTML æ–‡æ¡£ï¼Œç„¶åä»ä¸­è§£æå‡ºéœ€è¦çš„å­—æ®µ</p><h2 id="ç°æœ‰ä¸šåŠ¡åœºæ™¯åˆ†æ"><a href="#ç°æœ‰ä¸šåŠ¡åœºæ™¯åˆ†æ" class="headerlink" title="ç°æœ‰ä¸šåŠ¡åœºæ™¯åˆ†æ"></a>ç°æœ‰ä¸šåŠ¡åœºæ™¯åˆ†æ</h2><p>ç›®å‰æ˜¯åœ¨é¡µé¢åŠ è½½æ—¶ï¼Œè°ƒç”¨ä¸‰ä¸ªæ¥å£åˆ†åˆ«è·å–æ–‡ç« ã€å›¾ç‰‡ã€ç”¨æˆ·æ•°æ®</p><p>å‡ ç§ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼š</p><ol><li>å…¶ä»–å¯ä»¥ç”¨æˆ·ç‚¹æŸä¸ª tab çš„æ—¶å€™ï¼Œåªè°ƒç”¨è¿™ä¸ª tab æ¥å£ï¼ˆå¦‚ï¼š<a href="https://www.code-nav.cn/search/all?current=2&amp;pageSize=8&amp;searchText=&amp;sortField=_score&amp;sortOrder=descend%EF%BC%89">https://www.code-nav.cn/search/all?current=2&amp;pageSize=8&amp;searchText=&amp;sortField=_score&amp;sortOrder=descendï¼‰</a></li><li>å¦‚æœé’ˆå¯¹èšåˆå†…å®¹çš„ç½‘é¡µï¼Œå…¶å®å¯ä»¥ä¸€ä¸ªè¯·æ±‚æå®šï¼ˆå¦‚ï¼š<a href="https://tophub.today/%EF%BC%89">https://tophub.today/ï¼‰</a></li><li>æœ‰å¯èƒ½è¿˜æœ‰æŸ¥è¯¢å…¶ä»–çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å…¶ä»–æ•°æ®çš„æ€»æ•°ï¼ŒåŒæ—¶ç»™ç”¨æˆ·åé¦ˆ</li></ol><p><strong>æ ¹æ®å®é™…æƒ…å†µè‡ªè¡Œé€‰æ‹©</strong></p><p>å­˜åœ¨çš„é—®é¢˜ï¼š</p><ol><li>è¯·æ±‚æ•°é‡æ¯”è¾ƒå¤šï¼Œå¯èƒ½ä¼šå—åˆ°æµè§ˆå™¨çš„é™åˆ¶</li><li>è¯·æ±‚ä¸åŒæ¥å£çš„å‚æ•°å¯èƒ½ä¸ä¸€æ ·ï¼Œå¢åŠ å‰ç«¯æ²Ÿé€šæˆæœ¬</li><li>å‰ç«¯å†™è°ƒç”¨å¤šä¸ªæ¥å£çš„ä»£ç ï¼Œé‡å¤ä»£ç </li></ol><h2 id="èšåˆæ¥å£"><a href="#èšåˆæ¥å£" class="headerlink" title="èšåˆæ¥å£"></a>èšåˆæ¥å£</h2><ol><li><p>è¯·æ±‚æ•°é‡æ¯”è¾ƒå¤šï¼Œå¯èƒ½ä¼šå—åˆ°æµè§ˆå™¨çš„é™åˆ¶ &#x3D;&gt; ç”¨ä¸€ä¸ªæ¥å£è¯·æ±‚å®Œæ‰€æœ‰çš„æ•°æ®ï¼ˆåç«¯å¯ä»¥å¹¶å‘ï¼Œå‡ ä¹æ²¡æœ‰å¹¶å‘æ•°é‡é™åˆ¶ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    user = userService.<span class="type">query</span></span><br><span class="line">    <span class="variable">post</span> <span class="operator">=</span> postService.<span class="type">query</span></span><br><span class="line">    <span class="variable">picture</span> <span class="operator">=</span> pictureService.query</span><br><span class="line">    <span class="keyword">return</span> user + post + picture</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>è¯·æ±‚ä¸åŒæ¥å£çš„å‚æ•°å¯èƒ½ä¸ä¸€æ ·ï¼Œå¢åŠ å‰ç«¯æ²Ÿé€šæˆæœ¬ &#x3D;&gt; ç”¨ä¸€ä¸ªæ¥å£æŠŠè¯·æ±‚å‚æ•°ç»Ÿä¸€ï¼Œå‰ç«¯æ¯æ¬¡ä¼ å›ºå®šçš„å‚æ•°ï¼Œåç«¯å»å¯¹å‚æ•°è¿›è¡Œè½¬æ¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    å‰ç«¯ç»Ÿä¸€ä¼  searchText</span><br><span class="line">    åç«¯æŠŠ searchText è½¬æ¢ä¸º userName =&gt; queryUser</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»Ÿä¸€è¿”å›ç»“æœï¼šæ¯”å¦‚ Page é¡µé¢å°è£…</p></li><li><p>å‰ç«¯å†™è°ƒç”¨å¤šä¸ªæ¥å£çš„ä»£ç ï¼Œé‡å¤ä»£ç  &#x3D;&gt; ç”¨ä¸€ä¸ªæ¥å£ï¼Œé€šè¿‡ä¸åŒçš„å‚æ•°å»åŒºåˆ†æŸ¥è¯¢çš„æ•°æ®æº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    å‰ç«¯ä¼  type è°ƒç”¨åç«¯åŒä¸€ä¸ªæ¥å£ï¼Œåç«¯æ ¹æ® type è°ƒç”¨ä¸åŒçš„ service æŸ¥è¯¢</span><br><span class="line">    æ¯”å¦‚ï¼štype = userService.query</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p><strong>å¹¶å‘ä¸ä¸€å®šæ›´å¿«ï¼çŸ­æ¿æ•ˆåº”ã€‚è¦ä»¥å®é™…ä¸ºå‡†</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;èšåˆæœç´¢å¹³å°æ•°æ®æŠ“å–&quot;&gt;&lt;a href=&quot;#èšåˆæœç´¢å¹³å°æ•°æ®æŠ“å–&quot; class=&quot;headerlink&quot; title=&quot;èšåˆæœç´¢å¹³å°æ•°æ®æŠ“å–&quot;&gt;&lt;/a&gt;èšåˆæœç´¢å¹³å°æ•°æ®æŠ“å–&lt;/h1&gt;&lt;p&gt;æœ¬ç« å†…å®¹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è·å–å¤šç§ä¸åŒç±»å‹çš„æ•°æ®æº&lt;ol&gt;
&lt;li</summary>
      
    
    
    
    <category term="èšåˆæœç´¢å¹³å°" scheme="http://example.com/categories/%E8%81%9A%E5%90%88%E6%90%9C%E7%B4%A2%E5%B9%B3%E5%8F%B0/"/>
    
    
    <category term="æ˜Ÿçƒé¡¹ç›®" scheme="http://example.com/tags/%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>Elastic Stack</title>
    <link href="http://example.com/2023/05/03/Elastic-Stack/"/>
    <id>http://example.com/2023/05/03/Elastic-Stack/</id>
    <published>2023-05-03T15:27:51.294Z</published>
    <updated>2023-05-03T15:25:18.524Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Elastic-Stack"><a href="#Elastic-Stack" class="headerlink" title="Elastic Stack"></a>Elastic Stack</h1><p>å®˜ç½‘åœ°å€ï¼š<a href="https://www.elastic.co/cn/">https://www.elastic.co/cn/</a></p><p>åŒ…å«äº†æ•°æ®çš„æ•´åˆ &#x3D;&gt; æå– &#x3D;&gt; å­˜å‚¨ &#x3D;&gt; ä½¿ç”¨ï¼Œä¸€æ•´å¥—</p><p>å„ä¸ªç»„ä»¶ä»‹ç»ï¼š</p><ul><li>beats å¥—ä»¶ï¼šä»å„ç§ä¸åŒç±»å‹çš„æ–‡ä»¶ &#x2F; åº”ç”¨ä¸­é‡‡é›†æ•°æ®ã€‚æ¯”å¦‚ï¼ša, b, c, d, e, aa, bb, cc</li><li>Logstash:ä»å¤šä¸ªé‡‡é›†å™¨æˆ–æ•°æ®æºæ¥æŠ½å– &#x2F; è½¬æ¢æ•°æ®ï¼Œå‘ ES è¾“é€ã€‚æ¯”å¦‚ï¼ša, bb, cc</li><li>elasticsearch:å­˜å‚¨ã€æŸ¥è¯¢æ•°æ®</li><li>kibana:å¯è§†åŒ– ES æ•°æ®</li></ul><h2 id="å®‰è£…-ES"><a href="#å®‰è£…-ES" class="headerlink" title="å®‰è£… ES"></a>å®‰è£… ES</h2><p>elasticsearch:<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/setup.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/setup.html</a></p><p>å®‰è£…ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/zip-windows.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/zip-windows.html</a></p><p><strong>æ³¨æ„ï¼šä¸€å¥—æŠ€æœ¯ï¼Œç‰ˆæœ¬å¿…é¡»è¦ä¸€è‡´ï¼Œæ­¤å¤„ä½¿ç”¨ 7.17 ç‰ˆæœ¬</strong></p><h2 id="å®‰è£…-Kibana"><a href="#å®‰è£…-Kibana" class="headerlink" title="å®‰è£… Kibana"></a>å®‰è£… Kibana</h2><p>Kibana:<a href="https://www.elastic.co/guide/en/kibana/7.17/introduction.html">https://www.elastic.co/guide/en/kibana/7.17/introduction.html</a></p><p>å®‰è£…ï¼š<a href="https://www.elastic.co/guide/en/kibana/7.17/install.html">https://www.elastic.co/guide/en/kibana/7.17/install.html</a></p><h2 id="ElasticSearch-æ¦‚å¿µ"><a href="#ElasticSearch-æ¦‚å¿µ" class="headerlink" title="ElasticSearch æ¦‚å¿µ"></a>ElasticSearch æ¦‚å¿µ</h2><p>å¯ä»¥ç†è§£ä¸º MySQL ä¸€æ ·çš„æ•°æ®åº“å»å­¦ä¹ å’Œç†è§£</p><p>å…¥é—¨å­¦ä¹ ï¼š</p><ul><li>Index ç´¢å¼• &#x3D;&gt; MySQL é‡Œçš„è¡¨ï¼ˆtableï¼‰</li><li>å»ºè¡¨ã€å¢åˆ æ”¹æŸ¥ï¼ˆæŸ¥è¯¢éœ€è¦èŠ±è´¹çš„æ—¶é—´è¾ƒå¤šï¼‰</li><li>ç”¨å®¢æˆ·ç«¯å»è°ƒç”¨ ElasticSearch(3ç§)</li><li>è¯­æ³•ï¼šSQLã€ä»£ç çš„æ–¹æ³•ï¼ˆ4ä¸­ç§è¯­æ³•ï¼‰</li></ul><p>ES ç›¸æ¯”äº MySQL èƒ½å¤Ÿè‡ªåŠ¨å¸®æˆ‘ä»¬åšåˆ†è¯ï¼Œèƒ½å¤Ÿéå¸¸é«˜æ•ˆã€çµæ´»åœ°æŸ¥è¯¢å†…å®¹</p><h3 id="ç´¢å¼•ï¼ˆå€’æ’ç´¢å¼•ï¼‰"><a href="#ç´¢å¼•ï¼ˆå€’æ’ç´¢å¼•ï¼‰" class="headerlink" title="ç´¢å¼•ï¼ˆå€’æ’ç´¢å¼•ï¼‰"></a>ç´¢å¼•ï¼ˆå€’æ’ç´¢å¼•ï¼‰</h3><p>æ­£å‘ç´¢å¼•ï¼šç†è§£ä¸ºä¹¦ç±çš„ç›®å½•ï¼Œå¯ä»¥å¿«é€Ÿæ‰¾åˆ°å¯¹åº”çš„å†…å®¹ï¼ˆæ€ä¹ˆæ ¹æ®é¡µç æ‰¾åˆ°æ–‡ç« ï¼‰</p><p>å€’æ’ç´¢å¼•ï¼šæ€ä¹ˆæ ¹æ®å†…å®¹æ‰¾åˆ°æ–‡ç« </p><p>æ–‡ç«  Aï¼šä½ å¥½ï¼Œæˆ‘æ˜¯ rapper</p><p>æ–‡ç«  Bï¼šå¢¨æ«ä½ å¥½ï¼Œæˆ‘æ˜¯ coder</p><p>åˆ‡è¯ï¼š</p><p>ä½ å¥½ï¼Œæˆ‘æ˜¯ï¼Œrapper</p><p>å¢¨æ«ï¼Œä½ å¥½ï¼Œæˆ‘æ˜¯ï¼Œcoder</p><p>æ„å»ºå€’æ’ç´¢å¼•è¡¨ï¼š</p><table><thead><tr><th>è¯</th><th>å†…å®¹ id</th></tr></thead><tbody><tr><td>ä½ å¥½</td><td>æ–‡ç«  Aï¼Œ B</td></tr><tr><td>æˆ‘æ˜¯</td><td>æ–‡ç«  Aï¼Œ B</td></tr><tr><td>rapper</td><td>æ–‡ç«  A</td></tr><tr><td>å¢¨æ«</td><td>æ–‡ç«  B</td></tr><tr><td>coder</td><td>æ–‡ç«  B</td></tr></tbody></table><p>ç”¨æˆ·æœï¼šâ€œå¢¨æ« rapperâ€</p><p>ES å…ˆåˆ‡è¯ï¼šå¢¨æ«ï¼Œ rapper</p><p>ç„¶åå»å€’æ’ç´¢å¼•å¯¹åº”çš„æ–‡ç« </p><h2 id="ESçš„å‡ ç§è°ƒç”¨æ–¹å¼"><a href="#ESçš„å‡ ç§è°ƒç”¨æ–¹å¼" class="headerlink" title="ESçš„å‡ ç§è°ƒç”¨æ–¹å¼"></a>ESçš„å‡ ç§è°ƒç”¨æ–¹å¼</h2><h3 id="1ï¼‰restful-api-è°ƒç”¨ï¼ˆHTTP-è¯·æ±‚ï¼‰"><a href="#1ï¼‰restful-api-è°ƒç”¨ï¼ˆHTTP-è¯·æ±‚ï¼‰" class="headerlink" title="1ï¼‰restful api è°ƒç”¨ï¼ˆHTTP è¯·æ±‚ï¼‰"></a>1ï¼‰restful api è°ƒç”¨ï¼ˆHTTP è¯·æ±‚ï¼‰</h3><p>GETè¯·æ±‚ï¼š<a href="http://localhost:9200/">http://localhost:9200/</a></p><p>curl å¯ä»¥æ¨¡æ‹Ÿå‘é€è¯·æ±‚ï¼šcurl -X GET â€œlocalhost:9200&#x2F;?prettyâ€</p><p>ES çš„å¯åŠ¨ç«¯å£</p><ol><li>9200ï¼šç»™å¤–éƒ¨ç”¨æˆ·ï¼ˆç»™å®¢æˆ·ç«¯è°ƒç”¨ï¼‰çš„ç«¯å£</li><li>9300ï¼šç»™ ES é›†ç¾¤å†…éƒ¨é€šä¿¡çš„ï¼ˆå¤–éƒ¨è°ƒç”¨ä¸äº†ï¼‰</li></ol><h3 id="2-kibana-devtools"><a href="#2-kibana-devtools" class="headerlink" title="2)kibana devtools"></a>2)kibana devtools</h3><p>è‡ªç”±åœ°å¯¹ ES è¿›è¡Œæ“ä½œï¼ˆæœ¬è´¨ä¸Šä¹Ÿæ˜¯ restful api)</p><p>devtools ä¸å»ºè®®ç”Ÿäº§ç¯å¢ƒä½¿ç”¨</p><h3 id="3ï¼‰å®¢æˆ·ç«¯è°ƒç”¨"><a href="#3ï¼‰å®¢æˆ·ç«¯è°ƒç”¨" class="headerlink" title="3ï¼‰å®¢æˆ·ç«¯è°ƒç”¨"></a>3ï¼‰å®¢æˆ·ç«¯è°ƒç”¨</h3><p>java å®¢æˆ·ç«¯ã€go å®¢æˆ·ç«¯ç­‰</p><p>å‚è€ƒæ–‡æ¡£ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/client/java-api-client/7.17/_getting_started.html">https://www.elastic.co/guide/en/elasticsearch/client/java-api-client/7.17/_getting_started.html</a></p><h2 id="ES-è¯­æ³•"><a href="#ES-è¯­æ³•" class="headerlink" title="ES è¯­æ³•"></a>ES è¯­æ³•</h2><h3 id="DSL"><a href="#DSL" class="headerlink" title="DSL"></a>DSL</h3><p>json æ ¼å¼ï¼Œå¥½ç†è§£ï¼›é¢ Http è¯·æ±‚æœ€å…¼å®¹ï¼Œåº”ç”¨æœ€å¹¿</p><h4 id="å»ºè¡¨ã€æ’å…¥æ•°æ®"><a href="#å»ºè¡¨ã€æ’å…¥æ•°æ®" class="headerlink" title="å»ºè¡¨ã€æ’å…¥æ•°æ®"></a>å»ºè¡¨ã€æ’å…¥æ•°æ®</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST post/_doc/pqGEzYcB9-HYm7AKfgyO</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¢¨æ«33333&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¢¨æ«çš„æè¿°33333&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h4><p>DSL è¯­æ³•ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/query-dsl.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/query-dsl.html</a></p><p>ï¼ˆéšå¿˜éšæŸ¥ï¼‰</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET post/_search</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;query&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;match_all&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;sort&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@timestamp&quot;</span><span class="punctuation">:</span> <span class="string">&quot;desc&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>æ ¹æ® id æŸ¥è¯¢ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET post/_doc/pqGEzYcB9-HYm7AKfgyO</span><br></pre></td></tr></table></figure><h4 id="ä¿®æ”¹"><a href="#ä¿®æ”¹" class="headerlink" title="ä¿®æ”¹"></a>ä¿®æ”¹</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST post/_doc/pqGEzYcB9-HYm7AKfgyO</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¢¨æ«&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¢¨æ«çš„æè¿°&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h4><p>åˆ é™¤æ™®é€šç´¢å¼•</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE index_name</span><br></pre></td></tr></table></figure><p>åˆ é™¤æ•°æ®æµå¼ç´¢å¼•</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE _data_stream/post</span><br></pre></td></tr></table></figure><h3 id="EQL"><a href="#EQL" class="headerlink" title="EQL"></a>EQL</h3><p>ä¸“é—¨æŸ¥è¯¢ ECS æ–‡æ¡£ï¼ˆæ ‡å‡†æŒ‡æ ‡æ–‡æ¡£ï¼‰çš„æ•°æ®çš„è¯­æ³•ï¼Œæ›´åŠ è§„èŒƒï¼Œä½†åªé€‚ç”¨äºç‰¹å®šåœºæ™¯ï¼ˆæ¯”å¦‚äº‹ä»¶æµï¼‰</p><p>æ–‡æ¡£ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/eql.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/eql.html</a></p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST my_event/_doc</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¢¨æ«33333&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;@timestamp&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2099-05-06T16:21:15.000Z&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;event&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;original&quot;</span><span class="punctuation">:</span> <span class="string">&quot;192.0.2.42 - - [06/May/2099:16:21:15 +0000] \&quot;GET /images/bg.jpg HTTP/1.0\&quot; 200 24736&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">GET /my_event/_eql/search</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;query&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    any where 1 == 1</span></span><br><span class="line"><span class="string">  &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h3><p>æ–‡æ¡£ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/sql-getting-started.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/sql-getting-started.html</a></p><p>å­¦ä¹ æˆæœ¬ä½ï¼Œä½†æ˜¯å¯èƒ½éœ€è¦æ’ä»¶æ”¯æŒã€<strong>æ€§èƒ½è¾ƒå·®</strong></p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /_sql?format=txt</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;query&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SELECT * FROM post where title like &#x27;å¢¨æ«%&#x27;&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Painless-Scripting-language"><a href="#Painless-Scripting-language" class="headerlink" title="Painless Scripting language"></a>Painless Scripting language</h3><p>ç¼–ç¨‹å¼å–å€¼ï¼Œæ›´çµæ´»ï¼Œä½†æ˜¯å­¦ä¹ æˆæœ¬é«˜</p><h2 id="Mapping"><a href="#Mapping" class="headerlink" title="Mapping"></a>Mapping</h2><p>æ–‡æ¡£ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/explicit-mapping.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/explicit-mapping.html</a></p><p>å¯ä»¥ç†è§£ä¸ºæ•°æ®åº“çš„è¡¨ç»“æ„ï¼Œæœ‰å“ªäº›å­—æ®µã€å­—æ®µç±»å‹ã€‚</p><p>ES æ”¯æŒåŠ¨æ€ mappingï¼Œè¡¨ç»“æ„å¯ä»¥åŠ¨æ€æ”¹å˜ï¼Œè€Œä¸åƒ MySQL ä¸€æ ·å¿…é¡»æ‰‹åŠ¨å»ºè¡¨ï¼Œæ²¡æœ‰çš„å­—æ®µå°±ä¸èƒ½æ’å…¥ã€‚</p><p>æ˜¾ç¤ºåˆ›å»º mappingï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET user/_mapping</span><br><span class="line">PUT user</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span>    <span class="punctuation">&#123;</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;integer&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span>  </span><br><span class="line">      <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span>  <span class="punctuation">&#123;</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;keyword&quot;</span>  <span class="punctuation">&#125;</span><span class="punctuation">,</span> </span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span>   <span class="punctuation">&#123;</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span>  <span class="punctuation">&#125;</span>     </span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="ElasticStack-æ¦‚å¿µ"><a href="#ElasticStack-æ¦‚å¿µ" class="headerlink" title="ElasticStack æ¦‚å¿µ"></a>ElasticStack æ¦‚å¿µ</h2><p>ES ç´¢å¼•ï¼ˆIndexï¼‰ &#x3D;&gt; è¡¨</p><p>ES field  (å­—æ®µ) &#x3D;&gt; åˆ—</p><p>å€’æ’ç´¢å¼•</p><p>è°ƒç”¨è¯­æ³•ï¼ˆDSLã€EQLã€SQLç­‰ï¼‰</p><p>Mapping è¡¨ç»“æ„</p><ul><li>è‡ªåŠ¨ç”Ÿæˆ mapping</li><li>æ‰‹åŠ¨æŒ‡å®š mapping</li></ul><h3 id="åˆ†è¯å™¨"><a href="#åˆ†è¯å™¨" class="headerlink" title="åˆ†è¯å™¨"></a>åˆ†è¯å™¨</h3><p>å†…ç½®åˆ†è¯å™¨ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/analysis-analyzers.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/analysis-analyzers.html</a></p><p>ç©ºæ ¼åˆ†è¯å™¨ï¼šwhitespaceï¼Œç»“æœ Theã€quickã€brownã€foxç­‰</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST _analyze</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;analyzer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;whitespace&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span>     <span class="string">&quot;The quick is brown fox.&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>æ ‡å‡†åˆ†è¯è§„åˆ™ï¼Œç»“æœï¼šisã€thisã€dejaã€vu</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST _analyze</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;tokenizer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;standard&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;filter&quot;</span><span class="punctuation">:</span>  <span class="punctuation">[</span> <span class="string">&quot;lowercase&quot;</span><span class="punctuation">,</span> <span class="string">&quot;asciifolding&quot;</span> <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span>      <span class="string">&quot;Is this dÃ©ja vu?&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å…³é”®è¯åˆ†è¯å™¨ï¼šå°±æ˜¯ä¸åˆ†è¯ï¼Œæ•´å¥è¯å½“ä½œä¸“ä¸šæœ¯è¯­</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST _analyze</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;analyzer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;keyword&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span>     <span class="string">&quot;The quick is brown fox.&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="IK-åˆ†è¯å™¨ï¼ˆES-æ’ä»¶ï¼‰"><a href="#IK-åˆ†è¯å™¨ï¼ˆES-æ’ä»¶ï¼‰" class="headerlink" title="IK åˆ†è¯å™¨ï¼ˆES æ’ä»¶ï¼‰"></a>IK åˆ†è¯å™¨ï¼ˆES æ’ä»¶ï¼‰</h3><p>ä¸­æ–‡å‹å¥½ï¼š<a href="https://github.com/medcl/elasticsearch-analysis-ik">https://github.com/medcl/elasticsearch-analysis-ik</a></p><p>ä¸‹è½½åœ°å€ï¼ˆæ³¨æ„ç‰ˆæœ¬ä¸€è‡´ï¼‰ï¼š<a href="https://github.com/medcl/elasticsearch-analysis-ik/releases/tag/v7.17.7">https://github.com/medcl/elasticsearch-analysis-ik/releases/tag/v7.17.7</a></p><p>æ€è€ƒï¼šå¦‚ä½•è®© IK æŒ‰ç…§è‡ªå·±çš„æƒ³æ³•åˆ†è¯ï¼Ÿ</p><p>è§£å†³æ–¹æ¡ˆï¼šè‡ªå®šä¹‰è¯å…¸</p><p>ik_smart å’Œ ik_max_word çš„åŒºåˆ«ï¼š</p><p>ä¸¾ä¾‹ï¼šâ€œå°é»‘å­â€</p><p>ik_smart æ˜¯åªèƒ½åˆ†è¯ï¼Œå°½é‡é€‰æ‹©æœ€åƒä¸€ä¸ªè¯çš„æ‹†åˆ†æ–¹å¼ï¼Œæ¯”å¦‚â€œå°â€ã€â€œé»‘å­â€</p><p>ik_max_word å°½å¯èƒ½åœ°åˆ†è¯ï¼Œå¯ä»¥åŒ…æ‹¬ç»„åˆè¯ï¼Œæ¯”å¦‚â€œå°é»‘â€ã€â€œé»‘å­â€œ</p><h3 id="æ‰“åˆ†æœºåˆ¶"><a href="#æ‰“åˆ†æœºåˆ¶" class="headerlink" title="æ‰“åˆ†æœºåˆ¶"></a>æ‰“åˆ†æœºåˆ¶</h3><p>æ¯”å¦‚æœ‰ 3 æ¡å†…å®¹ï¼š</p><ol><li>å¢¨æ«æ˜¯ç‹—</li><li>å¢¨æ«æ˜¯å°é»‘å­</li><li>æˆ‘æ˜¯å°é»‘å­</li></ol><p>ç”¨æˆ·æœç´¢ï¼š</p><ol><li>å¢¨æ«ï¼Œç¬¬ä¸€æ¡åˆ†æ•°æœ€é«˜ï¼Œå› ä¸ºç¬¬ä¸€æ¡åŒ¹é…äº†å…³é”®è¯ï¼Œè€Œä¸”æ›´çŸ­ï¼ˆåŒ¹é…æ¯”ä¾‹æ›´å¤§ï¼‰</li><li>å¢¨æ«å°é»‘å­ &#x3D;&gt; å¢¨æ«ã€å°ã€é»‘å­ï¼Œæ’åºç»“æœï¼š2 &gt; 3 &gt; 1</li></ol><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://liyupi.blog.csdn.net/article/details/119176943">https://liyupi.blog.csdn.net/article/details/119176943</a></p><p>å®˜æ–¹å‚è€ƒæ–‡ç« ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/guide/master/controlling-relevance.html">https://www.elastic.co/guide/en/elasticsearch/guide/master/controlling-relevance.html</a></p><h2 id="ES-è°ƒç”¨æ–¹å¼"><a href="#ES-è°ƒç”¨æ–¹å¼" class="headerlink" title="ES è°ƒç”¨æ–¹å¼"></a>ES è°ƒç”¨æ–¹å¼</h2><p>æœ‰ 3 ç§ï¼š</p><ol><li>HTTP Restful è°ƒç”¨</li><li>kibana æ“ä½œï¼ˆdev tools)</li><li>å®¢æˆ·ç«¯æ“ä½œï¼ˆJavaï¼‰</li></ol><h3 id="Java-æ“ä½œ-ES"><a href="#Java-æ“ä½œ-ES" class="headerlink" title="Java æ“ä½œ ES"></a>Java æ“ä½œ ES</h3><p>3 ç§æ–¹å¼ï¼š</p><p>1ï¼‰ES å®˜æ–¹çš„ Java API</p><p><a href="https://www.elastic.co/guide/en/elasticsearch/client/java-api-client/7.17/introduction.html">https://www.elastic.co/guide/en/elasticsearch/client/java-api-client/7.17/introduction.html</a></p><p>å¿«é€Ÿå¼€å§‹ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/client/java-api-client/7.17/connecting.html">https://www.elastic.co/guide/en/elasticsearch/client/java-api-client/7.17/connecting.html</a></p><p>2ï¼‰ES ä»¥å‰çš„å®˜æ–¹ Java APIï¼Œ HighLevelRestClientï¼ˆå·²ç»åºŸå¼ƒï¼Œä¸å»ºè®®ä½¿ç”¨ï¼‰</p><p>3ï¼‰Spring Data Elasticsearchï¼ˆæ¨èï¼‰</p><p>spring-data ç³»åˆ—ï¼šspring æä¾›çš„æ“ä½œæ•°æ®çš„æ¡†æ¶</p><p>spring-data-redis:æ“ä½œ Redis çš„ä¸€å¥—æ–¹æ³•</p><p>spring-data-mongodb:æ“ä½œ mongodb çš„ä¸€å¥—æ–¹æ³•</p><p>spring-data-elasticsearch:æ“ä½œ elasticsearch çš„ä¸€å¥—æ–¹æ³•</p><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.spring.io/spring-data/elasticsearch/docs/4.4.10/reference/html/">https://docs.spring.io/spring-data/elasticsearch/docs/4.4.10/reference/html/</a></p><p>è‡ªå®šä¹‰æ–¹æ³•ï¼šç”¨æˆ·å¯ä»¥æŒ‡å®šæ¥å£çš„æ–¹æ³•åç§°ï¼Œæ¡†æ¶å¸®ä½ è‡ªåŠ¨ç”ŸæˆæŸ¥è¯¢</p><h2 id="ç”¨-ES-å®ç°æœç´¢æ¥å£"><a href="#ç”¨-ES-å®ç°æœç´¢æ¥å£" class="headerlink" title="ç”¨ ES å®ç°æœç´¢æ¥å£"></a>ç”¨ ES å®ç°æœç´¢æ¥å£</h2><h3 id="1ã€å»ºè¡¨ï¼ˆå»ºç«‹ç´¢å¼•ï¼‰"><a href="#1ã€å»ºè¡¨ï¼ˆå»ºç«‹ç´¢å¼•ï¼‰" class="headerlink" title="1ã€å»ºè¡¨ï¼ˆå»ºç«‹ç´¢å¼•ï¼‰"></a>1ã€å»ºè¡¨ï¼ˆå»ºç«‹ç´¢å¼•ï¼‰</h3><p>æ•°æ®åº“è¡¨ç»“æ„ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- å¸–å­è¡¨</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> post</span><br><span class="line">(</span><br><span class="line">    id         <span class="type">bigint</span> auto_increment comment <span class="string">&#x27;id&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    title      <span class="type">varchar</span>(<span class="number">512</span>)                       <span class="keyword">null</span> comment <span class="string">&#x27;æ ‡é¢˜&#x27;</span>,</span><br><span class="line">    content    text                               <span class="keyword">null</span> comment <span class="string">&#x27;å†…å®¹&#x27;</span>,</span><br><span class="line">    tags       <span class="type">varchar</span>(<span class="number">1024</span>)                      <span class="keyword">null</span> comment <span class="string">&#x27;æ ‡ç­¾åˆ—è¡¨ï¼ˆjson æ•°ç»„ï¼‰&#x27;</span>,</span><br><span class="line">    thumbNum   <span class="type">int</span>      <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;ç‚¹èµæ•°&#x27;</span>,</span><br><span class="line">    favourNum  <span class="type">int</span>      <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ”¶è—æ•°&#x27;</span>,</span><br><span class="line">    userId     <span class="type">bigint</span>                             <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºç”¨æˆ· id&#x27;</span>,</span><br><span class="line">    createTime datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    updateTime datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    isDelete   tinyint  <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ˜¯å¦åˆ é™¤&#x27;</span>,</span><br><span class="line">    index idx_userId (userId)</span><br><span class="line">) comment <span class="string">&#x27;å¸–å­&#x27;</span> <span class="keyword">collate</span> <span class="operator">=</span> utf8mb4_unicode_ci;</span><br></pre></td></tr></table></figure><p>ES Mapping:</p><p>idï¼ˆå¯ä»¥ä¸æ”¾åˆ°å­—æ®µè®¾ç½®é‡Œï¼‰</p><p>ES ä¸­ï¼Œå°½é‡å­˜æ”¾éœ€è¦ç”¨æˆ·ç­›é€‰ï¼ˆæœç´¢ï¼‰çš„æ•°æ®</p><ul><li>aliases:åˆ«åï¼ˆä¸ºäº†åç»­æ–¹ä¾¿æ•°æ®è¿ç§»ï¼‰</li></ul><p>â€‹å­—æ®µç±»å‹æ—¶ textï¼Œè¿™ä¸ªå­—æ®µæ˜¯å¯è¢«åˆ†è¯çš„ã€å¯æ¨¡ç³ŠæŸ¥è¯¢çš„ï¼›è€Œå¦‚æœæ˜¯ keywordï¼Œåªèƒ½å®Œå…¨åŒ¹é…ã€ç²¾ç¡®æŸ¥è¯¢ã€‚</p><ul><li><p>analyzer ï¼ˆå­˜å‚¨æ—¶ç”Ÿæ•ˆçš„åˆ†è¯å™¨ï¼‰:ç”¨ ik_max_word ï¼Œæ‹†çš„æ›´ç¢ã€ç´¢å¼•æ›´å¤šï¼Œæ›´æœ‰å¯èƒ½è¢«æœç´¢å‡ºæ¥</p></li><li><p>search_analyzer (æŸ¥è¯¢æ—¶ç”Ÿæ•ˆçš„åˆ†è¯å™¨)ï¼šç”¨ ik_smart ,æ›´åå‘äºç”¨æˆ·æƒ³æœçš„åˆ†è¯</p></li></ul><p>å¦‚æœæƒ³è®© text ç±»å‹çš„åˆ†è¯å­—æ®µä¹Ÿæ”¯æŒç²¾ç¡®æŸ¥è¯¢ï¼Œå¯ä»¥åˆ›å»º keyword ç±»å‹çš„å­å­—æ®µï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;fields&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;keyword&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;keyword&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;ignore_above&quot;</span><span class="punctuation">:</span> <span class="number">256</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å»ºè¡¨ç»“æ„ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">PUT post_v1</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;aliases&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;post&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;analyzer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ik_max_word&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;search_analyzer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ik_smart&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;fields&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;keyword&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;keyword&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;ignore_above&quot;</span><span class="punctuation">:</span> <span class="number">256</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;analyzer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ik_max_word&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;search_analyzer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ik_smart&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;fields&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;keyword&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;keyword&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;ignore_above&quot;</span><span class="punctuation">:</span> <span class="number">256</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;keyword&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;userId&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;keyword&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;createTime&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;date&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;updateTime&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;date&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;isDelete&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;keyword&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="2ã€å¢åˆ æ”¹æŸ¥"><a href="#2ã€å¢åˆ æ”¹æŸ¥" class="headerlink" title="2ã€å¢åˆ æ”¹æŸ¥"></a>2ã€å¢åˆ æ”¹æŸ¥</h3><p>ç¬¬ä¸€ç§æ–¹å¼ï¼šElasticsearchRepository&lt;PostEsDTO, Long&gt;, é»˜è®¤æä¾›äº†ç®€å•çš„å¢åˆ æ”¹æŸ¥ï¼Œå¤šç”¨äºå¯é¢„æœŸçš„ã€ç›¸å¯¹è¯¶é‚£ä¹ˆå¤æ‚çš„æŸ¥è¯¢ã€è‡ªå®šä¹‰æŸ¥è¯¢ï¼Œè¿”å›ç»“æœç›¸å¯¹ç®€å•ç›´æ¥ã€‚</p><p>æ¥å£ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CrudRepository</span>&lt;T, ID&gt; <span class="keyword">extends</span> <span class="title class_">Repository</span>&lt;T, ID&gt; &#123;</span><br><span class="line"></span><br><span class="line">&lt;S <span class="keyword">extends</span> <span class="title class_">T</span>&gt; S <span class="title function_">save</span><span class="params">(S entity)</span>;</span><br><span class="line"></span><br><span class="line">&lt;S <span class="keyword">extends</span> <span class="title class_">T</span>&gt; Iterable&lt;S&gt; <span class="title function_">saveAll</span><span class="params">(Iterable&lt;S&gt; entities)</span>;</span><br><span class="line"></span><br><span class="line">Optional&lt;T&gt; <span class="title function_">findById</span><span class="params">(ID id)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">existsById</span><span class="params">(ID id)</span>;</span><br><span class="line"></span><br><span class="line">Iterable&lt;T&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">Iterable&lt;T&gt; <span class="title function_">findAllById</span><span class="params">(Iterable&lt;ID&gt; ids)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="title function_">count</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(ID id)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(T entity)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">deleteAllById</span><span class="params">(Iterable&lt;? extends ID&gt; ids)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">deleteAll</span><span class="params">(Iterable&lt;? extends T&gt; entities)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">deleteAll</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ES ä¸­ï¼Œ_å¼€å¤´çš„å­—æ®µè¡¨ç¤ºç³»ç»Ÿé»˜è®¤å­—æ®µï¼Œæ¯”å¦‚ _id,å¦‚æœç³»ç»Ÿä¸æŒ‡å®šï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆã€‚ä½†æ˜¯ä¸ä¼šåœ¨ _source å­—æ®µä¸­è¡¥å……id çš„å€¼ï¼Œæ‰€ä»¥å»ºè®®æ‰‹åŠ¨æŒ‡å®šã€‚</p><p>æ”¯æŒæ ¹æ®æ–¹æ³•åè‡ªåŠ¨ç”Ÿæˆæ–¹æ³•ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;PostEsDTO&gt; <span class="title function_">findByTitle</span><span class="params">(String title)</span>;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹å¼ï¼šSpring é»˜è®¤ç»™æˆ‘ä»¬æä¾›çš„æ“ä½œ ES çš„å®¢æˆ·ç«¯å¯¹è±¡ ElasticsearchRestTemplate ï¼Œä¹Ÿæä¾›äº†å¢åˆ æ”¹æŸ¥ï¼Œå®ƒçš„å¢åˆ æ”¹æŸ¥æ›´çµæ´»ï¼Œé€‚ç”¨äºæ›´å¤æ‚çš„æ“ä½œï¼Œè¿”å›ç»“æœæ›´å®Œæ•´ï¼Œä½†éœ€è¦è‡ªå·±è§£æã€‚</p><p><strong>å¯¹äºå¤æ‚çš„æŸ¥è¯¢ï¼Œå»ºè®®ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼</strong></p><p>ä¸‰ä¸ªæ­¥éª¤ï¼š</p><ol><li>å–å‚æ•°</li><li>æŠŠå‚æ•°ç»„åˆä¸º ES æ”¯æŒçš„æœç´¢æ¡ä»¶</li><li>ä»è¿”å›å€¼ä¸­å–ç»“æœ</li></ol><h3 id="3ã€æŸ¥è¯¢-DSL"><a href="#3ã€æŸ¥è¯¢-DSL" class="headerlink" title="3ã€æŸ¥è¯¢ DSL"></a>3ã€æŸ¥è¯¢ DSL</h3><p>å‚è€ƒæ–‡æ¡£ï¼š</p><ul><li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/query-filter-context.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/query-filter-context.html</a></li><li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/query-dsl-bool-query.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/query-dsl-bool-query.html</a></li></ul><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GET post/_search</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;query&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> </span><br><span class="line">    <span class="attr">&quot;bool&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> </span><br><span class="line">      <span class="attr">&quot;must&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;match&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span>   <span class="string">&quot;å¢¨æ«&quot;</span>        <span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;match&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span>   <span class="string">&quot;åšå®¢&quot;</span>        <span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;filter&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> </span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;term&quot;</span><span class="punctuation">:</span>  <span class="punctuation">&#123;</span> <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;published&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;range&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;publish_date&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;gte&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2023-05-02&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>wilcard æ¨¡ç³ŠæŸ¥è¯¢</p><p>regexp æ­£åˆ™è¡¨è¾¾å¼</p><p>æŸ¥è¯¢ç»“æœä¸­ï¼Œscore ä»£ç åŒ¹é…åˆ†æ•°</p><p>å»ºè®®å…ˆæµ‹è¯• DSLï¼Œå†ç¿»è¯‘æˆ Java</p><p>åŠ¨é™åˆ†ç¦»è®¾è®¡ï¼šå…ˆæ¨¡ç³Šç­›é€‰ç«Ÿç„¶æ•°æ®ï¼ŒæŸ¥å‡ºæ•°æ®åï¼Œå†æ ¹æ®æŸ¥åˆ°çš„å†…å®¹ id å»æ•°æ®åº“æŸ¥æ‰¾åˆ° <strong>åŠ¨æ€æ•°æ®</strong></p><h2 id="æ•°æ®åŒæ­¥"><a href="#æ•°æ®åŒæ­¥" class="headerlink" title="æ•°æ®åŒæ­¥"></a>æ•°æ®åŒæ­¥</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœåšæŸ¥è¯¢æœç´¢åŠŸèƒ½ï¼Œä½¿ç”¨ ES æ¥æ¨¡ç³ŠæŸ¥è¯¢ï¼Œä½†æ˜¯æ•°æ®æ˜¯å­˜æ”¾åœ¨æ•°æ®åº“ MySQL é‡Œçš„ï¼Œæ‰€ä»¥è¯´éœ€è¦æŠŠ MySQL çš„æ•°æ®å’Œ ES çš„æ•°æ®è¿›è¡ŒåŒæ­¥ï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼ˆä»¥ MySQLä¸ºä¸»ï¼‰</p><p>MySQL &#x3D;&gt; ES ï¼ˆå•å‘ï¼‰</p><p>é¦–æ¬¡å®‰è£…å®Œ ES ï¼ŒæŠŠ MySQLæ•°æ®å…¨é‡åŒæ­¥åˆ° ES é‡Œï¼Œå†™ä¸€ä¸ªå•è¯è„šæœ¬</p><p>4 ç§æ–¹å¼ï¼Œå…¨é‡åŒæ­¥ï¼ˆé¦–æ¬¡ï¼‰ + å¢é‡åŒæ­¥ï¼ˆæ–°æ•°æ®ï¼‰ï¼š</p><ol><li>å®šæ—¶ä»»åŠ¡ï¼Œæ¯”å¦‚ 1 åˆ†é’Ÿ 1 æ¬¡ï¼Œæ‰¾åˆ° MySQL è¿‡å»å‡ åˆ†é’Ÿå†…ï¼ˆè‡³å°‘å®šæ—¶å‘¨æœŸçš„ 2 å€ï¼‰å‘ç”Ÿæ”¹å˜çš„æ•°æ®ï¼Œç„¶åæ›´æ–°åˆ° ES<br>ä¼˜ç‚¹ï¼šç®€å•æ˜“æ‡‚ã€å ç”¨èµ„æºå°‘ã€ä¸ç”¨å¼•å…¥ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶<br>ç¼ºç‚¹ï¼šæœ‰æ—¶é—´å·®<br>åº”ç”¨åœºæ™¯ï¼šæ•°æ®çŸ­æ—¶é—´å†…ä¸åŒæ­¥å½±å“ä¸å¤§ã€æˆ–è€…æ•°æ®å‡ ä¹ä¸å‘ç”Ÿä¿®æ”¹</li><li>åŒå†™ï¼šå†™æ•°æ®çš„æ—¶å€™ï¼Œå¿…é¡»ä¹Ÿå»å†™ ESï¼›æ›´æ–°åˆ é™¤æ•°æ®åº“åŒç†ã€‚ï¼ˆäº‹åŠ¡ï¼šå»ºè®®å…ˆä¿è¯ MySQL å†™æˆåŠŸï¼Œå¦‚æœ ES å†™å¤±è´¥äº†ï¼Œå¯ä»¥é€šè¿‡å®šæ—¶ä»»åŠ¡ + æ—¥å¿— + å‘Šè­¦è¿›è¡Œæ£€æµ‹å’Œä¿®å¤ï¼ˆè¡¥å¿ï¼‰</li><li>ç”¨ Logstash æ•°æ®åŒæ­¥ç®¡é“ï¼ˆä¸€èˆ¬è¦é…åˆ kafka æ¶ˆæ¯é˜Ÿåˆ— + beats é‡‡é›†å™¨ï¼‰</li><li>Canal ç›‘å¬ MySQL Binlog, å®æ—¶åŒæ­¥</li></ol><h3 id="Logstash"><a href="#Logstash" class="headerlink" title="Logstash"></a>Logstash</h3><p><strong>ä¼ è¾“</strong>å’Œ<strong>å¤„ç†</strong>æ•°æ®çš„ç®¡é“</p><p><a href="https://www.elastic.co/guide/en/logstash/7.17/getting-started-with-logstash.html">https://www.elastic.co/guide/en/logstash/7.17/getting-started-with-logstash.html</a></p><p>å¥½å¤„ï¼šç”¨èµ·æ¥æ–¹ä¾¿ï¼Œæ’ä»¶å¤š</p><p>ç¼ºç‚¹ï¼šæˆæœ¬æ›´å¤§ã€ä¸€èˆ¬è¦é…åˆå…¶ä»–ç»„ä»¶ä½¿ç”¨ï¼ˆæ¯”å¦‚ kafka)</p><p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20230503223832634.png" alt="image-20230503223832634"></p><p>äº‹ä»¶ DEMOï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> logstash-7.17.9</span><br><span class="line">.\bin\logstash.bat -e <span class="string">&quot;input &#123; stdin &#123;&#125; &#125; output &#123; stdout&#123;&#125; &#125;&quot;</span> </span><br></pre></td></tr></table></figure><p>å¿«é€Ÿå¼€å§‹æ–‡æ¡£ï¼š<a href="https://www.elastic.co/guide/en/logstash/7.17/running-logstash-windows.html">https://www.elastic.co/guide/en/logstash/7.17/running-logstash-windows.html</a></p><p>ç›‘å¬ udp å¹¶è¾“å‡ºï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">input&#123;</span><br><span class="line">    udp&#123;</span><br><span class="line">        <span class="attribute">port</span> =&gt; <span class="number">514</span></span><br><span class="line">        type =&gt; <span class="string">&quot;syslog&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output&#123;</span><br><span class="line">    stdout&#123;</span><br><span class="line">        <span class="attribute">codec</span> =&gt; rubydebug</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦æŠŠ MySQL åŒæ­¥ç»™ Elasticsearch</p><p>é—®é¢˜1ï¼šæ‰¾ä¸åˆ° mysql åŒ…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Error:unable to load mysql-connector-java-<span class="number">5.1</span><span class="number">.36</span>-bin.jar from :jdbc_driver_library,file not <span class="title function_">readable</span></span><br><span class="line"><span class="params">(please check user and group permissions <span class="keyword">for</span> the path)</span></span><br><span class="line">Exception:LogStash:PluginLoadingError</span><br></pre></td></tr></table></figure><p>è§£å†³ï¼šä¿®æ”¹ Logstash ä»»åŠ¡é…ç½®ä¸­çš„ jdbc_driver_library ä¸ºé©±åŠ¨åŒ…çš„ç»å¯¹è·¯å¾„ï¼ˆé©±åŠ¨åŒ…å¯ä»¥ä» maven ä»“åº“ä¸­æ‹·è´ï¼‰</p><p>å¢é‡é…ç½®ï¼šæ˜¯ä¸æ˜¯å¯ä»¥åªæŸ¥æœ€æ–°æ›´æ–°çš„æ•°æ®ï¼Ÿå¯ä»¥è®°å½•ä¸Šæ¬¡æ›´æ–°çš„æ—¶é—´ï¼ŒåªæŸ¥å‡ºæ¥ &gt; è¯¥æ›´æ–°æ—¶é—´çš„æ•°æ®</p><p>å°çŸ¥è¯†ï¼šé¢„ç¼–è¯‘ SQL çš„ä¼˜ç‚¹</p><ol><li>çµæ´»</li><li>æ¨¡æ¿å¥½æ‡‚</li><li>å¿«ï¼ˆæœ‰ç¼“å­˜ï¼‰</li><li>éƒ¨åˆ†ä»¿æ³¨å…¥</li></ol><p>sql_last_value æ˜¯ä¸Šæ¬¡æŸ¥åˆ°é¢æ•°æ®çš„æœ€åä¸€è¡Œçš„æŒ‡å®šçš„å­—æ®µï¼Œå¦‚æœè¦å…¨é‡æ›´æ–°ï¼Œåªè¦åˆ é™¤æ‰</p><p>D:\javaTools\ElasticStack\logstash-7.17.9\data\plugins\inputs\jdbc\logstash_jdbc_last_run æ–‡ä»¶å³å¯ï¼ˆè¿™ä¸ªæ–‡ä»¶å­˜å‚¨é¢ä¸Šæ¬¡åŒæ­¥åˆ°çš„æ•°æ®ï¼‰</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">input</span> &#123;</span><br><span class="line">  <span class="section">jdbc</span> &#123;</span><br><span class="line">    <span class="attribute">jdbc_driver_library</span> =&gt; <span class="string">&quot;D:\javaTools\ElasticStack\logstash-7.17.9\config\mysql-connector-java-8.0.29.jar&quot;</span></span><br><span class="line">    jdbc_driver_class =&gt; <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span></span><br><span class="line">    jdbc_connection_string =&gt; <span class="string">&quot;jdbc:mysql://localhost:3306/my_db&quot;</span></span><br><span class="line">    jdbc_user =&gt; <span class="string">&quot;root&quot;</span></span><br><span class="line">jdbc_password =&gt; <span class="string">&quot;root&quot;</span></span><br><span class="line">    statement =&gt; <span class="string">&quot;SELECT * from post where updateTime &gt; :sql_last_value&quot;</span></span><br><span class="line">use_column_value =&gt; <span class="literal">true</span></span><br><span class="line">    tracking_column_type =&gt; <span class="string">&quot;timestamp&quot;</span></span><br><span class="line">    tracking_column =&gt; <span class="string">&quot;updatetime&quot;</span></span><br><span class="line">parameters =&gt; &#123; &quot;favorite_artist&quot; =&gt; &quot;Beethoven&quot; &#125;</span><br><span class="line">    <span class="attribute">schedule</span> =&gt; <span class="string">&quot;*/5 * * * *&quot;</span></span><br><span class="line">jdbc_default_timezone =&gt; <span class="string">&quot;Asia/Shanghai&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output &#123;</span><br><span class="line">  <span class="section">stdout</span> &#123; <span class="attribute">codec</span> =&gt; rubydebug &#125;</span><br><span class="line">    elasticsearch &#123;</span><br><span class="line"><span class="attribute">hosts</span> =&gt; <span class="string">&quot;http://localhost:9200&quot;</span></span><br><span class="line">index =&gt; <span class="string">&quot;post_v1&quot;</span></span><br><span class="line">document_id =&gt; <span class="string">&quot;%&#123;id&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„æŸ¥è¯¢è¯­å¥ä¸­è¦æŒ‰ updateTime æ’åºï¼Œä¿è¯æœ€åä¸€æ¡æ˜¯æœ€å¤§çš„ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">input</span> &#123;</span><br><span class="line">  <span class="section">jdbc</span> &#123;</span><br><span class="line">    <span class="attribute">jdbc_driver_library</span> =&gt; <span class="string">&quot;D:\javaTools\ElasticStack\logstash-7.17.9\config\mysql-connector-java-8.0.29.jar&quot;</span></span><br><span class="line">    jdbc_driver_class =&gt; <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span></span><br><span class="line">    jdbc_connection_string =&gt; <span class="string">&quot;jdbc:mysql://localhost:3306/my_db&quot;</span></span><br><span class="line">    jdbc_user =&gt; <span class="string">&quot;root&quot;</span></span><br><span class="line">jdbc_password =&gt; <span class="string">&quot;root&quot;</span></span><br><span class="line">    statement =&gt; <span class="string">&quot;SELECT * from post where updateTime &gt; :sql_last_value and updateTime &lt; now() order by updateTime desc&quot;</span></span><br><span class="line">use_column_value =&gt; <span class="literal">true</span></span><br><span class="line">    tracking_column_type =&gt; <span class="string">&quot;timestamp&quot;</span></span><br><span class="line">    tracking_column =&gt; <span class="string">&quot;updatetime&quot;</span></span><br><span class="line">parameters =&gt; &#123; &quot;favorite_artist&quot; =&gt; &quot;Beethoven&quot; &#125;</span><br><span class="line">    <span class="attribute">schedule</span> =&gt; <span class="string">&quot;*/5 * * * *&quot;</span></span><br><span class="line">jdbc_default_timezone =&gt; <span class="string">&quot;Asia/Shanghai&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output &#123;</span><br><span class="line">  <span class="section">stdout</span> &#123; <span class="attribute">codec</span> =&gt; rubydebug &#125;</span><br><span class="line">    elasticsearch &#123;</span><br><span class="line"><span class="attribute">hosts</span> =&gt; <span class="string">&quot;http://localhost:9200&quot;</span></span><br><span class="line">index =&gt; <span class="string">&quot;post_v1&quot;</span></span><br><span class="line">document_id =&gt; <span class="string">&quot;%&#123;id&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>å­—æ®µå…¨å˜æˆå°å†™äº†</li><li>å¤šäº†ä¸€äº›æˆ‘ä»¬ä¸æƒ³åŒæ­¥çš„å­—æ®µ</li></ol><p>è§£å†³ï¼š</p><p>ç¼–å†™è¿‡æ»¤</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">input</span> &#123;</span><br><span class="line">  <span class="section">jdbc</span> &#123;</span><br><span class="line">    <span class="attribute">jdbc_driver_library</span> =&gt; <span class="string">&quot;D:\javaTools\ElasticStack\logstash-7.17.9\config\mysql-connector-java-8.0.29.jar&quot;</span></span><br><span class="line">    jdbc_driver_class =&gt; <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span></span><br><span class="line">    jdbc_connection_string =&gt; <span class="string">&quot;jdbc:mysql://localhost:3306/my_db&quot;</span></span><br><span class="line">    jdbc_user =&gt; <span class="string">&quot;root&quot;</span></span><br><span class="line">jdbc_password =&gt; <span class="string">&quot;root&quot;</span></span><br><span class="line">    statement =&gt; <span class="string">&quot;SELECT * from post where updateTime &gt; :sql_last_value and updateTime &lt; now() order by updateTime desc&quot;</span></span><br><span class="line">use_column_value =&gt; <span class="literal">true</span></span><br><span class="line">    tracking_column_type =&gt; <span class="string">&quot;timestamp&quot;</span></span><br><span class="line">    tracking_column =&gt; <span class="string">&quot;updatetime&quot;</span></span><br><span class="line">parameters =&gt; &#123; &quot;favorite_artist&quot; =&gt; &quot;Beethoven&quot; &#125;</span><br><span class="line">    <span class="attribute">schedule</span> =&gt; <span class="string">&quot;*/5 * * * *&quot;</span></span><br><span class="line">jdbc_default_timezone =&gt; <span class="string">&quot;Asia/Shanghai&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">filter &#123;</span><br><span class="line">    <span class="section">mutate</span> &#123;</span><br><span class="line">        <span class="attribute">rename</span> =&gt; &#123;</span><br><span class="line">&quot;updatetime&quot; =&gt; &quot;updateTime&quot;</span><br><span class="line">&quot;userid&quot; =&gt; &quot;userId&quot;</span><br><span class="line">&quot;createtime&quot; =&gt; &quot;createTime&quot;</span><br><span class="line">&quot;isdelete&quot; =&gt; &quot;isDelete&quot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="attribute">remove_field</span> =&gt; [<span class="string">&quot;thumbnum&quot;</span>, <span class="string">&quot;favournum&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">output &#123;</span><br><span class="line">  <span class="section">stdout</span> &#123; <span class="attribute">codec</span> =&gt; rubydebug &#125;</span><br><span class="line">    elasticsearch &#123;</span><br><span class="line"><span class="attribute">hosts</span> =&gt; <span class="string">&quot;http://localhost:9200&quot;</span></span><br><span class="line">index =&gt; <span class="string">&quot;post_v1&quot;</span></span><br><span class="line">document_id =&gt; <span class="string">&quot;%&#123;id&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è®¢é˜…æ•°æ®åº“æµæ°´çš„åŒæ­¥æ–¹å¼-Canal"><a href="#è®¢é˜…æ•°æ®åº“æµæ°´çš„åŒæ­¥æ–¹å¼-Canal" class="headerlink" title="è®¢é˜…æ•°æ®åº“æµæ°´çš„åŒæ­¥æ–¹å¼ Canal"></a>è®¢é˜…æ•°æ®åº“æµæ°´çš„åŒæ­¥æ–¹å¼ Canal</h3><p><a href="https://github.com/alibaba/canal/">https://github.com/alibaba/canal/</a></p><p>ä¼˜ç‚¹ï¼šå®æ—¶åŒæ­¥ï¼Œå®æ—¶æ€§éå¸¸å¼º</p><p>åŸç†ï¼šæ•°æ®åº“æ¯æ¬¡ä¿®æ”¹æ—¶ï¼Œä¼šä¿®æ”¹ binlog æ–‡ä»¶ï¼Œåªè¦ç›‘å¬è¯¥æ–‡ä»¶çš„ä¿®æ”¹ï¼Œå°±èƒ½ç¬¬ä¸€æ—¶é—´é¥¿åˆ°æ¶ˆæ¯å¹¶å¤„ç†</p><p>canalï¼šå¸®ä½ ç›‘å¬ binlogï¼Œå¹¶è§£æ binlog ä¸ºå¯ä»¥ç†è§£çš„å†…å®¹</p><p>å®ƒä¼ªè£…æˆäº† MySQL çš„ä»èŠ‚ç‚¹ï¼Œè·å–ä¸»èŠ‚ç‚¹ç»™çš„ binlog ,å¦‚å›¾ï¼š</p><p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20230503230056433.png" alt="image-20230503230056433"></p><p>å¿«é€Ÿå¼€å§‹ï¼š<a href="https://github.com/alibaba/canal/wiki/QuickStart">https://github.com/alibaba/canal/wiki/QuickStart</a></p><p>å¯¹äºè‡ªå»º MySQL , éœ€è¦å…ˆå¼€å¯ Binlog å†™å…¥åŠŸèƒ½ï¼Œé…ç½® binlog-format ä¸º ROW æ¨¡å¼ï¼Œmy.cnf ä¸­é…ç½®å¦‚ä¸‹</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">[mysqld]</span></span><br><span class="line"><span class="attr">log-bin</span>=<span class="string">mysql-bin # å¼€å¯ binlog</span></span><br><span class="line"><span class="attr">binlog-format</span>=<span class="string">ROW # é€‰æ‹© ROW æ¨¡å¼</span></span><br><span class="line"><span class="attr">server_id</span>=<span class="string">1 # é…ç½® MySQL replaction éœ€è¦å®šä¹‰ï¼Œä¸è¦å’Œ canal çš„ slaveId é‡å¤</span></span><br></pre></td></tr></table></figure><p>å¦‚æœ java æ‰¾ä¸åˆ°ï¼Œä¿®æ”¹ startup.bat è„šæœ¬ä¸ºä½ è‡ªå·±çš„ java homeï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> JAVA_HOME=C:\Users\59278\.jdks\corretto-1.8.0_302</span><br><span class="line"><span class="built_in">echo</span> %JAVA_HOME%</span><br><span class="line"><span class="built_in">set</span> PATH=%JAVA_HOME%\bin;%PATH%</span><br><span class="line"><span class="built_in">echo</span> %PATH%</span><br></pre></td></tr></table></figure><p>é—®é¢˜ï¼šmysql æ— æ³•é“¾æ¥ï¼ŒCaused by: java.io.IOException: caching_sha2_password Auth failed</p><p>è§£å†³æ–¹æ¡ˆï¼š<a href="https://github.com/alibaba/canal/issues/3902">https://github.com/alibaba/canal/issues/3902</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER &#x27;canal&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;canal&#x27;;</span><br><span class="line"></span><br><span class="line">ALTER USER &#x27;canal&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;canal&#x27; PASSWORD EXPIRE NEVER;</span><br><span class="line"></span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure><h2 id="é…ç½®-kibama-å¯è§†åŒ–çœ‹æ¿"><a href="#é…ç½®-kibama-å¯è§†åŒ–çœ‹æ¿" class="headerlink" title="é…ç½® kibama å¯è§†åŒ–çœ‹æ¿"></a>é…ç½® kibama å¯è§†åŒ–çœ‹æ¿</h2><ol><li>åˆ›å»ºç´¢å¼•</li><li>å¯¼å…¥æ•°æ®</li><li>åˆ›å»ºç´¢å¼•æ¨¡å¼</li><li>é€‰æ‹©å›¾è¡¨ã€æ‰˜æ‹‰æ‹½</li><li>ä¿å­˜</li></ol><h2 id="å‹åŠ›æµ‹è¯•"><a href="#å‹åŠ›æµ‹è¯•" class="headerlink" title="å‹åŠ›æµ‹è¯•"></a>å‹åŠ›æµ‹è¯•</h2><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://jmeter.apache.org/">https://jmeter.apache.org/</a></p><p>æ‰¾åˆ° jar åŒ…ï¼šD:\javaTools\apache-jmeter-5.5\bin\ApacheJMeter.jar å¯åŠ¨</p><p>é…ç½®çº¿ç¨‹ç»„ &#x3D;&gt; è¯·æ±‚å¤´ &#x3D;&gt; é»˜è®¤è¯·æ±‚ &#x3D;&gt; å•ä¸ªè¯·æ±‚å¤´ &#x3D;&gt; å“åº”æ–­è¨€ &#x3D;&gt; èšåˆæŠ¥å‘Š &#x2F; ç»“æœæ ‘</p><p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20230503230921181.png" alt="image-20230503230921181"></p><p>99% åˆ†ä½ï¼š99% çš„ç”¨æˆ·éƒ½åœ¨è¿™ä¸ªå“åº”æ—¶é—´å†…</p><p>ååé‡ï¼šæ¯ç§’å¤„ç†çš„è¯·æ±‚æ•° qps</p><h3 id="æ›´å¤šçš„å­¦ä¹ "><a href="#æ›´å¤šçš„å­¦ä¹ " class="headerlink" title="æ›´å¤šçš„å­¦ä¹ "></a>æ›´å¤šçš„å­¦ä¹ </h3><p>æ’ä»¶ï¼š<a href="https://jmeter-plugins.org/install/Install/">https://jmeter-plugins.org/install/Install/</a></p><p>ä¸‹è½½åæ–‡ä»¶ä¸º plugins-manager.jar æ ¼å¼ï¼Œå°†å…¶æ”¾å…¥ jmeter å®‰è£…ç›®å½•ä¸‹çš„ lib&#x2F;ext ç›®å½•ï¼Œç„¶å jmeter,å³å¯ã€‚</p><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/weixin_45189665/article/details/125278218">https://blog.csdn.net/weixin_45189665/article/details/125278218</a></p><h2 id="æœç´¢å»ºè®®"><a href="#æœç´¢å»ºè®®" class="headerlink" title="æœç´¢å»ºè®®"></a>æœç´¢å»ºè®®</h2><p>å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/search-suggesters.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/search-suggesters.html</a></p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">GET post/_search</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;query&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;match&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¢¨æ«æ˜¯ç‹—&quot;</span> <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;highlight&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;fields&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;pre_tags&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;h1&gt;&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;post_tags&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;h1&gt;&quot;</span><span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;suggest&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;my-suggestion&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;text&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;å¢¨æ«æ˜¯ç‹—&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;term&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;field&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;content&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="æœç´¢é«˜äº®"><a href="#æœç´¢é«˜äº®" class="headerlink" title="æœç´¢é«˜äº®"></a>æœç´¢é«˜äº®</h2><p>å‚è€ƒå®˜æ–¹ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/highlighting.html">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/highlighting.html</a></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GET post/_search</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;query&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;match&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;é±¼çš®æ˜¯ç‹—&quot;</span> <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;highlight&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;fields&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;pre_tags&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;h1&gt;&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;post_tags&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;h1&gt;&quot;</span><span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="å‰ç«¯é˜²æŠ–èŠ‚æµ"><a href="#å‰ç«¯é˜²æŠ–èŠ‚æµ" class="headerlink" title="å‰ç«¯é˜²æŠ–èŠ‚æµ"></a>å‰ç«¯é˜²æŠ–èŠ‚æµ</h2><p>é—®é¢˜ï¼šç”¨æˆ·é¢‘ç¹æœç´¢ã€é¢‘ç¹ç‚¹å‡»æ¬§ç´¢æŒ‰é’®æ€ä¹ˆåŠï¼Ÿ</p><p>è§£å†³ï¼šä½¿ç”¨ lodash å·¥å…·åº“å®ç°é˜²æŠ–å’ŒèŠ‚æµ</p><p>èŠ‚æµï¼šæ¯æ®µæ—¶é—´æœ€å¤šæ‰§è¡Œ x æ¬¡ï¼ˆæ¯”å¦‚æœåŠ¡å™¨é™æµï¼‰<a href="https://www.lodashjs.com/docs/lodash.throttle">https://www.lodashjs.com/docs/lodash.throttle</a></p><p>é˜²æŠ–ï¼šç­‰å¾…ä¸€æ®µæ—¶é—´å†…æ²¡æœ‰å…¶ä»–æ“ä½œäº†ï¼Œæ‰æ‰§è¡Œæ“ä½œï¼ˆæ¯”å¦‚è¾“å…¥æœç´¢ï¼‰</p><p><a href="https://www.lodashjs.com/docs/lodash.debounce">https://www.lodashjs.com/docs/lodash.debounce</a></p><h2 id="æ¥å£ç¨³å®šæ€§ä¼˜åŒ–"><a href="#æ¥å£ç¨³å®šæ€§ä¼˜åŒ–" class="headerlink" title="æ¥å£ç¨³å®šæ€§ä¼˜åŒ–"></a>æ¥å£ç¨³å®šæ€§ä¼˜åŒ–</h2><p>é—®é¢˜ï¼šè°ƒç”¨ç¬¬ä¸‰æ–¹æ¥å£ä¸ç¨³å®šæ€ä¹ˆåŠï¼Ÿï¼ˆæ¯”å¦‚ bing æ¥å£ï¼‰</p><p>ä½¿ç”¨ guava-retrying åº“å®ç°è‡ªåŠ¨é‡è¯•ï¼š<a href="https://github.com/rholder/guava-retrying">https://github.com/rholder/guava-retrying</a></p><p>å‚è€ƒå­¦ä¹ æ–‡ç« ï¼š<a href="https://cloud.tencent.com/developer/article/1752086">https://cloud.tencent.com/developer/article/1752086</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Elastic-Stack&quot;&gt;&lt;a href=&quot;#Elastic-Stack&quot; class=&quot;headerlink&quot; title=&quot;Elastic Stack&quot;&gt;&lt;/a&gt;Elastic Stack&lt;/h1&gt;&lt;p&gt;å®˜ç½‘åœ°å€ï¼š&lt;a href=&quot;https://www.</summary>
      
    
    
    
    <category term="èšåˆæœç´¢å¹³å°" scheme="http://example.com/categories/%E8%81%9A%E5%90%88%E6%90%9C%E7%B4%A2%E5%B9%B3%E5%8F%B0/"/>
    
    
    <category term="æ˜Ÿçƒé¡¹ç›®" scheme="http://example.com/tags/%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>è¯»ã€Šéœä¹±æ—¶æœŸçš„çˆ±æƒ…ã€‹</title>
    <link href="http://example.com/2023/04/12/%E8%AF%BB%E3%80%8A%E9%9C%8D%E4%B9%B1%E6%97%B6%E6%9C%9F%E7%9A%84%E7%88%B1%E6%83%85%E3%80%8B/"/>
    <id>http://example.com/2023/04/12/%E8%AF%BB%E3%80%8A%E9%9C%8D%E4%B9%B1%E6%97%B6%E6%9C%9F%E7%9A%84%E7%88%B1%E6%83%85%E3%80%8B/</id>
    <published>2023-04-11T16:44:24.610Z</published>
    <updated>2023-04-11T16:43:39.689Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è¯»é©¬å°”å…‹æ–¯çš„ã€Šéœä¹±æ—¶æœŸçš„çˆ±æƒ…ã€‹"><a href="#è¯»é©¬å°”å…‹æ–¯çš„ã€Šéœä¹±æ—¶æœŸçš„çˆ±æƒ…ã€‹" class="headerlink" title="è¯»é©¬å°”å…‹æ–¯çš„ã€Šéœä¹±æ—¶æœŸçš„çˆ±æƒ…ã€‹"></a>è¯»é©¬å°”å…‹æ–¯çš„ã€Šéœä¹±æ—¶æœŸçš„çˆ±æƒ…ã€‹</h1><p>è¿™åœºè·¨è¶ŠåŠä¸ªä¸–çºªçš„æ‚²æ¬¢ç¦»åˆï¼Œå°‘å¹´æ—¶çš„æ‚¸åŠ¨ï¼Œæš®å¹´æ—¶çš„ç›¸äº’ä¾é ã€‚ä¸­é—´å†ç»åƒè¾›ä¸‡è‹¦ï¼Œæœ€åä¸€èµ·æ—…è¡Œï¼Œäº«å—äº†ä¸€æ®µçŸ­æš‚çš„ç¾å¥½æ—¶å…‰ã€‚</p><p>æƒŠå¹äºé©¬å°”å…‹æ–¯å™è¿°è¯­è¨€çš„é­…åŠ›ï¼Œé‚£æ— å°½çš„èµç¾å’Œæ— æƒ…çš„è¯…å’’ï¼Œä¸€ä¸ªä¸ªå°æ•…äº‹æ¥ä¸°å¯Œæƒ…èŠ‚ã€‚</p><p>å¼—æ´›ä¼¦è’‚è¯ºÂ·é˜¿é‡Œè¨å¯ä»¥è¯´æ˜¯ä¸€ä¸ªä¸€ç©·äºŒç™½çš„å¹´è½»äººï¼Œè€Œæ´›ä¼¦ç´¢Â·è¾¾è¨æƒ³è®©ä»–å¥³å„¿å°†æ¥èƒ½å«ç»™åé—¨è´µæ—ï¼Œæ‰€ä»¥æ´›ä¼¦ç´¢Â·è¾¾è¨éœ€è¦æ‹†æ•£ä»–ä»¬ï¼Œä¼å›¾å‘ä»–å¥³å„¿çš„èˆ…èˆ…å¯»æ±‚å¸®åŠ©æ—¶ï¼Œä¸æ›¾æƒ³ä»–å¹´è½»çš„æ—¶å€™ä¸ºäº†å¨¶åˆ°ç°åœ¨çš„å¦»å­ï¼Œä¹Ÿæ›¾æ˜¯å¼—æ´›ä¼¦è’‚è¯ºÂ·é˜¿é‡Œè¨ç°åœ¨çš„å¤„å¢ƒã€‚é©¬å°”å…‹æ–¯ç”¨æå…·è®½åˆºçš„æ‰‹æ³•ï¼Œæè¿°äº†æ´›ä¼¦ç´¢Â·è¾¾è¨å†…å¿ƒçš„è´ªå©ªå’Œè‡ªç§ã€‚</p><p>åœ¨å™è¿°å…»é¸½å¥³å’Œå¼—æ´›ä¼¦è’‚è¯ºÂ·é˜¿é‡Œè¨çš„æ•…äº‹ä¸­ï¼Œæ­£å½“æˆ‘çœ‹å¾—å…¥è¿·ï¼Œä»¥ä¸ºæ•…äº‹æƒ…èŠ‚è¾¾åˆ°é«˜æ½®ä¹‹æ—¶ï¼Œå…»é¸½å¥³ç›´æ¥è¢«ä¸ˆå¤«æ®‹å¿æ€å®³çš„æ—¶å€™ï¼Œæ•…äº‹æƒ…èŠ‚æˆ›ç„¶è€Œæ­¢ï¼Œæœ€ååªå‰©ä¸‹åŸå¢“å‰é‚£ç››å¼€çš„ç«ç‘°èŠ±ï¼Œå¼—æ´›ä¼¦è’‚è¯ºÂ·é˜¿é‡Œè¨æ¥çœ‹ä»–çš„æ¯äº²æ—¶ä¼šä¸€èµ·æ¸…ç†ä¸€ä¸‹ï¼Œä»¥å‡å°‘ä»–å†…å¿ƒçš„æ„§ç–šï¼Œå¯æœ€åå¢“å›­é‡Œçš„æ‰€æœ‰ç«ç‘°èŠ±éƒ½è¢«æ”¿åºœæ¸…é™¤æ‰äº†ï¼Œå¹¶æŠŠå¢“å›­æ”¹æˆäº†å…¬å¢“ã€‚</p><p>ä½œè€…é©¬å°”å…‹æ–¯æå†™æœ€åçš„ç»“å±€ä¸­ï¼Œä»¥å¼—æ´›ä¼¦è’‚è¯ºÂ·é˜¿é‡Œè¨å›ç­”èˆ¹é•¿çš„è¯â€œä¸€ç”Ÿä¸€ä¸–â€ä½œä¸ºç»“å°¾ï¼Œç»™äººæ— é™çš„éæƒ³ï¼Œèˆ¹æ—¢æ²¡æœ‰åœæ³Šï¼Œä¹Ÿæ²¡æœ‰ç»§ç»­å‰è¿›ï¼Œä¹Ÿæš—ç¤ºç€å¼—æ´›ä¼¦è’‚è¯ºÂ·é˜¿é‡Œè¨å’Œè´¹å°”æ˜å¨œÂ·è¾¾è¨çš„å…³ç³»ï¼Œç•™ä¸€æ®µç©ºç™½ç»™è¯»è€…ç»†ç»†å“å‘³ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è¯»é©¬å°”å…‹æ–¯çš„ã€Šéœä¹±æ—¶æœŸçš„çˆ±æƒ…ã€‹&quot;&gt;&lt;a href=&quot;#è¯»é©¬å°”å…‹æ–¯çš„ã€Šéœä¹±æ—¶æœŸçš„çˆ±æƒ…ã€‹&quot; class=&quot;headerlink&quot; title=&quot;è¯»é©¬å°”å…‹æ–¯çš„ã€Šéœä¹±æ—¶æœŸçš„çˆ±æƒ…ã€‹&quot;&gt;&lt;/a&gt;è¯»é©¬å°”å…‹æ–¯çš„ã€Šéœä¹±æ—¶æœŸçš„çˆ±æƒ…ã€‹&lt;/h1&gt;&lt;p&gt;è¿™åœºè·¨è¶ŠåŠä¸ªä¸–çºªçš„æ‚²æ¬¢ç¦»åˆï¼Œå°‘å¹´æ—¶çš„</summary>
      
    
    
    
    <category term="å¢¨æ«çš„è¯»ä¹¦æ„Ÿæƒ³" scheme="http://example.com/categories/%E5%A2%A8%E6%9E%AB%E7%9A%84%E8%AF%BB%E4%B9%A6%E6%84%9F%E6%83%B3/"/>
    
    
    <category term="è¯»ä¹¦æ„Ÿæƒ³" scheme="http://example.com/tags/%E8%AF%BB%E4%B9%A6%E6%84%9F%E6%83%B3/"/>
    
  </entry>
  
  <entry>
    <title>RabbitMQ</title>
    <link href="http://example.com/2023/02/09/%E5%A2%A8%E6%9E%AB%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/"/>
    <id>http://example.com/2023/02/09/%E5%A2%A8%E6%9E%AB%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/</id>
    <published>2023-02-09T12:43:10.910Z</published>
    <updated>2023-02-09T12:42:47.778Z</updated>
    
    <content type="html"><![CDATA[<h1 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h1><h2 id="1-MQçš„ç›¸å…³æ¦‚å¿µ"><a href="#1-MQçš„ç›¸å…³æ¦‚å¿µ" class="headerlink" title="1.MQçš„ç›¸å…³æ¦‚å¿µ"></a>1.MQçš„ç›¸å…³æ¦‚å¿µ</h2><h3 id="1-1ä»€ä¹ˆæ˜¯-MQ"><a href="#1-1ä»€ä¹ˆæ˜¯-MQ" class="headerlink" title="1.1ä»€ä¹ˆæ˜¯ MQ"></a>1.1ä»€ä¹ˆæ˜¯ MQ</h3><p>â€‹MQ(message queue)ï¼Œä»å­—é¢æ„æ€ä¸Šçœ‹ï¼Œæœ¬è´¨æ˜¯ä¸ªé˜Ÿåˆ—ï¼ŒFIFO å…ˆå…¥å…ˆå‡ºï¼Œåªä¸è¿‡é˜Ÿåˆ—ä¸­å­˜æ”¾çš„å†…å®¹æ˜¯ message è€Œå·²ï¼Œè¿˜æ˜¯ä¸€ç§è·¨è¿›ç¨‹çš„é€šä¿¡æœºåˆ¶ï¼Œç”¨äºä¸Šä¸‹æ¸¸ä¼ é€’æ¶ˆæ¯ã€‚åœ¨äº’è”ç½‘æ¶æ„ä¸­ï¼ŒMQ æ˜¯ä¸€ç§éå¸¸å¸¸ è§çš„ä¸Šä¸‹æ¸¸â€œé€»è¾‘è§£è€¦+ç‰©ç†è§£è€¦â€çš„æ¶ˆæ¯é€šä¿¡æœåŠ¡ã€‚ä½¿ç”¨äº† MQ ä¹‹åï¼Œæ¶ˆæ¯å‘é€ä¸Šæ¸¸åªéœ€è¦ä¾èµ– MQï¼Œä¸ ç”¨ä¾èµ–å…¶ä»–æœåŠ¡ã€‚</p><h3 id="1-2ä¸ºä»€ä¹ˆè¦ç”¨-MQ"><a href="#1-2ä¸ºä»€ä¹ˆè¦ç”¨-MQ" class="headerlink" title="1.2ä¸ºä»€ä¹ˆè¦ç”¨ MQ"></a>1.2ä¸ºä»€ä¹ˆè¦ç”¨ MQ</h3><ol><li><p>æµé‡æ¶ˆå³° ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœè®¢å•ç³»ç»Ÿæœ€å¤šèƒ½å¤„ç†ä¸€ä¸‡æ¬¡è®¢å•ï¼Œè¿™ä¸ªå¤„ç†èƒ½åŠ›åº”ä»˜æ­£å¸¸æ—¶æ®µçš„ä¸‹å•æ—¶ç»°ç»°æœ‰ä½™ï¼Œæ­£ å¸¸æ—¶æ®µæˆ‘ä»¬ä¸‹å•ä¸€ç§’åå°±èƒ½è¿”å›ç»“æœã€‚ä½†æ˜¯åœ¨é«˜å³°æœŸï¼Œå¦‚æœæœ‰ä¸¤ä¸‡æ¬¡ä¸‹å•æ“ä½œç³»ç»Ÿæ˜¯å¤„ç†ä¸äº†çš„ï¼Œåªèƒ½é™ åˆ¶è®¢å•è¶…è¿‡ä¸€ä¸‡åä¸å…è®¸ç”¨æˆ·ä¸‹å•ã€‚ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—åšç¼“å†²ï¼Œæˆ‘ä»¬å¯ä»¥å–æ¶ˆè¿™ä¸ªé™åˆ¶ï¼ŒæŠŠä¸€ç§’å†…ä¸‹çš„è®¢å•åˆ† æ•£æˆä¸€æ®µæ—¶é—´æ¥å¤„ç†ï¼Œè¿™æ—¶æœ‰äº›ç”¨æˆ·å¯èƒ½åœ¨ä¸‹å•åå‡ ç§’åæ‰èƒ½æ”¶åˆ°ä¸‹å•æˆåŠŸçš„æ“ä½œï¼Œä½†æ˜¯æ¯”ä¸èƒ½ä¸‹å•çš„ä½“ éªŒè¦å¥½ã€‚</p></li><li><p>åº”ç”¨è§£è€¦ ä»¥ç”µå•†åº”ç”¨ä¸ºä¾‹ï¼Œåº”ç”¨ä¸­æœ‰è®¢å•ç³»ç»Ÿã€åº“å­˜ç³»ç»Ÿã€ç‰©æµç³»ç»Ÿã€æ”¯ä»˜ç³»ç»Ÿã€‚ç”¨æˆ·åˆ›å»ºè®¢å•åï¼Œå¦‚æœè€¦åˆ è°ƒç”¨åº“å­˜ç³»ç»Ÿã€ç‰©æµç³»ç»Ÿã€æ”¯ä»˜ç³»ç»Ÿï¼Œä»»ä½•ä¸€ä¸ªå­ç³»ç»Ÿå‡ºäº†æ•…éšœï¼Œéƒ½ä¼šé€ æˆä¸‹å•æ“ä½œå¼‚å¸¸ã€‚å½“è½¬å˜æˆåŸºäº æ¶ˆæ¯é˜Ÿåˆ—çš„æ–¹å¼åï¼Œç³»ç»Ÿé—´è°ƒç”¨çš„é—®é¢˜ä¼šå‡å°‘å¾ˆå¤šï¼Œæ¯”å¦‚ç‰©æµç³»ç»Ÿå› ä¸ºå‘ç”Ÿæ•…éšœï¼Œéœ€è¦å‡ åˆ†é’Ÿæ¥ä¿®å¤ã€‚åœ¨ è¿™å‡ åˆ†é’Ÿçš„æ—¶é—´é‡Œï¼Œç‰©æµç³»ç»Ÿè¦å¤„ç†çš„å†…å­˜è¢«ç¼“å­˜åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç”¨æˆ·çš„ä¸‹å•æ“ä½œå¯ä»¥æ­£å¸¸å®Œæˆã€‚å½“ç‰©æµ ç³»ç»Ÿæ¢å¤åï¼Œç»§ç»­å¤„ç†è®¢å•ä¿¡æ¯å³å¯ï¼Œä¸­å•ç”¨æˆ·æ„Ÿå—ä¸åˆ°ç‰©æµç³»ç»Ÿçš„æ•…éšœï¼Œæå‡ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</p></li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302011220299.png" alt="image-20230201122049081"></p><ol start="3"><li>å¼‚æ­¥å¤„ç† æœ‰äº›æœåŠ¡é—´è°ƒç”¨æ˜¯å¼‚æ­¥çš„ï¼Œä¾‹å¦‚ A è°ƒç”¨ Bï¼ŒB éœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´æ‰§è¡Œï¼Œä½†æ˜¯ A éœ€è¦çŸ¥é“ B ä»€ä¹ˆæ—¶å€™å¯ ä»¥æ‰§è¡Œå®Œï¼Œä»¥å‰ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼ŒA è¿‡ä¸€æ®µæ—¶é—´å»è°ƒç”¨ B çš„æŸ¥è¯¢ api æŸ¥è¯¢ã€‚æˆ–è€… A æä¾›ä¸€ä¸ª callback apiï¼Œ B æ‰§è¡Œå®Œä¹‹åè°ƒç”¨ api é€šçŸ¥ A æœåŠ¡ã€‚è¿™ä¸¤ç§æ–¹å¼éƒ½ä¸æ˜¯å¾ˆä¼˜é›…ï¼Œä½¿ç”¨æ¶ˆæ¯æ€»çº¿ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ A è°ƒç”¨ B æœåŠ¡åï¼Œåªéœ€è¦ç›‘å¬ B å¤„ç†å®Œæˆçš„æ¶ˆæ¯ï¼Œå½“ B å¤„ç†å®Œæˆåï¼Œä¼šå‘é€ä¸€æ¡æ¶ˆæ¯ç»™ MQï¼ŒMQ ä¼šå°†æ­¤ æ¶ˆæ¯è½¬å‘ç»™ A æœåŠ¡ã€‚è¿™æ · A æœåŠ¡æ—¢ä¸ç”¨å¾ªç¯è°ƒç”¨ B çš„æŸ¥è¯¢ apiï¼Œä¹Ÿä¸ç”¨æä¾› callback apiã€‚åŒæ · B æœåŠ¡ä¹Ÿä¸ ç”¨åšè¿™äº›æ“ä½œã€‚A æœåŠ¡è¿˜èƒ½åŠæ—¶çš„å¾—åˆ°å¼‚æ­¥å¤„ç†æˆåŠŸçš„æ¶ˆæ¯ã€‚</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302011221858.png" alt="image-20230201122130327"></p><h3 id="1-3MQ-çš„åˆ†ç±»"><a href="#1-3MQ-çš„åˆ†ç±»" class="headerlink" title="1.3MQ çš„åˆ†ç±»"></a>1.3MQ çš„åˆ†ç±»</h3><ol><li><p>ActiveMQ<br><strong>ä¼˜ç‚¹ï¼š</strong>å•æœºååé‡ä¸‡çº§ï¼Œæ—¶æ•ˆæ€§ ms çº§ï¼Œå¯ç”¨æ€§é«˜ï¼ŒåŸºäºä¸»ä»æ¶æ„å®ç°é«˜å¯ç”¨æ€§ï¼Œæ¶ˆæ¯å¯é æ€§è¾ƒ ä½çš„æ¦‚ç‡ä¸¢å¤±æ•°æ®<br>**ç¼ºç‚¹:**å®˜æ–¹ç¤¾åŒºç°åœ¨å¯¹ ActiveMQ 5.x <strong>ç»´æŠ¤è¶Šæ¥è¶Šå°‘ï¼Œé«˜ååé‡åœºæ™¯è¾ƒå°‘ä½¿ç”¨ã€‚</strong><br>å°šç¡…è°·å®˜ç½‘è§†é¢‘: <a href="http://www.gulixueyuan.com/course/322">http://www.gulixueyuan.com/course/322</a></p></li><li><p>Kafka å¤§æ•°æ®çš„æ€æ‰‹é”ï¼Œè°ˆåˆ°å¤§æ•°æ®é¢†åŸŸå†…çš„æ¶ˆæ¯ä¼ è¾“ï¼Œåˆ™ç»•ä¸å¼€ Kafkaï¼Œè¿™æ¬¾ä¸ºå¤§æ•°æ®è€Œç”Ÿçš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œ ä»¥å…¶ç™¾ä¸‡çº§ TPS çš„ååé‡åå£°å¤§å™ªï¼Œè¿…é€Ÿæˆä¸ºå¤§æ•°æ®é¢†åŸŸçš„å® å„¿ï¼Œåœ¨æ•°æ®é‡‡é›†ã€ä¼ è¾“ã€å­˜å‚¨çš„è¿‡ç¨‹ä¸­å‘æŒ¥ ç€ä¸¾è¶³è½»é‡çš„ä½œç”¨ã€‚ç›®å‰å·²ç»è¢« LinkedInï¼ŒUber, Twitter, Netflix ç­‰å¤§å…¬å¸æ‰€é‡‡çº³ã€‚<br><strong>ä¼˜ç‚¹:</strong> æ€§èƒ½å“è¶Šï¼Œå•æœºå†™å…¥ TPS çº¦åœ¨ç™¾ä¸‡æ¡&#x2F;ç§’ï¼Œæœ€å¤§çš„ä¼˜ç‚¹ï¼Œå°±æ˜¯<strong>ååé‡é«˜</strong>ã€‚æ—¶æ•ˆæ€§ ms çº§å¯ç”¨æ€§é å¸¸é«˜ï¼Œkafka æ˜¯åˆ†å¸ƒå¼çš„ï¼Œä¸€ä¸ªæ•°æ®å¤šä¸ªå‰¯æœ¬ï¼Œå°‘æ•°æœºå™¨å®•æœºï¼Œä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œä¸ä¼šå¯¼è‡´ä¸å¯ç”¨,æ¶ˆè´¹è€…é‡‡ ç”¨ Pull æ–¹å¼è·å–æ¶ˆæ¯, æ¶ˆæ¯æœ‰åº, é€šè¿‡æ§åˆ¶èƒ½å¤Ÿä¿è¯æ‰€æœ‰æ¶ˆæ¯è¢«æ¶ˆè´¹ä¸”ä»…è¢«æ¶ˆè´¹ä¸€æ¬¡;æœ‰ä¼˜ç§€çš„ç¬¬ä¸‰æ–¹ Kafka Web ç®¡ç†ç•Œé¢ Kafka-Managerï¼›åœ¨æ—¥å¿—é¢†åŸŸæ¯”è¾ƒæˆç†Ÿï¼Œè¢«å¤šå®¶å…¬å¸å’Œå¤šä¸ªå¼€æºé¡¹ç›®ä½¿ç”¨ï¼›åŠŸèƒ½æ”¯æŒï¼š åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ”¯æŒç®€å•çš„ MQ åŠŸèƒ½ï¼Œåœ¨å¤§æ•°æ®é¢†åŸŸçš„å®æ—¶è®¡ç®—ä»¥åŠ<strong>æ—¥å¿—é‡‡é›†</strong>è¢«å¤§è§„æ¨¡ä½¿ç”¨<br><strong>ç¼ºç‚¹ï¼š</strong>Kafka å•æœºè¶…è¿‡ 64 ä¸ªé˜Ÿåˆ—&#x2F;åˆ†åŒºï¼ŒLoad ä¼šå‘ç”Ÿæ˜æ˜¾çš„é£™é«˜ç°è±¡ï¼Œé˜Ÿåˆ—è¶Šå¤šï¼Œload è¶Šé«˜ï¼Œå‘é€æ¶ˆ æ¯å“åº”æ—¶é—´å˜é•¿ï¼Œä½¿ç”¨çŸ­è½®è¯¢æ–¹å¼ï¼Œå®æ—¶æ€§å–å†³äºè½®è¯¢é—´éš”æ—¶é—´ï¼Œæ¶ˆè´¹å¤±è´¥ä¸æ”¯æŒé‡è¯•ï¼›æ”¯æŒæ¶ˆæ¯é¡ºåºï¼Œ ä½†æ˜¯ä¸€å°ä»£ç†å®•æœºåï¼Œå°±ä¼šäº§ç”Ÿæ¶ˆæ¯ä¹±åºï¼Œç¤¾åŒºæ›´æ–°è¾ƒæ…¢ï¼› </p></li><li><p>RocketMQ RocketMQ å‡ºè‡ªé˜¿é‡Œå·´å·´çš„å¼€æºäº§å“ï¼Œç”¨ Java è¯­è¨€å®ç°ï¼Œåœ¨è®¾è®¡æ—¶å‚è€ƒäº† Kafkaï¼Œå¹¶åšå‡ºäº†è‡ªå·±çš„ä¸€ äº›æ”¹è¿›ã€‚è¢«é˜¿é‡Œå·´å·´å¹¿æ³›åº”ç”¨åœ¨è®¢å•ï¼Œäº¤æ˜“ï¼Œå……å€¼ï¼Œæµè®¡ç®—ï¼Œæ¶ˆæ¯æ¨é€ï¼Œæ—¥å¿—æµå¼å¤„ç†ï¼Œbinglog åˆ†å‘ç­‰åœº æ™¯ã€‚<br><strong>ä¼˜ç‚¹:å•æœºååé‡åä¸‡çº§</strong>,å¯ç”¨æ€§éå¸¸é«˜ï¼Œåˆ†å¸ƒå¼æ¶æ„,<strong>æ¶ˆæ¯å¯ä»¥åšåˆ° 0 ä¸¢å¤±</strong>,MQ åŠŸèƒ½è¾ƒä¸ºå®Œå–„ï¼Œè¿˜æ˜¯åˆ† å¸ƒå¼çš„ï¼Œæ‰©å±•æ€§å¥½,<strong>æ”¯æŒ 10 äº¿çº§åˆ«çš„æ¶ˆæ¯å †ç§¯</strong>ï¼Œä¸ä¼šå› ä¸ºå †ç§¯å¯¼è‡´æ€§èƒ½ä¸‹é™,æºç æ˜¯ java æˆ‘ä»¬å¯ä»¥è‡ªå·±é˜… è¯»æºç ï¼Œå®šåˆ¶è‡ªå·±å…¬å¸çš„ MQ<br><strong>ç¼ºç‚¹ï¼šæ”¯æŒçš„å®¢æˆ·ç«¯è¯­è¨€ä¸å¤š</strong>ï¼Œç›®å‰æ˜¯ java åŠ c++ï¼Œå…¶ä¸­ c++ä¸æˆç†Ÿï¼›ç¤¾åŒºæ´»è·ƒåº¦ä¸€èˆ¬,æ²¡æœ‰åœ¨ MQ æ ¸å¿ƒä¸­å»å®ç° JMS ç­‰æ¥å£,æœ‰äº›ç³»ç»Ÿè¦è¿ç§»éœ€è¦ä¿®æ”¹å¤§é‡ä»£ç  </p></li><li><p>RabbitMQ 2007 å¹´å‘å¸ƒï¼Œæ˜¯ä¸€ä¸ªåœ¨ AMQP(é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®)åŸºç¡€ä¸Šå®Œæˆçš„ï¼Œå¯å¤ç”¨çš„ä¼ä¸šæ¶ˆæ¯ç³»ç»Ÿï¼Œ<strong>æ˜¯å½“å‰æœ€ ä¸»æµçš„æ¶ˆæ¯ä¸­é—´ä»¶ä¹‹ä¸€ã€‚</strong><br><strong>ä¼˜ç‚¹:<strong>ç”±äº erlang è¯­è¨€çš„</strong>é«˜å¹¶å‘ç‰¹æ€§</strong>ï¼Œæ€§èƒ½è¾ƒå¥½ï¼›<strong>ååé‡åˆ°ä¸‡çº§</strong>ï¼ŒMQ åŠŸèƒ½æ¯”è¾ƒå®Œå¤‡,å¥å£®ã€ç¨³å®šã€æ˜“ ç”¨ã€è·¨å¹³å°ã€<strong>æ”¯æŒå¤šç§è¯­è¨€</strong> å¦‚ï¼šPythonã€Rubyã€.NETã€Javaã€JMSã€Cã€PHPã€ActionScriptã€XMPPã€STOMP ç­‰ï¼Œæ”¯æŒ AJAX æ–‡æ¡£é½å…¨ï¼›å¼€æºæä¾›çš„ç®¡ç†ç•Œé¢éå¸¸æ£’ï¼Œç”¨èµ·æ¥å¾ˆå¥½ç”¨,<strong>ç¤¾åŒºæ´»è·ƒåº¦é«˜</strong>ï¼›<br>æ›´æ–°é¢‘ç‡ç›¸å½“é«˜ <a href="https://www.rabbitmq.com/news.html">https://www.rabbitmq.com/news.html</a><br><strong>ç¼ºç‚¹ï¼š</strong>å•†ä¸šç‰ˆéœ€è¦æ”¶è´¹,å­¦ä¹ æˆæœ¬è¾ƒé«˜</p></li></ol><h3 id="1-4MQ-çš„é€‰æ‹©"><a href="#1-4MQ-çš„é€‰æ‹©" class="headerlink" title="1.4MQ çš„é€‰æ‹©"></a>1.4MQ çš„é€‰æ‹©</h3><ol><li><p>Kafka<br>Kafka ä¸»è¦ç‰¹ç‚¹æ˜¯åŸºäº Pull çš„æ¨¡å¼æ¥å¤„ç†æ¶ˆæ¯æ¶ˆè´¹ï¼Œè¿½æ±‚é«˜ååé‡ï¼Œä¸€å¼€å§‹çš„ç›®çš„å°±æ˜¯ç”¨äºæ—¥å¿—æ”¶é›† å’Œä¼ è¾“ï¼Œé€‚åˆäº§ç”Ÿå¤§é‡æ•°æ®çš„äº’è”ç½‘æœåŠ¡çš„æ•°æ®æ”¶é›†ä¸šåŠ¡ã€‚å¤§å‹å…¬å¸å»ºè®®å¯ä»¥é€‰ç”¨ï¼Œå¦‚æœæœ‰æ—¥å¿—é‡‡é›†åŠŸèƒ½ï¼Œ è‚¯å®šæ˜¯é¦–é€‰ kafka äº†ã€‚å°šç¡…è°·å®˜ç½‘ kafka è§†é¢‘è¿æ¥ <a href="http://www.gulixueyuan.com/course/330/tasks">http://www.gulixueyuan.com/course/330/tasks</a></p></li><li><p>RocketMQ<br>å¤©ç”Ÿä¸ºé‡‘èäº’è”ç½‘é¢†åŸŸè€Œç”Ÿï¼Œå¯¹äºå¯é æ€§è¦æ±‚å¾ˆé«˜çš„åœºæ™¯ï¼Œå°¤å…¶æ˜¯ç”µå•†é‡Œé¢çš„è®¢å•æ‰£æ¬¾ï¼Œä»¥åŠä¸šåŠ¡å‰Š å³°ï¼Œåœ¨å¤§é‡äº¤æ˜“æ¶Œå…¥æ—¶ï¼Œåç«¯å¯èƒ½æ— æ³•åŠæ—¶å¤„ç†çš„æƒ…å†µã€‚RoketMQ åœ¨ç¨³å®šæ€§ä¸Šå¯èƒ½æ›´å€¼å¾—ä¿¡èµ–ï¼Œè¿™äº›ä¸šåŠ¡ åœºæ™¯åœ¨é˜¿é‡ŒåŒ 11 å·²ç»ç»å†äº†å¤šæ¬¡è€ƒéªŒï¼Œå¦‚æœä½ çš„ä¸šåŠ¡æœ‰ä¸Šè¿°å¹¶å‘åœºæ™¯ï¼Œå»ºè®®å¯ä»¥é€‰æ‹© RocketMQã€‚</p></li><li><p>RabbitMQ<br>ç»“åˆ erlang è¯­è¨€æœ¬èº«çš„å¹¶å‘ä¼˜åŠ¿ï¼Œæ€§èƒ½å¥½æ—¶æ•ˆæ€§å¾®ç§’çº§ï¼Œç¤¾åŒºæ´»è·ƒåº¦ä¹Ÿæ¯”è¾ƒé«˜ï¼Œç®¡ç†ç•Œé¢ç”¨èµ·æ¥ååˆ† æ–¹ä¾¿ï¼Œå¦‚æœä½ çš„æ•°æ®é‡æ²¡æœ‰é‚£ä¹ˆå¤§ï¼Œä¸­å°å‹å…¬å¸ä¼˜å…ˆé€‰æ‹©åŠŸèƒ½æ¯”è¾ƒå®Œå¤‡çš„ RabbitMQã€‚</p></li></ol><h2 id="2-RabbitMQ"><a href="#2-RabbitMQ" class="headerlink" title="2.RabbitMQ"></a>2.RabbitMQ</h2><h3 id="2-1-RabbitMQ-çš„æ¦‚å¿µ"><a href="#2-1-RabbitMQ-çš„æ¦‚å¿µ" class="headerlink" title="2.1 RabbitMQ çš„æ¦‚å¿µ"></a>2.1 RabbitMQ çš„æ¦‚å¿µ</h3><p>RabbitMQ æ˜¯ä¸€ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶ï¼šå®ƒæ¥å—å¹¶è½¬å‘æ¶ˆæ¯ã€‚ä½ å¯ä»¥æŠŠå®ƒå½“åšä¸€ä¸ªå¿«é€’ç«™ç‚¹ï¼Œå½“ä½ è¦å‘é€ä¸€ä¸ªåŒ… è£¹æ—¶ï¼Œä½ æŠŠä½ çš„åŒ…è£¹æ”¾åˆ°å¿«é€’ç«™ï¼Œå¿«é€’å‘˜æœ€ç»ˆä¼šæŠŠä½ çš„å¿«é€’é€åˆ°æ”¶ä»¶äººé‚£é‡Œï¼ŒæŒ‰ç…§è¿™ç§é€»è¾‘ RabbitMQ æ˜¯ ä¸€ä¸ªå¿«é€’ç«™ï¼Œä¸€ä¸ªå¿«é€’å‘˜å¸®ä½ ä¼ é€’å¿«ä»¶ã€‚RabbitMQ ä¸å¿«é€’ç«™çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼Œå®ƒä¸å¤„ç†å¿«ä»¶è€Œæ˜¯æ¥æ”¶ï¼Œ å­˜å‚¨å’Œè½¬å‘æ¶ˆæ¯æ•°æ®ã€‚</p><h3 id="2-2-å››å¤§æ ¸å¿ƒæ¦‚å¿µ"><a href="#2-2-å››å¤§æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="2.2 å››å¤§æ ¸å¿ƒæ¦‚å¿µ"></a>2.2 å››å¤§æ ¸å¿ƒæ¦‚å¿µ</h3><ol><li><p>ç”Ÿäº§è€…</p><p>äº§ç”Ÿæ•°æ®å‘é€æ¶ˆæ¯çš„ç¨‹åºæ˜¯ç”Ÿäº§è€…</p></li><li><p>äº¤æ¢æœº</p><p>äº¤æ¢æœºæ˜¯ RabbitMQ éå¸¸é‡è¦çš„ä¸€ä¸ªéƒ¨ä»¶ï¼Œä¸€æ–¹é¢å®ƒæ¥æ”¶æ¥è‡ªç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œå¦ä¸€æ–¹é¢å®ƒå°†æ¶ˆæ¯</p><p>æ¨é€åˆ°é˜Ÿåˆ—ä¸­ã€‚äº¤æ¢æœºå¿…é¡»ç¡®åˆ‡çŸ¥é“å¦‚ä½•å¤„ç†å®ƒæ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œæ˜¯å°†è¿™äº›æ¶ˆæ¯æ¨é€åˆ°ç‰¹å®šé˜Ÿåˆ—è¿˜æ˜¯æ¨</p><p>é€åˆ°å¤šä¸ªé˜Ÿåˆ—ï¼Œäº¦æˆ–è€…æ˜¯æŠŠæ¶ˆæ¯ä¸¢å¼ƒï¼Œè¿™ä¸ªå¾—æœ‰äº¤æ¢æœºç±»å‹å†³å®š</p></li><li><p>é˜Ÿåˆ—</p><p>é˜Ÿåˆ—æ˜¯ RabbitMQ å†…éƒ¨ä½¿ç”¨çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå°½ç®¡æ¶ˆæ¯æµç» RabbitMQ å’Œåº”ç”¨ç¨‹åºï¼Œä½†å®ƒä»¬åªèƒ½å­˜</p><p>å‚¨åœ¨é˜Ÿåˆ—ä¸­ã€‚é˜Ÿåˆ—ä»…å—ä¸»æœºçš„å†…å­˜å’Œç£ç›˜é™åˆ¶çš„çº¦æŸï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¤§çš„æ¶ˆæ¯ç¼“å†²åŒºã€‚è®¸å¤šç”Ÿäº§è€…å¯</p><p>ä»¥å°†æ¶ˆæ¯å‘é€åˆ°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œè®¸å¤šæ¶ˆè´¹è€…å¯ä»¥å°è¯•ä»ä¸€ä¸ªé˜Ÿåˆ—æ¥æ”¶æ•°æ®ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨é˜Ÿåˆ—çš„æ–¹å¼</p></li><li><p>æ¶ˆè´¹è€…</p><p>æ¶ˆè´¹ä¸æ¥æ”¶å…·æœ‰ç›¸ä¼¼çš„å«ä¹‰ã€‚æ¶ˆè´¹è€…å¤§å¤šæ—¶å€™æ˜¯ä¸€ä¸ªç­‰å¾…æ¥æ”¶æ¶ˆæ¯çš„ç¨‹åºã€‚è¯·æ³¨æ„ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹</p><p>è€…å’Œæ¶ˆæ¯ä¸­é—´ä»¶å¾ˆå¤šæ—¶å€™å¹¶ä¸åœ¨åŒä¸€æœºå™¨ä¸Šã€‚åŒä¸€ä¸ªåº”ç”¨ç¨‹åºæ—¢å¯ä»¥æ˜¯ç”Ÿäº§è€…åˆæ˜¯å¯ä»¥æ˜¯æ¶ˆè´¹è€…ã€‚</p></li></ol><h3 id="2-3-RabbitMQ-æ ¸å¿ƒéƒ¨åˆ†"><a href="#2-3-RabbitMQ-æ ¸å¿ƒéƒ¨åˆ†" class="headerlink" title="2.3 RabbitMQ æ ¸å¿ƒéƒ¨åˆ†"></a>2.3 RabbitMQ æ ¸å¿ƒéƒ¨åˆ†</h3><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302011234736.png" alt="image-20230201123408865"></p><h3 id="2-5å„ä¸ªåè¯ä»‹ç»"><a href="#2-5å„ä¸ªåè¯ä»‹ç»" class="headerlink" title="2.5å„ä¸ªåè¯ä»‹ç»"></a>2.5å„ä¸ªåè¯ä»‹ç»</h3><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302011234537.png" alt="image-20230201123452541"></p><ul><li><p><strong>Brokerï¼š</strong>æ¥æ”¶å’Œåˆ†å‘æ¶ˆæ¯çš„åº”ç”¨ï¼ŒRabbitMQ Server å°±æ˜¯ Message Broker</p></li><li><p><strong>Virtual hostï¼š</strong>å‡ºäºå¤šç§Ÿæˆ·å’Œå®‰å…¨å› ç´ è®¾è®¡çš„ï¼ŒæŠŠ AMQP çš„åŸºæœ¬ç»„ä»¶åˆ’åˆ†åˆ°ä¸€ä¸ªè™šæ‹Ÿçš„åˆ†ç»„ä¸­ï¼Œç±»ä¼¼</p><p>äºç½‘ç»œä¸­çš„ namespace æ¦‚å¿µã€‚å½“å¤šä¸ªä¸åŒçš„ç”¨æˆ·ä½¿ç”¨åŒä¸€ä¸ª RabbitMQ server æä¾›çš„æœåŠ¡æ—¶ï¼Œå¯ä»¥åˆ’åˆ†å‡º</p><p>å¤šä¸ª vhostï¼Œæ¯ä¸ªç”¨æˆ·åœ¨è‡ªå·±çš„ vhost åˆ›å»º exchangeï¼queue ç­‰</p></li><li><p><strong>Connectionï¼š</strong>publisherï¼consumer å’Œ broker ä¹‹é—´çš„ TCP è¿æ¥</p></li><li><p><strong>Channelï¼š</strong>å¦‚æœæ¯ä¸€æ¬¡è®¿é—® RabbitMQ éƒ½å»ºç«‹ä¸€ä¸ª Connectionï¼Œåœ¨æ¶ˆæ¯é‡å¤§çš„æ—¶å€™å»ºç«‹ TCP </p><p>Connection çš„å¼€é”€å°†æ˜¯å·¨å¤§çš„ï¼Œæ•ˆç‡ä¹Ÿè¾ƒä½ã€‚Channel æ˜¯åœ¨ connection å†…éƒ¨å»ºç«‹çš„é€»è¾‘è¿æ¥ï¼Œå¦‚æœåº”ç”¨ç¨‹</p><p>åºæ”¯æŒå¤šçº¿ç¨‹ï¼Œé€šå¸¸æ¯ä¸ª thread åˆ›å»ºå•ç‹¬çš„ channel è¿›è¡Œé€šè®¯ï¼ŒAMQP method åŒ…å«äº† channel id å¸®åŠ©å®¢</p><p>æˆ·ç«¯å’Œ message broker è¯†åˆ« channelï¼Œæ‰€ä»¥ channel ä¹‹é—´æ˜¯å®Œå…¨éš”ç¦»çš„ã€‚Channel ä½œä¸ºè½»é‡çº§çš„</p><p><strong>Connection æå¤§å‡å°‘äº†æ“ä½œç³»ç»Ÿå»ºç«‹ TCP connection çš„å¼€é”€</strong> </p></li><li><p><strong>Exchangeï¼š</strong>message åˆ°è¾¾ broker çš„ç¬¬ä¸€ç«™ï¼Œæ ¹æ®åˆ†å‘è§„åˆ™ï¼ŒåŒ¹é…æŸ¥è¯¢è¡¨ä¸­çš„ routing keyï¼Œåˆ†å‘</p><p>æ¶ˆæ¯åˆ° queue ä¸­å»ã€‚å¸¸ç”¨çš„ç±»å‹æœ‰ï¼šdirect (point-to-point), topic (publish-subscribe) and fanout </p><p>(multicast)</p></li><li><p><strong>Queueï¼š</strong>æ¶ˆæ¯æœ€ç»ˆè¢«é€åˆ°è¿™é‡Œç­‰å¾… consumer å–èµ°</p></li><li><p><strong>Bindingï¼š</strong>exchange å’Œ queue ä¹‹é—´çš„è™šæ‹Ÿè¿æ¥ï¼Œbinding ä¸­å¯ä»¥åŒ…å« routing keyï¼ŒBinding ä¿¡æ¯è¢«ä¿</p></li><li><p>å­˜åˆ° exchange ä¸­çš„æŸ¥è¯¢è¡¨ä¸­ï¼Œç”¨äº message çš„åˆ†å‘ä¾æ®</p></li></ul><h3 id="2-6RabbitMQ-å®‰è£…"><a href="#2-6RabbitMQ-å®‰è£…" class="headerlink" title="2.6RabbitMQ å®‰è£…"></a>2.6RabbitMQ å®‰è£…</h3><ol><li><p>å®˜ç½‘åœ°å€ä¸‹è½½<br><a href="https://www.rabbitmq.com/download.html">https://www.rabbitmq.com/download.html</a></p></li><li><p>æ–‡ä»¶ä¸Šä¼ <br>ä¸Šä¼ åˆ° &#x2F;usr&#x2F;local&#x2F;software ç›®å½•ä¸‹ï¼ˆå¯ä»¥ä½¿ç”¨ Xftp ä¸Šä¼ ï¼‰<br><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151047302.png" alt="image-20230115104710973"></p></li><li><p>å®‰è£…æ–‡ä»¶ï¼ˆæŒ‰ç…§é¡ºåºå®‰è£…ï¼‰<br>rpm -ivh erlang-21.3-1.el7.x86_64.rpm    å®‰è£… Erlang </p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151049919.png" alt="image-20230115104905385">yum install socat -yå®‰è£…ä¾èµ–åŒ…</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151054823.png" alt="image-20230115105402243">rpm -ivh rabbitmq-server-3.8.8-1.el7.noarch.rpm</p><p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20230115105503632.png" alt="image-20230115105503632">æ³¨ï¼ši å‘½ä»¤è¡¨ç¤º install å®‰è£…ï¼›vh å‘½ä»¤æ˜¾ç¤ºå®‰è£…è¿›åº¦ï¼›yum å‘½ä»¤éœ€è¦è”ç½‘</p></li><li><p>å¸¸ç”¨å‘½ä»¤ï¼ˆæŒ‰é¡ºåºï¼‰<br>æ·»åŠ å¼€æœºå¯åŠ¨ RabbitMQ æœåŠ¡<br>chkconfig rabbitmq-server on<br><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151058073.png" alt="image-20230115105835506"></p><p>å¯åŠ¨æœåŠ¡<br>&#x2F;sbin&#x2F;service rabbitmq-server start<br><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151102110.png" alt="image-20230115110208280"><br>æŸ¥çœ‹æœåŠ¡çŠ¶æ€<br>&#x2F;sbin&#x2F;service rabbitmq-server status<br>Active: active (running)    è¡¨ç¤ºå¯åŠ¨å¥½äº†</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151103464.png" alt="image-20230115110311101"></p></li></ol><p>â€‹åœæ­¢æœåŠ¡ï¼ˆé€‰æ‹©æ‰§è¡Œï¼‰<br>â€‹ &#x2F;sbin&#x2F;service rabbitmq-server stop<br>â€‹å¼€å¯ web æ’ä»¶<br>â€‹rabbitmq-plugins enable rabbitmq_management<br>â€‹æŸ¥çœ‹é˜²ç«å¢™çš„çŠ¶æ€<br>â€‹systemctl status firewalld<br>â€‹å…³é—­é˜²ç«å¢™<br>â€‹systemctl stop firewalld<br>â€‹å¼€æœºæ—¶é˜²ç«å¢™ä¸å†å¼€å¯<br>â€‹systemctl enable firewalld<br>â€‹ç”¨é»˜è®¤è´¦å·å¯†ç (guest)è®¿é—®åœ°å€ <a href="http://47.115.185.244:15672/%E5%87%BA%E7%8E%B0%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98">http://47.115.185.244:15672/å‡ºç°æƒé™é—®é¢˜</a>(æœåŠ¡å™¨éœ€è¦å¼€æ”¾ 15672 ç«¯å£)</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151119523.png" alt="image-20230115111908386"></p><ol start="5"><li><p>æ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ·</p><ol><li><p>åˆ›å»ºè´¦å· rabbitmqctl add_user admin 123 </p></li><li><p>è®¾ç½®ç”¨æˆ·è§’è‰² rabbitmqctl set_user_tags admin administrator </p></li><li><p>è®¾ç½®ç”¨æˆ·æƒé™ set_permissions [-p ] <user> <conf> <wirte> <read></p><p>æ‰§è¡Œå‘½ä»¤ï¼š rabbitmqctl set_permissions -p â€œ&#x2F;â€œ admin â€œ.<em>â€œ â€œ.</em>â€œ â€œ.*â€</p><p>ç”¨æˆ· user_admin å…·æœ‰&#x2F;vhost1 è¿™ä¸ª virtual host ä¸­æ‰€æœ‰èµ„æºçš„é…ç½®ã€å†™ã€è¯»æƒé™ å½“å‰ç”¨æˆ·å’Œè§’è‰²</p><p>å±•ç¤º rabbitmq çš„ç”¨æˆ·ï¼šrabbitmqctl list_users</p><p>è¾“å…¥è´¦æˆ·å¯†ç  admin 123 ç™»å½•å³å¯</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151135084.png" alt="image-20230115113515504"><strong>æ³¨ï¼šrebbitmqctl å‘½ä»¤è¡¨ç¤ºè®¾ç½®æƒé™ï¼›ä¸åŒçš„ Virtual Hosts äº¤æ¢æœºï¼ˆExchanges)å’Œé˜Ÿåˆ—(Queuees)æ˜¯ä¸ä¸€æ ·çš„</strong></p></li></ol></li><li><p>é‡ç½®å‘½ä»¤</p><ol><li>å…³é—­åº”ç”¨å‘½ä»¤ rabbitmqctl stop_app</li><li>æ¸…é™¤å‘½ä»¤ rabbitmqctl resest</li><li>é‡æ–°å¯åŠ¨å‘½ä»¤ rabbitmqctl start_app</li></ol></li></ol><h2 id="3-RabbitMQ"><a href="#3-RabbitMQ" class="headerlink" title="3.RabbitMQ"></a>3.RabbitMQ</h2><h3 id="3-1Hello-World-æ¡ˆä¾‹"><a href="#3-1Hello-World-æ¡ˆä¾‹" class="headerlink" title="3.1Hello World æ¡ˆä¾‹"></a>3.1Hello World æ¡ˆä¾‹</h3><p>åœ¨æœ¬æ•™ç¨‹çš„è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ç”¨ Java ç¼–å†™ä¸¤ä¸ªç¨‹åºã€‚å‘é€å•ä¸ªæ¶ˆæ¯çš„ç”Ÿäº§è€…å’Œæ¥æ”¶æ¶ˆæ¯å¹¶æ‰“å° å‡ºæ¥çš„æ¶ˆè´¹è€…ã€‚æˆ‘ä»¬å°†ä»‹ç» Java API ä¸­çš„ä¸€äº›ç»†èŠ‚ã€‚</p><p> åœ¨ä¸‹å›¾ä¸­ï¼Œâ€œ Pâ€æ˜¯æˆ‘ä»¬çš„ç”Ÿäº§è€…ï¼Œâ€œ Câ€æ˜¯æˆ‘ä»¬çš„æ¶ˆè´¹è€…ã€‚ä¸­é—´çš„æ¡†æ˜¯ä¸€ä¸ªé˜Ÿåˆ—-RabbitMQ ä»£ è¡¨ä½¿ç”¨è€…ä¿ç•™çš„æ¶ˆæ¯ç¼“å†²åŒº<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151155281.png" alt="image-20230115115509389"></p><h4 id="3-1-1é…ç½®ç¯å¢ƒ"><a href="#3-1-1é…ç½®ç¯å¢ƒ" class="headerlink" title="3.1.1é…ç½®ç¯å¢ƒ"></a>3.1.1é…ç½®ç¯å¢ƒ</h4><p>åˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®ï¼Œç„¶ååˆ›å»º rabbitmq-hello æ¨¡å—ï¼Œåœ¨ rabbitmq-hello æ·»åŠ ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--æŒ‡å®š jdk ç¼–è¯‘ç‰ˆæœ¬--&gt;</span><br><span class="line">   &lt;build&gt;</span><br><span class="line">       &lt;plugins&gt;</span><br><span class="line">           &lt;plugin&gt;</span><br><span class="line">               &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">               &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;</span><br><span class="line">               &lt;configuration&gt;</span><br><span class="line">                   &lt;source&gt;<span class="number">8</span>&lt;/source&gt;</span><br><span class="line">                   &lt;target&gt;<span class="number">8</span>&lt;/target&gt;</span><br><span class="line">               &lt;/configuration&gt;</span><br><span class="line">           &lt;/plugin&gt;</span><br><span class="line">       &lt;/plugins&gt;</span><br><span class="line">   &lt;/build&gt;</span><br><span class="line">   &lt;dependencies&gt;</span><br><span class="line">       &lt;!--rabbitmq ä¾èµ–å®¢æˆ·ç«¯--&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;com.rabbitmq&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;amqp-client&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;<span class="number">5.8</span><span class="number">.0</span>&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">       &lt;!--æ“ä½œæ–‡ä»¶æµçš„ä¸€ä¸ªä¾èµ–--&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;commons-io&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;commons-io&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;<span class="number">2.6</span>&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;slf4j-nop&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;<span class="number">1.7</span><span class="number">.2</span>&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">   &lt;/dependencies&gt;</span><br></pre></td></tr></table></figure><h4 id="3-1-2æ¶ˆè´¹ç”Ÿäº§è€…"><a href="#3-1-2æ¶ˆè´¹ç”Ÿäº§è€…" class="headerlink" title="3.1.2æ¶ˆè´¹ç”Ÿäº§è€…"></a>3.1.2æ¶ˆè´¹ç”Ÿäº§è€…</h4><p>RabbitMQ å·¥ä½œåŸç†å›¾<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151447611.png" alt="image-20230115144729758"></p><p>æ­¥éª¤ï¼š</p><ol><li>åˆ›å»ºè¿æ¥å·¥å‚</li><li>è®¾ç½®è¿æ¥ RabbitMQ çš„ IP åœ°å€</li><li>è®¾ç½®ç”¨æˆ·åå’Œå¯†ç </li><li>åˆ›å»ºè¿æ¥</li><li>è·å–ä¿¡é“</li><li>ç”Ÿæˆé˜Ÿåˆ—</li><li>å‘é€æ¶ˆæ¯</li></ol><p>åˆ›å»ºä¸€ä¸ªç”Ÿäº§è€…ç±» Producerï¼Œå‘é€æ¶ˆæ¯ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ç”Ÿäº§è€…ï¼šå‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/1/15 12:07</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Producer</span> &#123;</span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">RABBITMQ_HOST</span> <span class="operator">=</span> <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªè¿æ¥å·¥å‚</span></span><br><span class="line">        <span class="type">ConnectionFactory</span> <span class="variable">connectionFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">        <span class="comment">// å·¥å‚ IP è¿æ¥ RabbitMQ çš„é˜Ÿåˆ—</span></span><br><span class="line">        connectionFactory.setHost(RABBITMQ_HOST);</span><br><span class="line">        <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        <span class="comment">// å¯†ç </span></span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> connectionFactory.newConnection();</span><br><span class="line">        <span class="comment">// è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * ç”Ÿæˆä¸€ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         * 1.é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.é˜Ÿåˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼ˆç£ç›˜ï¼‰ é»˜è®¤æƒ…å†µä¸‹æ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrue: å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ flase: åªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€è¿æ¥ä»¥å è¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrue è‡ªåŠ¨åˆ é™¤ false ä¸è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// å‘æ¶ˆæ¯</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å‘é€ä¸€ä¸ªæ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">         * 2.è·¯ç”±çš„ key å€¼æ˜¯å“ªä¸ª æœ¬æ¬¡é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">         * 3.å…¶ä»–å‚æ•°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">         * 4.å‘é€æ¶ˆæ¯çš„æœ¬ä½“</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.basicPublish(<span class="string">&quot;&quot;</span>,QUEUE_NAME, <span class="literal">null</span>, message.getBytes());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€å®Œæ¯•ï¼ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘é€æˆåŠŸåå¯ä»¥åœ¨ç®¡ç†å®¢æˆ·ç«¯ä¸­ Queues ä¸­æŸ¥çœ‹è¯¦æƒ…</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151256110.png" alt="image-20230115125655206"></p><h4 id="3-1-3æ¶ˆæ¯æ¶ˆè´¹è€…"><a href="#3-1-3æ¶ˆæ¯æ¶ˆè´¹è€…" class="headerlink" title="3.1.3æ¶ˆæ¯æ¶ˆè´¹è€…"></a>3.1.3æ¶ˆæ¯æ¶ˆè´¹è€…</h4><p>åˆ›å»ºä¸€ä¸ªæ¶ˆè´¹è€… Consumer ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ç”Ÿäº§è€…ï¼šå‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/1/15 12:07</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Producer</span> &#123;</span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">RABBITMQ_HOST</span> <span class="operator">=</span> <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªè¿æ¥å·¥å‚</span></span><br><span class="line">        <span class="type">ConnectionFactory</span> <span class="variable">connectionFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">        <span class="comment">// å·¥å‚ IP è¿æ¥ RabbitMQ çš„é˜Ÿåˆ—</span></span><br><span class="line">        connectionFactory.setHost(RABBITMQ_HOST);</span><br><span class="line">        <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        <span class="comment">// å¯†ç </span></span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> connectionFactory.newConnection();</span><br><span class="line">        <span class="comment">// è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * ç”Ÿæˆä¸€ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         * 1.é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.é˜Ÿåˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼ˆç£ç›˜ï¼‰ é»˜è®¤æƒ…å†µä¸‹æ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrue: å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ flase: åªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€è¿æ¥ä»¥å è¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrue è‡ªåŠ¨åˆ é™¤ false ä¸è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// å‘æ¶ˆæ¯</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å‘é€ä¸€ä¸ªæ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">         * 2.è·¯ç”±çš„ key å€¼æ˜¯å“ªä¸ª æœ¬æ¬¡é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">         * 3.å…¶ä»–å‚æ•°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">         * 4.å‘é€æ¶ˆæ¯çš„æœ¬ä½“</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.basicPublish(<span class="string">&quot;&quot;</span>,QUEUE_NAME, <span class="literal">null</span>, message.getBytes());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€å®Œæ¯•ï¼ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-1-4å¸¸è§æŠ¥é”™ä»¥åŠè§£å†³"><a href="#3-1-4å¸¸è§æŠ¥é”™ä»¥åŠè§£å†³" class="headerlink" title="3.1.4å¸¸è§æŠ¥é”™ä»¥åŠè§£å†³"></a>3.1.4å¸¸è§æŠ¥é”™ä»¥åŠè§£å†³</h4><ol><li>SQL4J é”™è¯¯</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151235731.png" alt="image-20230115123511995"></p><p>æ·»åŠ  SLF4J ä¾èµ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;slf4j-nop&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">1.7</span><span class="number">.2</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>åˆ›å»ºè¿æ¥java.net.ConnectException: Connection timed out: connect</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301151254283.png" alt="image-20230115125416151"></p><p>â€‹åŸå› ï¼šæœåŠ¡å™¨çš„ 5672 ç«¯å£æ²¡æœ‰å¼€å¯ï¼Œåœ¨æœåŠ¡å™¨å¼€å¯ 5672 ç«¯å£ï¼Œé‡æ–°å¯åŠ¨å³å¯</p><h3 id="3-2-Work-Queues-æ¡ˆä¾‹"><a href="#3-2-Work-Queues-æ¡ˆä¾‹" class="headerlink" title="3.2 Work Queues æ¡ˆä¾‹"></a>3.2 Work Queues æ¡ˆä¾‹</h3><p>å·¥ä½œé˜Ÿåˆ—(åˆç§°ä»»åŠ¡é˜Ÿåˆ—)çš„ä¸»è¦æ€æƒ³æ˜¯é¿å…ç«‹å³æ‰§è¡Œèµ„æºå¯†é›†å‹ä»»åŠ¡ï¼Œè€Œä¸å¾—ä¸ç­‰å¾…å®ƒå®Œæˆã€‚ ç›¸åæˆ‘ä»¬å®‰æ’ä»»åŠ¡åœ¨ä¹‹åæ‰§è¡Œã€‚æˆ‘ä»¬æŠŠä»»åŠ¡å°è£…ä¸ºæ¶ˆæ¯å¹¶å°†å…¶å‘é€åˆ°é˜Ÿåˆ—ã€‚åœ¨åå°è¿è¡Œçš„å·¥ä½œè¿› ç¨‹å°†å¼¹å‡ºä»»åŠ¡å¹¶æœ€ç»ˆæ‰§è¡Œä½œä¸šã€‚å½“æœ‰å¤šä¸ªå·¥ä½œçº¿ç¨‹æ—¶ï¼Œè¿™äº›å·¥ä½œçº¿ç¨‹å°†ä¸€èµ·å¤„ç†è¿™äº›ä»»åŠ¡ã€‚</p><p><img src="E:\java\Learn\æ¶ˆæ¯é˜Ÿåˆ—\å¢¨æ«æ¶ˆæ¯é˜Ÿåˆ—.assets\202301151502309.png" alt="image-20230115150241640"></p><h4 id="3-2-1-è½®è¯¢åˆ†å‘æ¶ˆæ¯"><a href="#3-2-1-è½®è¯¢åˆ†å‘æ¶ˆæ¯" class="headerlink" title="3.2.1 è½®è¯¢åˆ†å‘æ¶ˆæ¯"></a>3.2.1 è½®è¯¢åˆ†å‘æ¶ˆæ¯</h4><p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­æˆ‘ä»¬ä¼šå¯åŠ¨ä¸¤ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œä¸€ä¸ªæ¶ˆæ¯å‘é€çº¿ç¨‹ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä»–ä»¬ä¸¤ä¸ªå·¥ä½œçº¿ç¨‹ æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><h4 id="3-2-2-æŠ½å–å·¥å…·ç±»"><a href="#3-2-2-æŠ½å–å·¥å…·ç±»" class="headerlink" title="3.2.2 æŠ½å–å·¥å…·ç±»"></a>3.2.2 æŠ½å–å·¥å…·ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿æ¥å·¥å‚åˆ›å»ºä¿¡é“çš„å·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitMqUtils</span> &#123;</span><br><span class="line">  <span class="comment">// é˜Ÿåˆ—åç§°</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">RABBITMQ_HOST</span> <span class="operator">=</span> <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> Channel <span class="title function_">getChannel</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºä¸€ä¸ªè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    factory.setHost(RABBITMQ_HOST);</span><br><span class="line">    factory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">    factory.setPassword(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line">    <span class="keyword">return</span> channel;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-2-3-å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹"><a href="#3-2-3-å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹" class="headerlink" title="3.2.3 å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹"></a>3.2.3 å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å·¥ä½œçº¿ç¨‹ï¼ˆç›¸å½“äºä¹‹å‰çš„æ¶ˆè´¹è€…ï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/1/15 15:13</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Work01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody()));</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// å–æ¶ˆæ¶ˆæ¯æ—¶çš„å›è°ƒ</span></span><br><span class="line">        <span class="type">CancelCallback</span> <span class="variable">cancelCallback</span> <span class="operator">=</span> consumerTag -&gt; &#123;</span><br><span class="line">            System.out.println(consumerTag + <span class="string">&quot;æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆæ¥å£å›è°ƒé€»è¾‘ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">        System.out.println(<span class="string">&quot;A1 ç­‰å¾…æ¥æ”¶æ¶ˆæ¯.....&quot;</span>);</span><br><span class="line">        <span class="comment">// System.out.println(&quot;A2 ç­‰å¾…æ¥æ”¶æ¶ˆæ¯.....&quot;);</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 1.æ¶ˆè´¹å“ªä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         * 2.æ¶ˆè´¹æˆåŠŸåæ˜¯å¦éœ€è¦è‡ªåŠ¨åº”ç­” true ä»£è¡¨è‡ªåŠ¨åº”ç­” false ä»£è¡¨æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line"><span class="comment">         * 3.æ¶ˆè´¹è€…æœªæˆåŠŸæ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         * 4.æ¶ˆè´¹è€…å–å½•æ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.basicConsume(QUEUE_NAME, <span class="literal">true</span>, deliverCallback, cancelCallback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>IDEA é…ç½®</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301152127541.png" alt="image-20230115212723655"></p><p>ç‚¹å‡» Modify options </p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301152129021.png" alt="image-20230115212858945"></p><p>å‹¾é€‰ Allow mutiple instances å³å¯</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301152129589.png" alt="image-20230115212929005"></p><p>å¯åŠ¨åæ§åˆ¶å°è¾“å‡º</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301152131294.png" alt="image-20230115213101094"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301152131294.png" alt="image-20230115213113872"></p><h4 id="3-2-4-å¯åŠ¨ä¸€ä¸ªå‘é€çº¿ç¨‹"><a href="#3-2-4-å¯åŠ¨ä¸€ä¸ªå‘é€çº¿ç¨‹" class="headerlink" title="3.2.4 å¯åŠ¨ä¸€ä¸ªå‘é€çº¿ç¨‹"></a>3.2.4 å¯åŠ¨ä¸€ä¸ªå‘é€çº¿ç¨‹</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ç”Ÿäº§è€… å‘é€å¤§é‡æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/1/15 15:30</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Task01</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘é€å‘é‡æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// é˜Ÿåˆ—å£°æ˜</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * ç”Ÿæˆä¸€ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         * 1.é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.é˜Ÿåˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼ˆç£ç›˜ï¼‰ é»˜è®¤æƒ…å†µä¸‹æ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrue: å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ flase: åªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€è¿æ¥ä»¥å è¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrue è‡ªåŠ¨åˆ é™¤ false ä¸è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.queueDeclare(QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// ä»æ§åˆ¶å°å½“ä¸­æ¥æ”¶ä¿¡æ¯</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="keyword">while</span>(scanner.hasNext())&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * å‘é€ä¸€ä¸ªæ¶ˆè´¹</span></span><br><span class="line"><span class="comment">             * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">             * 2.è·¯ç”±çš„ key å€¼æ˜¯å“ªä¸ª æœ¬æ¬¡é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">             * 3.å…¶ä»–å‚æ•°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">             * 4.å‘é€æ¶ˆæ¯çš„æœ¬ä½“</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>,QUEUE_NAME, <span class="literal">null</span>, message.getBytes());</span><br><span class="line">            System.out.println(<span class="string">&quot;å‘é€æ¶ˆæ¯å®Œæˆï¼š&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-2-5-ç»“æœå±•ç¤º"><a href="#3-2-5-ç»“æœå±•ç¤º" class="headerlink" title="3.2.5 ç»“æœå±•ç¤º"></a>3.2.5 ç»“æœå±•ç¤º</h4><p>ç”Ÿäº§è€…æ§åˆ¶å°</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301152133408.png" alt="image-20230115213341185"></p><p>æ¶ˆè´¹è€…</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301152134867.png" alt="image-20230115213424143"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202301152134447.png" alt="image-20230115213454899"></p><h3 id="3-3æ¶ˆæ¯åº”ç­”"><a href="#3-3æ¶ˆæ¯åº”ç­”" class="headerlink" title="3.3æ¶ˆæ¯åº”ç­”"></a>3.3æ¶ˆæ¯åº”ç­”</h3><h4 id="3-3-1æ¦‚å¿µ"><a href="#3-3-1æ¦‚å¿µ" class="headerlink" title="3.3.1æ¦‚å¿µ"></a>3.3.1æ¦‚å¿µ</h4><p>â€‹æ¶ˆè´¹è€…å®Œæˆä¸€ä¸ªä»»åŠ¡å¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†ä¸€ä¸ªé•¿çš„ä»»åŠ¡å¹¶ä»…åªå®Œæˆ äº†éƒ¨åˆ†çªç„¶å®ƒæŒ‚æ‰äº†ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚RabbitMQ ä¸€æ—¦å‘æ¶ˆè´¹è€…ä¼ é€’äº†ä¸€æ¡æ¶ˆæ¯ï¼Œä¾¿ç«‹å³å°†è¯¥æ¶ˆ æ¯æ ‡è®°ä¸ºåˆ é™¤ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçªç„¶æœ‰ä¸ªæ¶ˆè´¹è€…æŒ‚æ‰äº†ï¼Œæˆ‘ä»¬å°†ä¸¢å¤±æ­£åœ¨å¤„ç†çš„æ¶ˆæ¯ã€‚ä»¥åŠåç»­ å‘é€ç»™è¯¥æ¶ˆè´¹è¿™çš„æ¶ˆæ¯ï¼Œå› ä¸ºå®ƒæ— æ³•æ¥æ”¶åˆ°ã€‚</p><p>â€‹ä¸ºäº†ä¿è¯æ¶ˆæ¯åœ¨å‘é€è¿‡ç¨‹ä¸­ä¸ä¸¢å¤±ï¼Œrabbitmq å¼•å…¥æ¶ˆæ¯åº”ç­”æœºåˆ¶ï¼Œæ¶ˆæ¯åº”ç­”å°±æ˜¯:<strong>æ¶ˆè´¹è€…åœ¨æ¥ æ”¶åˆ°æ¶ˆæ¯å¹¶ä¸”å¤„ç†è¯¥æ¶ˆæ¯ä¹‹åï¼Œå‘Šè¯‰ rabbitmq å®ƒå·²ç»å¤„ç†äº†ï¼Œrabbitmq å¯ä»¥æŠŠè¯¥æ¶ˆæ¯åˆ é™¤äº†ã€‚</strong> </p><h4 id="3-3-2è‡ªåŠ¨åº”ç­”"><a href="#3-3-2è‡ªåŠ¨åº”ç­”" class="headerlink" title="3.3.2è‡ªåŠ¨åº”ç­”"></a>3.3.2è‡ªåŠ¨åº”ç­”</h4><p>â€‹æ¶ˆæ¯å‘é€åç«‹å³è¢«è®¤ä¸ºå·²ç»ä¼ é€æˆåŠŸï¼Œè¿™ç§æ¨¡å¼éœ€è¦åœ¨<strong>é«˜ååé‡å’Œæ•°æ®ä¼ è¾“å®‰å…¨æ€§æ–¹é¢åšæƒè¡¡</strong>,å› ä¸ºè¿™ç§æ¨¡å¼å¦‚æœæ¶ˆæ¯åœ¨æ¥æ”¶åˆ°ä¹‹å‰ï¼Œæ¶ˆè´¹è€…é‚£è¾¹å‡ºç°è¿æ¥æˆ–è€… channel å…³é—­ï¼Œé‚£ä¹ˆæ¶ˆæ¯å°±ä¸¢ å¤±äº†,å½“ç„¶å¦ä¸€æ–¹é¢è¿™ç§æ¨¡å¼æ¶ˆè´¹è€…é‚£è¾¹å¯ä»¥ä¼ é€’è¿‡è½½çš„æ¶ˆæ¯ï¼Œ<strong>æ²¡æœ‰å¯¹ä¼ é€’çš„æ¶ˆæ¯æ•°é‡è¿›è¡Œé™åˆ¶</strong>ï¼Œ å½“ç„¶è¿™æ ·æœ‰å¯èƒ½ä½¿å¾—æ¶ˆè´¹è€…è¿™è¾¹ç”±äºæ¥æ”¶å¤ªå¤šè¿˜æ¥ä¸åŠå¤„ç†çš„æ¶ˆæ¯ï¼Œå¯¼è‡´è¿™äº›æ¶ˆæ¯çš„ç§¯å‹ï¼Œæœ€ç»ˆ ä½¿å¾—å†…å­˜è€—å°½ï¼Œæœ€ç»ˆè¿™äº›æ¶ˆè´¹è€…çº¿ç¨‹è¢«æ“ä½œç³»ç»Ÿæ€æ­»ï¼Œ<strong>æ‰€ä»¥è¿™ç§æ¨¡å¼ä»…é€‚ç”¨åœ¨æ¶ˆè´¹è€…å¯ä»¥é«˜æ•ˆå¹¶ ä»¥æŸç§é€Ÿç‡èƒ½å¤Ÿå¤„ç†è¿™äº›æ¶ˆæ¯çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚</strong></p><h4 id="3-3-3æ¶ˆæ¯åº”ç­”çš„æ–¹æ³•"><a href="#3-3-3æ¶ˆæ¯åº”ç­”çš„æ–¹æ³•" class="headerlink" title="3.3.3æ¶ˆæ¯åº”ç­”çš„æ–¹æ³•"></a>3.3.3æ¶ˆæ¯åº”ç­”çš„æ–¹æ³•</h4><ul><li>A.Channel.basicAck(ç”¨äºè‚¯å®šç¡®è®¤)</li></ul><p>â€‹RabbitMQ å·²çŸ¥é“è¯¥æ¶ˆæ¯å¹¶ä¸”æˆåŠŸçš„å¤„ç†æ¶ˆæ¯ï¼Œå¯ä»¥å°†å…¶ä¸¢å¼ƒäº† </p><ul><li><p>B.Channel.basicNack(ç”¨äºå¦å®šç¡®è®¤) </p></li><li><p>C.Channel.basicReject(ç”¨äºå¦å®šç¡®è®¤)</p></li></ul><p>â€‹ä¸ Channel.basicNack ç›¸æ¯”å°‘ä¸€ä¸ªå‚æ•° </p><p>â€‹ä¸å¤„ç†è¯¥æ¶ˆæ¯äº†ç›´æ¥æ‹’ç»ï¼Œå¯ä»¥å°†å…¶ä¸¢å¼ƒäº†</p><h4 id="3-3-4Multiple-çš„è§£é‡Š"><a href="#3-3-4Multiple-çš„è§£é‡Š" class="headerlink" title="3.3.4Multiple çš„è§£é‡Š"></a>3.3.4Multiple çš„è§£é‡Š</h4><p><strong>æ‰‹åŠ¨åº”ç­”çš„å¥½å¤„æ˜¯å¯ä»¥æ‰¹é‡åº”ç­”å¹¶ä¸”å‡å°‘ç½‘ç»œæ‹¥å µ</strong> </p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302011244918.png" alt="image-20230201124424828"></p><p>multiple çš„ true å’Œ false ä»£è¡¨ä¸åŒæ„æ€</p><ul><li><p><strong>true ä»£è¡¨æ‰¹é‡åº”ç­” channel ä¸Šæœªåº”ç­”çš„æ¶ˆæ¯</strong><br>æ¯”å¦‚è¯´ channel ä¸Šæœ‰ä¼ é€ tag çš„æ¶ˆæ¯ 5,6,7,8 å½“å‰ tag æ˜¯ 8 é‚£ä¹ˆæ­¤æ—¶ 5-8 çš„è¿™äº›è¿˜æœªåº”ç­”çš„æ¶ˆæ¯éƒ½ä¼šè¢«ç¡®è®¤æ”¶åˆ°æ¶ˆæ¯åº”ç­”</p></li><li><p>false åŒä¸Šé¢ç›¸æ¯”</p><p>åªä¼šåº”ç­” tag&#x3D;8 çš„æ¶ˆæ¯ 5,6,7 è¿™ä¸‰ä¸ªæ¶ˆæ¯ä¾ç„¶ä¸ä¼šè¢«ç¡®è®¤æ”¶åˆ°æ¶ˆæ¯åº”ç­”</p></li></ul><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302011246745.png" alt="image-20230201124615067"></p><h4 id="3-3-5æ¶ˆæ¯è‡ªåŠ¨é‡æ–°å…¥é˜Ÿ"><a href="#3-3-5æ¶ˆæ¯è‡ªåŠ¨é‡æ–°å…¥é˜Ÿ" class="headerlink" title="3.3.5æ¶ˆæ¯è‡ªåŠ¨é‡æ–°å…¥é˜Ÿ"></a>3.3.5æ¶ˆæ¯è‡ªåŠ¨é‡æ–°å…¥é˜Ÿ</h4><p>â€‹å¦‚æœæ¶ˆè´¹è€…ç”±äºæŸäº›åŸå› å¤±å»è¿æ¥(å…¶é€šé“å·²å…³é—­ï¼Œè¿æ¥å·²å…³é—­æˆ– TCP è¿æ¥ä¸¢å¤±)ï¼Œå¯¼è‡´æ¶ˆæ¯ æœªå‘é€ ACK ç¡®è®¤ï¼ŒRabbitMQ å°†äº†è§£åˆ°æ¶ˆæ¯æœªå®Œå…¨å¤„ç†ï¼Œå¹¶å°†å¯¹å…¶é‡æ–°æ’é˜Ÿã€‚å¦‚æœæ­¤æ—¶å…¶ä»–æ¶ˆè´¹è€…å¯ä»¥å¤„ç†ï¼Œå®ƒå°†å¾ˆå¿«å°†å…¶é‡æ–°åˆ†å‘ç»™å¦ä¸€ä¸ªæ¶ˆè´¹è€…ã€‚è¿™æ ·ï¼Œå³ä½¿æŸä¸ªæ¶ˆè´¹è€…å¶å°”æ­»äº¡ï¼Œä¹Ÿå¯ä»¥ç¡®ä¿ä¸ä¼šä¸¢å¤±ä»»ä½•æ¶ˆæ¯ã€‚</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302011249441.png" alt="image-20230201124936989"></p><h4 id="3-3-6æ¶ˆæ¯æ‰‹åŠ¨åº”ç­”ä»£ç "><a href="#3-3-6æ¶ˆæ¯æ‰‹åŠ¨åº”ç­”ä»£ç " class="headerlink" title="3.3.6æ¶ˆæ¯æ‰‹åŠ¨åº”ç­”ä»£ç "></a>3.3.6æ¶ˆæ¯æ‰‹åŠ¨åº”ç­”ä»£ç </h4><p>â€‹é»˜è®¤æ¶ˆæ¯é‡‡ç”¨çš„æ˜¯è‡ªåŠ¨åº”ç­”ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æƒ³å®ç°æ¶ˆæ¯æ¶ˆè´¹è¿‡ç¨‹ä¸­ä¸ä¸¢å¤±ï¼Œéœ€è¦æŠŠè‡ªåŠ¨åº”ç­”æ”¹ ä¸ºæ‰‹åŠ¨åº”ç­”ï¼Œæ¶ˆè´¹è€…åœ¨ä¸Šé¢ä»£ç çš„åŸºç¡€ä¸Šå¢åŠ ä¸‹é¢ç”»çº¢è‰²éƒ¨åˆ†ä»£ç ã€‚</p><p>WorkConsumer03.java</p><p>æ¶ˆè´¹ç”Ÿäº§è€… Task2.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æ¶ˆæ¯åœ¨æ‰‹åŠ¨åº”ç­”æ—¶æ˜¯ä¸ä¸¢å¤±ã€æ”¾å›é˜Ÿåˆ—ä¸­é‡æ–°æ¶ˆè´¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/1/15 21:22</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Task2</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TASK_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;ack_queue&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// å£°æ˜é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueDeclare(TASK_QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// åœ¨æ§åˆ¶å°è¾“å…¥ä¿¡æ¯</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="keyword">while</span>(scanner.hasNext())&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, TASK_QUEUE_NAME, <span class="literal">null</span>, message.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯ï¼š&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€… 01</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æ¶ˆæ¯åœ¨æ‰‹åŠ¨åº”ç­”æ—¶æ˜¯ä¸ä¸¢å¤±ã€æ”¾å›é˜Ÿåˆ—ä¸­é‡æ–°æ¶ˆè´¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/1 19:54</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WorkConsumer03</span> &#123;</span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TASK_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;ack_queue&quot;</span>;</span><br><span class="line">    <span class="comment">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        System.out.println(<span class="string">&quot;C1 ç­‰å¾…æ¥æ”¶æ¶ˆæ¯å¤„ç†æ—¶é—´è¾ƒçŸ­&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            <span class="comment">// æ²‰ç¡ä¸€ç§’</span></span><br><span class="line">            SleepUtils.sleep(<span class="number">1</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            <span class="comment">// æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * 1. æ¶ˆæ¯çš„æ ‡è®°</span></span><br><span class="line"><span class="comment">             * 2. æ˜¯å¦æ‰¹é‡åº”ç­” false:ä¸æ‰¹é‡åº”ç­”ä¿¡é“ä¸­çš„æ¶ˆæ¯ true: æ‰¹é‡</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicAck(message.getEnvelope().getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡‡ç”¨æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">autoAck</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        channel.basicConsume(TASK_QUEUE_NAME, autoAck, deliverCallback, (consumerTag -&gt; &#123;</span><br><span class="line">            System.out.println(consumerTag + <span class="string">&quot;æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆè´¹æ¥å£å›è°ƒé€»è¾‘&quot;</span>);</span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€… 02</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æ¶ˆæ¯åœ¨æ‰‹åŠ¨åº”ç­”æ—¶æ˜¯ä¸ä¸¢å¤±ã€æ”¾å›é˜Ÿåˆ—ä¸­é‡æ–°æ¶ˆè´¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/1 19:54</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WorkConsumer04</span> &#123;</span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TASK_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;ack_queue&quot;</span>;</span><br><span class="line">    <span class="comment">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        System.out.println(<span class="string">&quot;C2 ç­‰å¾…æ¥æ”¶æ¶ˆæ¯å¤„ç†æ—¶é—´è¾ƒé•¿&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            <span class="comment">// æ²‰ç¡ä¸€ç§’</span></span><br><span class="line">            SleepUtils.sleep(<span class="number">30</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            <span class="comment">// æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * 1. æ¶ˆæ¯çš„æ ‡è®°</span></span><br><span class="line"><span class="comment">             * 2. æ˜¯å¦æ‰¹é‡åº”ç­” false:ä¸æ‰¹é‡åº”ç­”ä¿¡é“ä¸­çš„æ¶ˆæ¯ true: æ‰¹é‡</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicAck(message.getEnvelope().getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡‡ç”¨æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">autoAck</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        channel.basicConsume(TASK_QUEUE_NAME, autoAck, deliverCallback, (consumerTag -&gt; &#123;</span><br><span class="line">            System.out.println(consumerTag + <span class="string">&quot;æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆè´¹æ¥å£å›è°ƒé€»è¾‘&quot;</span>);</span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¡çœ å·¥å…·ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SleepUtils</span> &#123;</span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ç¡çœ å·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Params</span>: [second]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Return</span> void</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 20:06 2023/2/1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sleep</span><span class="params">(<span class="type">int</span> second)</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">   Thread.sleep(<span class="number">1000</span> * second);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (InterruptedException _ignored) &#123;</span><br><span class="line">   Thread.currentThread().interrupt();</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-3-7æ‰‹åŠ¨åº”ç­”æ•ˆæœæ¼”ç¤º"><a href="#3-3-7æ‰‹åŠ¨åº”ç­”æ•ˆæœæ¼”ç¤º" class="headerlink" title="3.3.7æ‰‹åŠ¨åº”ç­”æ•ˆæœæ¼”ç¤º"></a>3.3.7æ‰‹åŠ¨åº”ç­”æ•ˆæœæ¼”ç¤º</h4><p>æ­£å¸¸æƒ…å†µä¸‹æ¶ˆæ¯å‘é€æ–¹å‘é€ä¸¤ä¸ªæ¶ˆæ¯ C1 å’Œ C2 åˆ†åˆ«æ¥æ”¶åˆ°æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†</p><p><img src="E:\java\Learn\æ¶ˆæ¯é˜Ÿåˆ—\å¢¨æ«æ¶ˆæ¯é˜Ÿåˆ—.assets\202302012217011.png" alt="image-20230201221717743"></p><p>åœ¨å‘é€è€…å‘é€æ¶ˆæ¯ ddï¼Œå‘å‡ºæ¶ˆæ¯ä¹‹åçš„æŠŠ C2 æ¶ˆè´¹è€…åœæ‰ï¼ŒæŒ‰ç†è¯´è¯¥ C2 æ¥å¤„ç†è¯¥æ¶ˆæ¯ï¼Œä½†æ˜¯ ç”±äºå®ƒå¤„ç†æ—¶é—´è¾ƒé•¿ï¼Œåœ¨è¿˜æœªå¤„ç†å®Œï¼Œä¹Ÿå°±æ˜¯è¯´ C2 è¿˜æ²¡æœ‰æ‰§è¡Œ ack ä»£ç çš„æ—¶å€™ï¼ŒC2 è¢«åœæ‰äº†ï¼Œ æ­¤æ—¶ä¼šçœ‹åˆ°æ¶ˆæ¯è¢« C1 æ¥æ”¶åˆ°äº†ï¼Œè¯´æ˜æ¶ˆæ¯ dd è¢«é‡æ–°å…¥é˜Ÿï¼Œç„¶ååˆ†é…ç»™èƒ½å¤„ç†æ¶ˆæ¯çš„ C1 å¤„ç†äº†</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302012218291.png" alt="image-20230201221845892"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302012219238.png" alt="image-20230201221859910"></p><h3 id="3-4RabbitMQ-æŒä¹…åŒ–"><a href="#3-4RabbitMQ-æŒä¹…åŒ–" class="headerlink" title="3.4RabbitMQ æŒä¹…åŒ–"></a>3.4RabbitMQ æŒä¹…åŒ–</h3><h4 id="3-4-1æ¦‚å¿µ"><a href="#3-4-1æ¦‚å¿µ" class="headerlink" title="3.4.1æ¦‚å¿µ"></a>3.4.1æ¦‚å¿µ</h4><p>â€‹åˆšåˆšæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¦‚ä½•å¤„ç†ä»»åŠ¡ä¸ä¸¢å¤±çš„æƒ…å†µï¼Œä½†æ˜¯å¦‚ä½•ä¿éšœå½“ RabbitMQ æœåŠ¡åœæ‰ä»¥åæ¶ˆæ¯ç”Ÿäº§è€…å‘é€è¿‡æ¥çš„æ¶ˆæ¯ä¸ä¸¢å¤±ã€‚é»˜è®¤æƒ…å†µä¸‹ RabbitMQ é€€å‡ºæˆ–ç”±äºæŸç§åŸå› å´©æºƒæ—¶ï¼Œå®ƒå¿½è§†é˜Ÿåˆ—å’Œæ¶ˆæ¯ï¼Œé™¤éå‘ŠçŸ¥å®ƒä¸è¦è¿™æ ·åšã€‚ç¡®ä¿æ¶ˆæ¯ä¸ä¼šä¸¢å¤±éœ€è¦åšä¸¤ä»¶äº‹ï¼š<strong>æˆ‘ä»¬éœ€è¦å°†é˜Ÿåˆ—å’Œæ¶ˆæ¯éƒ½æ ‡è®°ä¸ºæŒä¹…åŒ–ã€‚</strong></p><h4 id="3-4-2é˜Ÿåˆ—å¦‚ä½•å®ç°æŒä¹…åŒ–"><a href="#3-4-2é˜Ÿåˆ—å¦‚ä½•å®ç°æŒä¹…åŒ–" class="headerlink" title="3.4.2é˜Ÿåˆ—å¦‚ä½•å®ç°æŒä¹…åŒ–"></a>3.4.2é˜Ÿåˆ—å¦‚ä½•å®ç°æŒä¹…åŒ–</h4><p>â€‹ä¹‹å‰æˆ‘ä»¬åˆ›å»ºçš„é˜Ÿåˆ—éƒ½æ˜¯éæŒä¹…åŒ–çš„ï¼Œrabbitmq å¦‚æœé‡å¯çš„åŒ–ï¼Œè¯¥é˜Ÿåˆ—å°±ä¼šè¢«åˆ é™¤æ‰ï¼Œå¦‚æœ è¦é˜Ÿåˆ—å®ç°æŒä¹…åŒ– éœ€è¦åœ¨å£°æ˜é˜Ÿåˆ—çš„æ—¶å€™æŠŠ durable å‚æ•°è®¾ç½®ä¸ºæŒä¹…åŒ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®©æ¶ˆæ¯é˜Ÿåˆ—æŒä¹…åŒ–</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">durable</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">channel.queueDeclare(ACK_QUEUE_NAME, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br></pre></td></tr></table></figure><p>â€‹ä½†æ˜¯éœ€è¦æ³¨æ„çš„å°±æ˜¯å¦‚æœä¹‹å‰å£°æ˜çš„é˜Ÿåˆ—ä¸æ˜¯æŒä¹…åŒ–çš„ï¼Œéœ€è¦æŠŠ<strong>åŸå…ˆé˜Ÿåˆ—å…ˆåˆ é™¤ï¼Œæˆ–è€…é‡æ–°åˆ›å»ºä¸€ä¸ªæŒä¹…åŒ–çš„é˜Ÿåˆ—ï¼Œä¸ç„¶å°±ä¼šå‡ºç°é”™è¯¯</strong></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302021052636.png"></p><p>ä»¥ä¸‹ä¸ºæ§åˆ¶å°ä¸­æŒä¹…åŒ–ä¸éæŒä¹…åŒ–é˜Ÿåˆ—çš„ UI æ˜¾ç¤ºåŒº</p><p>Features æ˜¾ç¤º â€Dâ€œ è¡¨ç¤ºå·²ç»è¿›è¡ŒæŒä¹…åŒ–äº†ï¼ŒDurable é¦–å­—æ¯</p><p>æ˜¾ç¤º â€œAD Exclâ€ è¡¨ç¤ºä¸´æ—¶çš„</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302021054586.png" alt="image-20230202105412616"></p><p><strong>è¿™ä¸ªæ—¶å€™å³ä½¿é‡å¯ rabbitmq é˜Ÿåˆ—ä¹Ÿä¾ç„¶å­˜åœ¨</strong></p><h4 id="3-4-3æ¶ˆæ¯å®ç°æŒä¹…åŒ–"><a href="#3-4-3æ¶ˆæ¯å®ç°æŒä¹…åŒ–" class="headerlink" title="3.4.3æ¶ˆæ¯å®ç°æŒä¹…åŒ–"></a>3.4.3æ¶ˆæ¯å®ç°æŒä¹…åŒ–</h4><p>â€‹è¦æƒ³è®©æ¶ˆæ¯å®ç°æŒä¹…åŒ–éœ€è¦åœ¨æ¶ˆæ¯ç”Ÿäº§è€…ä¿®æ”¹ä»£ç ï¼ŒMessageProperties.PERSISTENT_TEXT_PLAIN æ·» åŠ è¿™ä¸ªå±æ€§ã€‚</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302021104433.png" alt="image-20230202110410839"></p><p>â€‹å°†æ¶ˆæ¯æ ‡è®°ä¸ºæŒä¹…åŒ–å¹¶ä¸èƒ½å®Œå…¨ä¿è¯ä¸ä¼šä¸¢å¤±æ¶ˆæ¯ã€‚å°½ç®¡å®ƒå‘Šè¯‰ RabbitMQ å°†æ¶ˆæ¯ä¿å­˜åˆ°ç£ç›˜ï¼Œä½†æ˜¯ è¿™é‡Œä¾ç„¶å­˜åœ¨å½“æ¶ˆæ¯åˆšå‡†å¤‡å­˜å‚¨åœ¨ç£ç›˜çš„æ—¶å€™ ä½†æ˜¯è¿˜æ²¡æœ‰å­˜å‚¨å®Œï¼Œæ¶ˆæ¯è¿˜åœ¨ç¼“å­˜çš„ä¸€ä¸ªé—´éš”ç‚¹ã€‚æ­¤æ—¶å¹¶æ²¡ æœ‰çœŸæ­£å†™å…¥ç£ç›˜ã€‚æŒä¹…æ€§ä¿è¯å¹¶ä¸å¼ºï¼Œä½†æ˜¯å¯¹äºæˆ‘ä»¬çš„ç®€å•ä»»åŠ¡é˜Ÿåˆ—è€Œè¨€ï¼Œè¿™å·²ç»ç»°ç»°æœ‰ä½™äº†ã€‚å¦‚æœéœ€è¦ æ›´å¼ºæœ‰åŠ›çš„æŒä¹…åŒ–ç­–ç•¥ï¼Œå‚è€ƒåè¾¹è¯¾ä»¶å‘å¸ƒç¡®è®¤ç« èŠ‚ã€‚</p><h4 id="3-4-4ä¸å…¬å¼€åˆ†å‘"><a href="#3-4-4ä¸å…¬å¼€åˆ†å‘" class="headerlink" title="3.4.4ä¸å…¬å¼€åˆ†å‘"></a>3.4.4ä¸å…¬å¼€åˆ†å‘</h4><p>â€‹åœ¨æœ€å¼€å§‹çš„æ—¶å€™æˆ‘ä»¬å­¦ä¹ åˆ° RabbitMQ åˆ†å‘æ¶ˆæ¯é‡‡ç”¨çš„è½®è®­åˆ†å‘ï¼Œä½†æ˜¯åœ¨æŸç§åœºæ™¯ä¸‹è¿™ç§ç­–ç•¥å¹¶ä¸æ˜¯ å¾ˆå¥½ï¼Œæ¯”æ–¹è¯´æœ‰ä¸¤ä¸ªæ¶ˆè´¹è€…åœ¨å¤„ç†ä»»åŠ¡ï¼Œå…¶ä¸­æœ‰ä¸ªæ¶ˆè´¹è€… 1 å¤„ç†ä»»åŠ¡çš„é€Ÿåº¦éå¸¸å¿«ï¼Œè€Œå¦å¤–ä¸€ä¸ªæ¶ˆè´¹è€… 2 å¤„ç†é€Ÿåº¦å´å¾ˆæ…¢ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¿˜æ˜¯é‡‡ç”¨è½®è®­åˆ†å‘çš„åŒ–å°±ä¼šåˆ°è¿™å¤„ç†é€Ÿåº¦å¿«çš„è¿™ä¸ªæ¶ˆè´¹è€…å¾ˆå¤§ä¸€éƒ¨åˆ†æ—¶é—´ å¤„äºç©ºé—²çŠ¶æ€ï¼Œè€Œå¤„ç†æ…¢çš„é‚£ä¸ªæ¶ˆè´¹è€…ä¸€ç›´åœ¨å¹²æ´»ï¼Œè¿™ç§åˆ†é…æ–¹å¼åœ¨è¿™ç§æƒ…å†µä¸‹å…¶å®å°±ä¸å¤ªå¥½ï¼Œä½†æ˜¯ RabbitMQ å¹¶ä¸çŸ¥é“è¿™ç§æƒ…å†µå®ƒä¾ç„¶å¾ˆå…¬å¹³çš„è¿›è¡Œåˆ†å‘ã€‚</p><p>ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¶ˆè´¹è€…ä¸­è®¾ç½®å‚æ•° channel.basicQos(1);</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// è®¾ç½®ä¸å…¬å¹³åˆ†å‘</span></span><br><span class="line"> <span class="type">int</span> <span class="variable">prefetchCount</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">channel.basicQos(prefetchCount);</span><br></pre></td></tr></table></figure><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302021114259.png" alt="image-20230202111414999"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302021116053.png" alt="image-20230202111647356"></p><p>â€‹æ„æ€å°±æ˜¯å¦‚æœè¿™ä¸ªä»»åŠ¡æˆ‘è¿˜æ²¡æœ‰å¤„ç†å®Œæˆ–è€…æˆ‘è¿˜æ²¡æœ‰åº”ç­”ä½ ï¼Œä½ å…ˆåˆ«åˆ†é…ç»™æˆ‘ï¼Œæˆ‘ç›®å‰åªèƒ½å¤„ç†ä¸€ä¸ª ä»»åŠ¡ï¼Œç„¶å rabbitmq å°±ä¼šæŠŠè¯¥ä»»åŠ¡åˆ†é…ç»™æ²¡æœ‰é‚£ä¹ˆå¿™çš„é‚£ä¸ªç©ºé—²æ¶ˆè´¹è€…ï¼Œå½“ç„¶å¦‚æœæ‰€æœ‰çš„æ¶ˆè´¹è€…éƒ½æ²¡æœ‰å®Œ æˆæ‰‹ä¸Šä»»åŠ¡ï¼Œé˜Ÿåˆ—è¿˜åœ¨ä¸åœçš„æ·»åŠ æ–°ä»»åŠ¡ï¼Œé˜Ÿåˆ—æœ‰å¯èƒ½å°±ä¼šé‡åˆ°é˜Ÿåˆ—è¢«æ’‘æ»¡çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™å°±åªèƒ½æ·»åŠ  æ–°çš„ worker æˆ–è€…æ”¹å˜å…¶ä»–å­˜å‚¨ä»»åŠ¡çš„ç­–ç•¥ã€‚</p><h4 id="3-4-5é¢„å–å€¼"><a href="#3-4-5é¢„å–å€¼" class="headerlink" title="3.4.5é¢„å–å€¼"></a>3.4.5é¢„å–å€¼</h4><p>æœ¬èº«æ¶ˆæ¯çš„å‘é€å°±æ˜¯å¼‚æ­¥å‘é€çš„ï¼Œæ‰€ä»¥åœ¨ä»»ä½•æ—¶å€™ï¼Œchannel ä¸Šè‚¯å®šä¸æ­¢åªæœ‰ä¸€ä¸ªæ¶ˆæ¯å¦å¤–æ¥è‡ªæ¶ˆè´¹<br>è€…çš„æ‰‹åŠ¨ç¡®è®¤æœ¬è´¨ä¸Šä¹Ÿæ˜¯å¼‚æ­¥çš„ã€‚å› æ­¤è¿™é‡Œå°±å­˜åœ¨ä¸€ä¸ªæœªç¡®è®¤çš„æ¶ˆæ¯ç¼“å†²åŒºï¼Œå› æ­¤å¸Œæœ›å¼€å‘äººå‘˜èƒ½<strong>é™åˆ¶æ­¤</strong><br><strong>ç¼“å†²åŒºçš„å¤§å°ï¼Œä»¥é¿å…ç¼“å†²åŒºé‡Œé¢æ— é™åˆ¶çš„æœªç¡®è®¤æ¶ˆæ¯é—®é¢˜ã€‚</strong>è¿™ä¸ªæ—¶å€™å°±å¯ä»¥é€šè¿‡ä½¿ç”¨ basic.qos æ–¹æ³•è®¾<br>ç½®â€œé¢„å–è®¡æ•°â€å€¼æ¥å®Œæˆçš„ã€‚<strong>è¯¥å€¼å®šä¹‰é€šé“ä¸Šå…è®¸çš„æœªç¡®è®¤æ¶ˆæ¯çš„æœ€å¤§æ•°é‡ã€‚</strong>ä¸€æ—¦æ•°é‡è¾¾åˆ°é…ç½®çš„æ•°é‡ï¼Œ<br>RabbitMQ å°†åœæ­¢åœ¨é€šé“ä¸Šä¼ é€’æ›´å¤šæ¶ˆæ¯ï¼Œé™¤éè‡³å°‘æœ‰ä¸€ä¸ªæœªå¤„ç†çš„æ¶ˆæ¯è¢«ç¡®è®¤ï¼Œä¾‹å¦‚ï¼Œå‡è®¾åœ¨é€šé“ä¸Šæœ‰<br>æœªç¡®è®¤çš„æ¶ˆæ¯ 5ã€6ã€7ï¼Œ8ï¼Œå¹¶ä¸”é€šé“çš„é¢„å–è®¡æ•°è®¾ç½®ä¸º 4ï¼Œæ­¤æ—¶ RabbitMQ å°†ä¸ä¼šåœ¨è¯¥é€šé“ä¸Šå†ä¼ é€’ä»»ä½•<br>æ¶ˆæ¯ï¼Œé™¤éè‡³å°‘æœ‰ä¸€ä¸ªæœªåº”ç­”çš„æ¶ˆæ¯è¢« ackã€‚æ¯”æ–¹è¯´ tag&#x3D;6 è¿™ä¸ªæ¶ˆæ¯åˆšåˆšè¢«ç¡®è®¤ ACKï¼ŒRabbitMQ å°†ä¼šæ„ŸçŸ¥<br>è¿™ä¸ªæƒ…å†µåˆ°å¹¶å†å‘é€ä¸€æ¡æ¶ˆæ¯ã€‚æ¶ˆæ¯åº”ç­”å’Œ QoS é¢„å–å€¼å¯¹ç”¨æˆ·ååé‡æœ‰é‡å¤§å½±å“ã€‚é€šå¸¸ï¼Œå¢åŠ é¢„å–å°†æé«˜<br>å‘æ¶ˆè´¹è€…ä¼ é€’æ¶ˆæ¯çš„é€Ÿåº¦<strong>ã€‚è™½ç„¶è‡ªåŠ¨åº”ç­”ä¼ è¾“æ¶ˆæ¯é€Ÿç‡æ˜¯æœ€ä½³çš„ï¼Œä½†æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å·²ä¼ é€’ä½†å°šæœªå¤„ç†</strong><br><strong>çš„æ¶ˆæ¯çš„æ•°é‡ä¹Ÿä¼šå¢åŠ ï¼Œä»è€Œå¢åŠ äº†æ¶ˆè´¹è€…çš„ RAM æ¶ˆè€—</strong>(éšæœºå­˜å–å­˜å‚¨å™¨)åº”è¯¥å°å¿ƒä½¿ç”¨å…·æœ‰æ— é™é¢„å¤„ç†<br>çš„è‡ªåŠ¨ç¡®è®¤æ¨¡å¼æˆ–æ‰‹åŠ¨ç¡®è®¤æ¨¡å¼ï¼Œæ¶ˆè´¹è€…æ¶ˆè´¹äº†å¤§é‡çš„æ¶ˆæ¯å¦‚æœæ²¡æœ‰ç¡®è®¤çš„è¯ï¼Œä¼šå¯¼è‡´æ¶ˆè´¹è€…è¿æ¥èŠ‚ç‚¹çš„<br>å†…å­˜æ¶ˆè€—å˜å¤§ï¼Œæ‰€ä»¥æ‰¾åˆ°åˆé€‚çš„é¢„å–å€¼æ˜¯ä¸€ä¸ªåå¤è¯•éªŒçš„è¿‡ç¨‹ï¼Œä¸åŒçš„è´Ÿè½½è¯¥å€¼å–å€¼ä¹Ÿä¸åŒ 100 åˆ° 300 èŒƒ<br>å›´å†…çš„å€¼é€šå¸¸å¯æä¾›æœ€ä½³çš„ååé‡ï¼Œå¹¶ä¸”ä¸ä¼šç»™æ¶ˆè´¹è€…å¸¦æ¥å¤ªå¤§çš„é£é™©ã€‚é¢„å–å€¼ä¸º 1 æ˜¯æœ€ä¿å®ˆçš„ã€‚å½“ç„¶è¿™<br>å°†ä½¿ååé‡å˜å¾—å¾ˆä½ï¼Œç‰¹åˆ«æ˜¯æ¶ˆè´¹è€…è¿æ¥å»¶è¿Ÿå¾ˆä¸¥é‡çš„æƒ…å†µä¸‹ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¶ˆè´¹è€…è¿æ¥ç­‰å¾…æ—¶é—´è¾ƒé•¿çš„ç¯å¢ƒ<br>ä¸­ã€‚å¯¹äºå¤§å¤šæ•°åº”ç”¨æ¥è¯´ï¼Œç¨å¾®é«˜ä¸€ç‚¹çš„å€¼å°†æ˜¯æœ€ä½³çš„ã€‚</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302021144460.png" alt="image-20230202114359020"></p><h2 id="4-å‘å¸ƒç¡®è®¤"><a href="#4-å‘å¸ƒç¡®è®¤" class="headerlink" title="4.å‘å¸ƒç¡®è®¤"></a>4.å‘å¸ƒç¡®è®¤</h2><h3 id="4-1å‘å¸ƒç¡®è®¤åŸç†"><a href="#4-1å‘å¸ƒç¡®è®¤åŸç†" class="headerlink" title="4.1å‘å¸ƒç¡®è®¤åŸç†"></a>4.1å‘å¸ƒç¡®è®¤åŸç†</h3><p>â€‹ç”Ÿäº§è€…å°†ä¿¡é“è®¾ç½®æˆ confirm æ¨¡å¼ï¼Œä¸€æ—¦ä¿¡é“è¿›å…¥ confirm æ¨¡å¼ï¼Œ**æ‰€æœ‰åœ¨è¯¥ä¿¡é“ä¸Šé¢å‘å¸ƒçš„æ¶ˆæ¯éƒ½å°†ä¼šè¢«æŒ‡æ´¾ä¸€ä¸ªå”¯ä¸€çš„ ID(ä» 1 å¼€å§‹)**ï¼Œä¸€æ—¦æ¶ˆæ¯è¢«æŠ•é€’åˆ°æ‰€æœ‰åŒ¹é…çš„é˜Ÿåˆ—ä¹‹åï¼Œbroker å°±ä¼šå‘é€ä¸€ä¸ªç¡®è®¤ç»™ç”Ÿäº§è€…(åŒ…å«æ¶ˆæ¯çš„å”¯ä¸€ ID)ï¼Œè¿™å°±ä½¿å¾—ç”Ÿäº§è€…çŸ¥é“æ¶ˆæ¯å·²ç»æ­£ç¡®åˆ°è¾¾ç›®çš„é˜Ÿ åˆ—äº†ï¼Œå¦‚æœæ¶ˆæ¯å’Œé˜Ÿåˆ—æ˜¯å¯æŒä¹…åŒ–çš„ï¼Œé‚£ä¹ˆç¡®è®¤æ¶ˆæ¯ä¼šåœ¨å°†æ¶ˆæ¯å†™å…¥ç£ç›˜ä¹‹åå‘å‡ºï¼Œbroker å›ä¼ ç»™ç”Ÿäº§è€…çš„ç¡®è®¤æ¶ˆæ¯ä¸­ delivery-tag åŸŸåŒ…å«äº†ç¡®è®¤æ¶ˆæ¯çš„åºåˆ—å·ï¼Œæ­¤å¤– broker ä¹Ÿå¯ä»¥è®¾ç½® basic.ack çš„ multiple åŸŸï¼Œè¡¨ç¤ºåˆ°è¿™ä¸ªåºåˆ—å·ä¹‹å‰çš„æ‰€æœ‰æ¶ˆæ¯éƒ½å·²ç»å¾—åˆ°äº†å¤„ç†ã€‚</p><p>â€‹confirm æ¨¡å¼æœ€å¤§çš„å¥½å¤„åœ¨äºä»–æ˜¯å¼‚æ­¥çš„ï¼Œä¸€æ—¦å‘å¸ƒä¸€æ¡æ¶ˆæ¯ï¼Œç”Ÿäº§è€…åº”ç”¨ç¨‹åºå°±å¯ä»¥åœ¨ç­‰ä¿¡é“è¿”å›ç¡®è®¤çš„åŒæ—¶ç»§ç»­å‘é€ä¸‹ä¸€æ¡æ¶ˆæ¯ï¼Œå½“æ¶ˆæ¯æœ€ç»ˆå¾—åˆ°ç¡®è®¤ä¹‹åï¼Œç”Ÿäº§è€…åº”ç”¨ä¾¿å¯ä»¥é€šè¿‡å›è°ƒæ–¹æ³•æ¥å¤„ç†è¯¥ç¡®è®¤æ¶ˆæ¯ï¼Œå¦‚æœ RabbitMQ å› ä¸ºè‡ªèº«å†…éƒ¨é”™è¯¯å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼Œå°±ä¼šå‘é€ä¸€æ¡ nack æ¶ˆ æ¯ï¼Œç”Ÿäº§è€…åº”ç”¨ç¨‹åºåŒæ ·å¯ä»¥åœ¨å›è°ƒæ–¹æ³•ä¸­å¤„ç†è¯¥ nack æ¶ˆæ¯</p><h3 id="4-2å‘å¸ƒç¡®è®¤ç­–ç•¥"><a href="#4-2å‘å¸ƒç¡®è®¤ç­–ç•¥" class="headerlink" title="4.2å‘å¸ƒç¡®è®¤ç­–ç•¥"></a>4.2å‘å¸ƒç¡®è®¤ç­–ç•¥</h3><h4 id="4-2-1å¼€å¯å‘å¸ƒç¡®è®¤çš„æ–¹æ³•"><a href="#4-2-1å¼€å¯å‘å¸ƒç¡®è®¤çš„æ–¹æ³•" class="headerlink" title="4.2.1å¼€å¯å‘å¸ƒç¡®è®¤çš„æ–¹æ³•"></a>4.2.1å¼€å¯å‘å¸ƒç¡®è®¤çš„æ–¹æ³•</h4><p>â€‹å‘å¸ƒç¡®è®¤é»˜è®¤æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼Œå¦‚æœè¦å¼€å¯éœ€è¦è°ƒç”¨æ–¹æ³• confirmSelectï¼Œæ¯å½“ä½ è¦æƒ³ä½¿ç”¨å‘å¸ƒ ç¡®è®¤ï¼Œéƒ½éœ€è¦åœ¨ channel ä¸Šè°ƒç”¨è¯¥æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel(); </span><br><span class="line"><span class="comment">// å¼€å¯å‘å¸ƒç¡®è®¤</span></span><br><span class="line">channel.confirmSelect();</span><br></pre></td></tr></table></figure><h4 id="4-2-2å•ä¸ªç¡®è®¤å‘å¸ƒ"><a href="#4-2-2å•ä¸ªç¡®è®¤å‘å¸ƒ" class="headerlink" title="4.2.2å•ä¸ªç¡®è®¤å‘å¸ƒ"></a>4.2.2å•ä¸ªç¡®è®¤å‘å¸ƒ</h4><p>â€‹è¿™æ˜¯ä¸€ç§ç®€å•çš„ç¡®è®¤æ–¹å¼ï¼Œå®ƒæ˜¯ä¸€ç§<strong>åŒæ­¥ç¡®è®¤å‘å¸ƒ</strong>çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯å‘å¸ƒä¸€ä¸ªæ¶ˆæ¯ä¹‹ååªæœ‰å®ƒ è¢«ç¡®è®¤å‘å¸ƒï¼Œåç»­çš„æ¶ˆæ¯æ‰èƒ½ç»§ç»­å‘å¸ƒ, waitForConfirmsOrDie(long) è¿™ä¸ªæ–¹æ³•åªæœ‰åœ¨æ¶ˆæ¯è¢«ç¡®è®¤ çš„æ—¶å€™æ‰è¿”å›ï¼Œå¦‚æœåœ¨æŒ‡å®šæ—¶é—´èŒƒå›´å†…è¿™ä¸ªæ¶ˆæ¯æ²¡æœ‰è¢«ç¡®è®¤é‚£ä¹ˆå®ƒå°†æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>â€‹è¿™ç§ç¡®è®¤æ–¹å¼æœ‰ä¸€ä¸ªæœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯:<strong>å‘å¸ƒé€Ÿåº¦ç‰¹åˆ«çš„æ…¢</strong>ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰ç¡®è®¤å‘å¸ƒçš„æ¶ˆæ¯å°±ä¼š é˜»å¡æ‰€æœ‰åç»­æ¶ˆæ¯çš„å‘å¸ƒï¼Œ<strong>è¿™ç§æ–¹å¼æœ€å¤šæä¾›æ¯ç§’ä¸è¶…è¿‡æ•°ç™¾æ¡å‘å¸ƒæ¶ˆæ¯çš„ååé‡</strong>ã€‚å½“ç„¶å¯¹äºæŸ äº›åº”ç”¨ç¨‹åºæ¥è¯´è¿™å¯èƒ½å·²ç»è¶³å¤Ÿäº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">SinglePublishMessage</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// é˜Ÿåˆ—çš„å£°æ˜</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line">        channel.queueDeclare(queueName, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// å¼€å¯å‘å¸ƒç¡®è®¤</span></span><br><span class="line">        channel.confirmSelect();</span><br><span class="line">        <span class="comment">// å¼€å§‹æ—¶é—´</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">beginTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">// æ‰¹é‡å‘æ¶ˆæ¯</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; MESSAGE_COUNT; i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> i + <span class="string">&quot;&quot;</span>;</span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, queueName, <span class="literal">null</span>, message.getBytes());</span><br><span class="line">            <span class="comment">// å•ä¸ªæ¶ˆæ¯å°±é©¬ä¸Šè¿›è¡Œå‘å¸ƒç¡®è®¤</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> channel.waitForConfirms();</span><br><span class="line">            <span class="keyword">if</span>(flag)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€æˆåŠŸï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç»“æŸæ—¶é—´</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;å‘å¸ƒ&quot;</span> + MESSAGE_COUNT + <span class="string">&quot;ä¸ªå•ç‹¬ç¡®è®¤æ¶ˆæ¯ï¼Œè€—æ—¶&quot;</span> + (endTime - beginTime) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="4-2-3æ‰¹é‡å‘å¸ƒç¡®è®¤"><a href="#4-2-3æ‰¹é‡å‘å¸ƒç¡®è®¤" class="headerlink" title="4.2.3æ‰¹é‡å‘å¸ƒç¡®è®¤"></a>4.2.3æ‰¹é‡å‘å¸ƒç¡®è®¤</h4><p>â€‹ä¸Šé¢é‚£ç§æ–¹å¼éå¸¸æ…¢ï¼Œä¸å•ä¸ªç­‰å¾…ç¡®è®¤æ¶ˆæ¯ç›¸æ¯”ï¼Œå…ˆå‘å¸ƒä¸€æ‰¹æ¶ˆæ¯ç„¶åä¸€èµ·ç¡®è®¤å¯ä»¥æå¤§åœ°æé«˜ååé‡ï¼Œå½“ç„¶è¿™ç§æ–¹å¼çš„ç¼ºç‚¹å°±æ˜¯:<strong>å½“å‘ç”Ÿæ•…éšœå¯¼è‡´å‘å¸ƒå‡ºç°é—®é¢˜æ—¶ï¼Œä¸çŸ¥é“æ˜¯å“ªä¸ªæ¶ˆæ¯å‡ºç° é—®é¢˜äº†ï¼Œæˆ‘ä»¬å¿…é¡»å°†æ•´ä¸ªæ‰¹å¤„ç†ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä»¥è®°å½•é‡è¦çš„ä¿¡æ¯è€Œåé‡æ–°å‘å¸ƒæ¶ˆæ¯ã€‚</strong>å½“ç„¶è¿™ç§ æ–¹æ¡ˆä»ç„¶æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿä¸€æ ·é˜»å¡æ¶ˆæ¯çš„å‘å¸ƒã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">BatchPublishMessage</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// é˜Ÿåˆ—çš„å£°æ˜</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line">        channel.queueDeclare(queueName, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// å¼€å¯å‘å¸ƒç¡®è®¤</span></span><br><span class="line">        channel.confirmSelect();</span><br><span class="line">        <span class="comment">// å¼€å§‹æ—¶é—´</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">beginTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">// æ‰¹é‡ç¡®è®¤å¤§å°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">batchSize</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">        <span class="comment">// æ‰¹é‡å‘æ¶ˆæ¯ æ‰¹é‡å‘å¸ƒç¡®è®¤</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; MESSAGE_COUNT; i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> i + <span class="string">&quot;&quot;</span>;</span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, queueName, <span class="literal">null</span>, message.getBytes());</span><br><span class="line">            <span class="comment">// åˆ¤æ–­è¾¾åˆ° 100 æ¡æ¶ˆæ¯çš„æ—¶å€™ï¼Œæ‰¹é‡ç¡®è®¤ä¸€æ¬¡</span></span><br><span class="line">            <span class="keyword">if</span>((i + <span class="number">1</span>) % batchSize == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">// å‘å¸ƒç¡®è®¤</span></span><br><span class="line">                channel.waitForConfirms();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç»“æŸæ—¶é—´</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;å‘å¸ƒ&quot;</span> + MESSAGE_COUNT + <span class="string">&quot;ä¸ªæ‰¹é‡ç¡®è®¤æ¶ˆæ¯ï¼Œè€—æ—¶&quot;</span> + (endTime - beginTime) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="4-2-4å¦‚ä½•å¤„ç†å¼‚æ­¥æœªç¡®è®¤çš„æ¶ˆæ¯"><a href="#4-2-4å¦‚ä½•å¤„ç†å¼‚æ­¥æœªç¡®è®¤çš„æ¶ˆæ¯" class="headerlink" title="4.2.4å¦‚ä½•å¤„ç†å¼‚æ­¥æœªç¡®è®¤çš„æ¶ˆæ¯"></a>4.2.4å¦‚ä½•å¤„ç†å¼‚æ­¥æœªç¡®è®¤çš„æ¶ˆæ¯</h4><p>â€‹æœ€å¥½çš„è§£å†³çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯æŠŠæœªç¡®è®¤çš„æ¶ˆæ¯æ”¾åˆ°ä¸€ä¸ªåŸºäºå†…å­˜çš„èƒ½è¢«å‘å¸ƒçº¿ç¨‹è®¿é—®çš„é˜Ÿåˆ—ï¼Œ æ¯”å¦‚è¯´ç”¨ ConcurrentLinkedQueue è¿™ä¸ªé˜Ÿåˆ—åœ¨ confirm callbacks ä¸å‘å¸ƒçº¿ç¨‹ä¹‹é—´è¿›è¡Œæ¶ˆæ¯çš„ä¼  é€’ã€‚</p><h4 id="4-2-5-ConcurrentSkipListMap"><a href="#4-2-5-ConcurrentSkipListMap" class="headerlink" title="4.2.5 ConcurrentSkipListMap"></a>4.2.5 ConcurrentSkipListMap</h4><p>ConcurrentSkipListMap æ˜¯çº¿ç¨‹å®‰å…¨çš„æœ‰åºçš„å“ˆå¸Œè¡¨ï¼Œé€‚ç”¨äºé«˜å¹¶å‘çš„åœºæ™¯ã€‚<br>ConcurrentSkipListMap å’ŒT reeMapï¼Œå®ƒä»¬è™½ç„¶éƒ½æ˜¯æœ‰åºçš„å“ˆå¸Œè¡¨ã€‚</p><ul><li>ç¬¬ä¸€ï¼Œå®ƒä»¬çš„çº¿ç¨‹å®‰å…¨æœºåˆ¶ä¸åŒï¼ŒTreeMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œ ConcurrentSkipListMap æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li><li>ç¬¬äºŒï¼ŒConcurrentSkipListMap æ˜¯é€šè¿‡è·³è¡¨å®ç°çš„ï¼Œè€ŒTreeMapæ˜¯é€šè¿‡çº¢é»‘æ ‘å®ç°çš„ã€‚</li></ul><p>åœ¨4çº¿ç¨‹1.6ä¸‡æ•°æ®çš„æ¡ä»¶ä¸‹ï¼ŒConcurrentHashMap å­˜å–é€Ÿåº¦æ˜¯ConcurrentSkipListMap çš„4å€å·¦å³ã€‚</p><p>ä½†ConcurrentSkipListMapæœ‰å‡ ä¸ªConcurrentHashMap ä¸èƒ½æ¯”æ‹Ÿçš„ä¼˜ç‚¹ï¼š</p><ol><li>ConcurrentSkipListMap çš„keyæ˜¯æœ‰åºçš„ã€‚</li><li>ConcurrentSkipListMap æ”¯æŒæ›´é«˜çš„å¹¶å‘ã€‚<br>ConcurrentSkipListMap çš„å­˜å–æ—¶é—´æ˜¯logï¼ˆNï¼‰ï¼Œå’Œçº¿ç¨‹æ•°å‡ ä¹æ— å…³ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨æ•°æ®é‡ä¸€å®šçš„æƒ…å†µä¸‹ï¼Œå¹¶å‘çš„çº¿ç¨‹è¶Šå¤šï¼ŒConcurrentSkipListMapè¶Šèƒ½ä½“ç°å‡ºä»–çš„ä¼˜åŠ¿ã€‚</li></ol><p>åœ¨éå¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œåº”å½“å°½é‡ä½¿ç”¨ TreeMapã€‚æ­¤å¤–å¯¹äºå¹¶å‘æ€§ç›¸å¯¹è¾ƒä½çš„å¹¶è¡Œç¨‹åºå¯ä»¥ä½¿ç”¨Collections.synchronizedSortedMap å°† TreeMap è¿›è¡ŒåŒ…è£…ï¼Œä¹Ÿå¯ä»¥æä¾›è¾ƒå¥½çš„æ•ˆç‡ã€‚å¯¹äºé«˜å¹¶å‘ç¨‹åºï¼Œåº”å½“ä½¿ç”¨ ConcurrentSkipListMapï¼Œèƒ½å¤Ÿæä¾›æ›´é«˜çš„å¹¶å‘åº¦ã€‚<br>æ‰€ä»¥åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­ï¼Œå¦‚æœéœ€è¦å¯¹Mapçš„é”®å€¼è¿›è¡Œæ’åºæ—¶ï¼Œè¯·å°½é‡ä½¿ç”¨ ConcurrentSkipListMapï¼Œå¯èƒ½å¾—åˆ°æ›´å¥½çš„å¹¶å‘åº¦ã€‚<br>æ³¨æ„ï¼Œè°ƒç”¨ ConcurrentSkipListMap çš„ size æ—¶ï¼Œç”±äºå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶å¯¹æ˜ å°„è¡¨è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥æ˜ å°„è¡¨éœ€è¦éå†æ•´ä¸ªé“¾è¡¨æ‰èƒ½è¿”å›å…ƒç´ ä¸ªæ•°ï¼Œè¿™ä¸ªæ“ä½œæ˜¯ä¸ª O(log(n)) çš„æ“ä½œã€‚</p><h4 id="4-2-6å¼‚æ­¥ç¡®è®¤å‘å¸ƒ"><a href="#4-2-6å¼‚æ­¥ç¡®è®¤å‘å¸ƒ" class="headerlink" title="4.2.6å¼‚æ­¥ç¡®è®¤å‘å¸ƒ"></a>4.2.6å¼‚æ­¥ç¡®è®¤å‘å¸ƒ</h4><p>â€‹å¼‚æ­¥ç¡®è®¤è™½ç„¶ç¼–ç¨‹é€»è¾‘æ¯”ä¸Šä¸¤ä¸ªè¦å¤æ‚ï¼Œä½†æ˜¯æ€§ä»·æ¯”æœ€é«˜ï¼Œæ— è®ºæ˜¯å¯é æ€§è¿˜æ˜¯æ•ˆç‡éƒ½æ²¡å¾—è¯´ï¼Œ ä»–æ˜¯åˆ©ç”¨å›è°ƒå‡½æ•°æ¥è¾¾åˆ°æ¶ˆæ¯å¯é æ€§ä¼ é€’çš„ï¼Œè¿™ä¸ªä¸­é—´ä»¶ä¹Ÿæ˜¯é€šè¿‡å‡½æ•°å›è°ƒæ¥ä¿è¯æ˜¯å¦æŠ•é€’æˆåŠŸï¼Œ ä¸‹é¢å°±è®©æˆ‘ä»¬æ¥è¯¦ç»†è®²è§£å¼‚æ­¥ç¡®è®¤æ˜¯æ€ä¹ˆå®ç°çš„ã€‚</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302031021754.png" alt="image-20230203102145627"></p><p>å¼‚æ­¥ç¡®è®¤å®ç°å…·ä½“ä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">AsyncPublishMessage</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// é˜Ÿåˆ—çš„å£°æ˜</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line">        channel.queueDeclare(queueName, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// å¼€å¯å‘å¸ƒç¡®è®¤</span></span><br><span class="line">        channel.confirmSelect();</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * çº¿ç¨‹å®‰å…¨çš„æœ‰åºçš„å“ˆå¸Œè¡¨</span></span><br><span class="line"><span class="comment">         * 1. è½»æ¾çš„å°†åºå·ä¸æ¶ˆæ¯è¿›è¡Œå…³è”</span></span><br><span class="line"><span class="comment">         * 2. è½»æ¾åœ°æ‰¹é‡åˆ é™¤æ¡ç›® åªè¦ç»™åˆ°åºå·</span></span><br><span class="line"><span class="comment">         * 3. æ”¯æŒé«˜å¹¶å‘ ï¼ˆå¤šçº¿ç¨‹ï¼‰</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        ConcurrentSkipListMap&lt;Long, String&gt; outstandingConfirms = <span class="keyword">new</span> <span class="title class_">ConcurrentSkipListMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// å¼€å§‹æ—¶é—´</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">beginTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">// æ¶ˆæ¯ç¡®è®¤æˆåŠŸ å›è°ƒå‡½æ•°</span></span><br><span class="line">        <span class="type">ConfirmCallback</span> <span class="variable">ackCallback</span> <span class="operator">=</span> (deliveryTag, multiple) -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span>(multiple)&#123;</span><br><span class="line">                <span class="comment">// 2ã€åˆ é™¤å·²ç»ç¡®è®¤çš„æ¶ˆæ¯ å‰©ä¸‹çš„å°±æ˜¯æœªç¡®è®¤çš„æ¶ˆæ¯</span></span><br><span class="line">                ConcurrentNavigableMap&lt;Long, String&gt; confirms = outstandingConfirms.headMap(deliveryTag);</span><br><span class="line">                confirms.clear();</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                outstandingConfirms.remove(deliveryTag);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç¡®è®¤çš„æ¶ˆæ¯&quot;</span> + deliveryTag);</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// æ¶ˆæ¯ç¡®è®¤å¤±è´¥ å›è°ƒå‡½æ•° å‚æ•°1ï¼šæ¶ˆæ¯çš„æ ‡è®° å‚æ•°2ï¼šæ˜¯å¦ä¸ºæ‰¹é‡ç¡®è®¤</span></span><br><span class="line">        <span class="type">ConfirmCallback</span> <span class="variable">nackCallback</span> <span class="operator">=</span> (deliveryTag, multiple) -&gt; &#123;</span><br><span class="line">            <span class="comment">// 3ã€æ‰“å°æœªç¡®è®¤çš„æ¶ˆæ¯</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> outstandingConfirms.get(deliveryTag);</span><br><span class="line">            System.out.println(<span class="string">&quot;æœªç¡®è®¤çš„æ¶ˆæ¯æ—¶ï¼š&quot;</span> + message + <span class="string">&quot;æœªç¡®è®¤çš„æ¶ˆæ¯ tag: &quot;</span> + deliveryTag);</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// å‡†å¤‡æ¶ˆæ¯çš„ç›‘å¬å™¨ ç›‘å¬æ¶ˆæ¯çš„å‘é€çŠ¶æ€ å¼‚æ­¥é€šçŸ¥</span></span><br><span class="line">        channel.addConfirmListener(ackCallback, nackCallback);</span><br><span class="line">        <span class="comment">// æ‰¹é‡å‘æ¶ˆæ¯</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; MESSAGE_COUNT; i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;æ¶ˆæ¯&quot;</span> + i;</span><br><span class="line">            channel.basicPublish(<span class="string">&quot;&quot;</span>, queueName, <span class="literal">null</span>, message.getBytes());</span><br><span class="line">            <span class="comment">// 1ã€æ­¤å¤„è®°å½•ä¸‹æ‰€æœ‰å‘é€çš„æ¶ˆæ¯ æ¶ˆæ¯çš„æ€»å’Œ</span></span><br><span class="line">            outstandingConfirms.put(channel.getNextPublishSeqNo(), message);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç»“æŸæ—¶é—´</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;å‘å¸ƒ&quot;</span> + MESSAGE_COUNT + <span class="string">&quot;ä¸ªå¼‚æ­¥å‘å¸ƒç¡®è®¤æ¶ˆæ¯ï¼Œè€—æ—¶&quot;</span> + (endTime - beginTime) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="4-2-7å•ä¸ªã€æ‰¹é‡ã€å¼‚æ­¥æ‰¹é‡ç¡®è®¤å‘å¸ƒé€Ÿåº¦å¯¹æ¯”"><a href="#4-2-7å•ä¸ªã€æ‰¹é‡ã€å¼‚æ­¥æ‰¹é‡ç¡®è®¤å‘å¸ƒé€Ÿåº¦å¯¹æ¯”" class="headerlink" title="4.2.7å•ä¸ªã€æ‰¹é‡ã€å¼‚æ­¥æ‰¹é‡ç¡®è®¤å‘å¸ƒé€Ÿåº¦å¯¹æ¯”"></a>4.2.7å•ä¸ªã€æ‰¹é‡ã€å¼‚æ­¥æ‰¹é‡ç¡®è®¤å‘å¸ƒé€Ÿåº¦å¯¹æ¯”</h4><ul><li><strong>å•ç‹¬å‘å¸ƒæ¶ˆæ¯</strong><br>åŒæ­¥ç­‰å¾…ç¡®è®¤ï¼Œç®€å•ï¼Œä½†ååé‡éå¸¸æœ‰é™ã€‚ </li><li><strong>æ‰¹é‡å‘å¸ƒæ¶ˆæ¯</strong><br>æ‰¹é‡åŒæ­¥ç­‰å¾…ç¡®è®¤ï¼Œç®€å•ï¼Œåˆç†çš„ååé‡ï¼Œä¸€æ—¦å‡ºç°é—®é¢˜ä½†å¾ˆéš¾æ¨æ–­å‡ºæ˜¯é‚£æ¡ æ¶ˆæ¯å‡ºç°äº†é—®é¢˜ã€‚ </li><li><strong>å¼‚æ­¥å¤„ç†</strong><br>æœ€ä½³æ€§èƒ½å’Œèµ„æºä½¿ç”¨ï¼Œåœ¨å‡ºç°é”™è¯¯çš„æƒ…å†µä¸‹å¯ä»¥å¾ˆå¥½åœ°æ§åˆ¶ï¼Œä½†æ˜¯å®ç°èµ·æ¥ç¨å¾®éš¾äº›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 1. å•ä¸ªç¡®è®¤ å‘å¸ƒ1000ä¸ªå•ç‹¬ç¡®è®¤æ¶ˆæ¯ï¼Œè€—æ—¶58713ms</span></span><br><span class="line">        <span class="comment">//SinglePublishMessage();</span></span><br><span class="line">        <span class="comment">// 2. æ‰¹é‡ç¡®è®¤ å‘å¸ƒ1000ä¸ªæ‰¹é‡ç¡®è®¤æ¶ˆæ¯ï¼Œè€—æ—¶303ms</span></span><br><span class="line">        <span class="comment">//BatchPublishMessage();</span></span><br><span class="line">        <span class="comment">// 3. å¼‚æ­¥æ‰¹é‡ç¡®è®¤ å‘å¸ƒ1000ä¸ªå¼‚æ­¥å‘å¸ƒç¡®è®¤æ¶ˆæ¯ï¼Œè€—æ—¶123ms</span></span><br><span class="line">        AsyncPublishMessage();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="5-äº¤æ¢æœº"><a href="#5-äº¤æ¢æœº" class="headerlink" title="5.äº¤æ¢æœº"></a>5.äº¤æ¢æœº</h2><p>â€‹åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå·¥ä½œé˜Ÿåˆ—ã€‚æˆ‘ä»¬å‡è®¾çš„æ˜¯å·¥ä½œé˜Ÿåˆ—èƒŒåï¼Œæ¯ä¸ªä»»åŠ¡éƒ½æ°å¥½äº¤ä»˜ç»™ä¸€ä¸ªæ¶ˆ è´¹è€…(å·¥ä½œè¿›ç¨‹)ã€‚åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†åšä¸€äº›å®Œå…¨ä¸åŒçš„äº‹æƒ…-æˆ‘ä»¬å°†æ¶ˆæ¯ä¼ è¾¾ç»™å¤šä¸ªæ¶ˆè´¹è€…ã€‚è¿™ç§æ¨¡å¼ ç§°ä¸º â€å‘å¸ƒ&#x2F;è®¢é˜…â€.</p><p>â€‹ä¸ºäº†è¯´æ˜è¿™ç§æ¨¡å¼ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªç®€å•çš„æ—¥å¿—ç³»ç»Ÿã€‚å®ƒå°†ç”±ä¸¤ä¸ªç¨‹åºç»„æˆ:ç¬¬ä¸€ä¸ªç¨‹åºå°†å‘å‡ºæ—¥å¿—æ¶ˆ æ¯ï¼Œç¬¬äºŒä¸ªç¨‹åºæ˜¯æ¶ˆè´¹è€…ã€‚å…¶ä¸­æˆ‘ä»¬ä¼šå¯åŠ¨ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼Œå…¶ä¸­ä¸€ä¸ªæ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯åæŠŠæ—¥å¿—å­˜å‚¨åœ¨ç£ç›˜ï¼Œ å¦å¤–ä¸€ä¸ªæ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯åæŠŠæ¶ˆæ¯æ‰“å°åœ¨å±å¹•ä¸Šï¼Œäº‹å®ä¸Šç¬¬ä¸€ä¸ªç¨‹åºå‘å‡ºçš„æ—¥å¿—æ¶ˆæ¯å°†å¹¿æ’­ç»™æ‰€æœ‰æ¶ˆè´¹ è€…è€…</p><h3 id="5-1Exchange"><a href="#5-1Exchange" class="headerlink" title="5.1Exchange"></a>5.1Exchange</h3><h4 id="5-1-1Exhcange-æ¦‚å¿µ"><a href="#5-1-1Exhcange-æ¦‚å¿µ" class="headerlink" title="5.1.1Exhcange æ¦‚å¿µ"></a>5.1.1Exhcange æ¦‚å¿µ</h4><p>â€‹RabbitMQ æ¶ˆæ¯ä¼ é€’æ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³æ˜¯: <strong>ç”Ÿäº§è€…ç”Ÿäº§çš„æ¶ˆæ¯ä»ä¸ä¼šç›´æ¥å‘é€åˆ°é˜Ÿåˆ—ã€‚</strong>å®é™…ä¸Šï¼Œé€šå¸¸ç”Ÿäº§ è€…ç”šè‡³éƒ½ä¸çŸ¥é“è¿™äº›æ¶ˆæ¯ä¼ é€’ä¼ é€’åˆ°äº†å“ªäº›é˜Ÿåˆ—ä¸­ã€‚</p><p>â€‹ç›¸åï¼Œ**ç”Ÿäº§è€…åªèƒ½å°†æ¶ˆæ¯å‘é€åˆ°äº¤æ¢æœº(exchange)**ï¼Œäº¤æ¢æœºå·¥ä½œçš„å†…å®¹éå¸¸ç®€å•ï¼Œä¸€æ–¹é¢å®ƒæ¥æ”¶æ¥è‡ªç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œå¦ä¸€æ–¹é¢å°†å®ƒä»¬æ¨å…¥é˜Ÿåˆ—ã€‚äº¤æ¢æœºå¿…é¡»ç¡®åˆ‡çŸ¥é“å¦‚ä½•å¤„ç†æ”¶åˆ°çš„æ¶ˆæ¯ã€‚æ˜¯åº”è¯¥æŠŠè¿™äº›æ¶ˆ æ¯æ”¾åˆ°ç‰¹å®šé˜Ÿåˆ—è¿˜æ˜¯è¯´æŠŠä»–ä»¬åˆ°è®¸å¤šé˜Ÿåˆ—ä¸­è¿˜æ˜¯è¯´åº”è¯¥ä¸¢å¼ƒå®ƒä»¬ã€‚è¿™å°±çš„ç”±äº¤æ¢æœºçš„ç±»å‹æ¥å†³å®šã€‚</p><h4 id="5-1-2Exchange-çš„ç±»å‹"><a href="#5-1-2Exchange-çš„ç±»å‹" class="headerlink" title="5.1.2Exchange çš„ç±»å‹"></a>5.1.2Exchange çš„ç±»å‹</h4><p>ä¸€å…±æœ‰å››ç§ç±»å‹ï¼š</p><ul><li>æ‰‡å‡ºï¼ˆfanout)</li><li>ç›´æ¥ï¼ˆdirect)</li><li>ä¸»é¢˜ï¼ˆtopic)</li><li>æ ‡é¢˜ï¼ˆheaders)</li></ul><h4 id="5-1-3æ— å-Exchange"><a href="#5-1-3æ— å-Exchange" class="headerlink" title="5.1.3æ— å Exchange"></a>5.1.3æ— å Exchange</h4><p>â€‹åœ¨æœ¬æ•™ç¨‹çš„å‰é¢éƒ¨åˆ†æˆ‘ä»¬å¯¹ exchange ä¸€æ— æ‰€çŸ¥ï¼Œä½†ä»ç„¶èƒ½å¤Ÿå°†æ¶ˆæ¯å‘é€åˆ°é˜Ÿåˆ—ã€‚ä¹‹å‰èƒ½å®ç°çš„ åŸå› æ˜¯å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯é»˜è®¤äº¤æ¢ï¼Œæˆ‘ä»¬é€šè¿‡ç©ºå­—ç¬¦ä¸²(â€œâ€)è¿›è¡Œæ ‡è¯†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">channel.basicPublish(<span class="string">&quot;&quot;</span>, <span class="string">&quot;hello&quot;</span>, <span class="literal">null</span>, message.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br></pre></td></tr></table></figure><p>â€‹ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äº¤æ¢æœºçš„åç§°ã€‚ç©ºå­—ç¬¦ä¸²è¡¨ç¤ºé»˜è®¤æˆ–æ— åç§°äº¤æ¢æœºï¼šæ¶ˆæ¯èƒ½è·¯ç”±å‘é€åˆ°é˜Ÿåˆ—ä¸­å…¶å® æ˜¯ç”± routingKey(bindingkey) ç»‘å®š key æŒ‡å®šçš„ï¼Œå¦‚æœå®ƒå­˜åœ¨çš„è¯</p><h3 id="5-2ä¸´æ—¶é˜Ÿåˆ—"><a href="#5-2ä¸´æ—¶é˜Ÿåˆ—" class="headerlink" title="5.2ä¸´æ—¶é˜Ÿåˆ—"></a>5.2ä¸´æ—¶é˜Ÿåˆ—</h3><p>â€‹ä¹‹å‰çš„ç« èŠ‚æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å…·æœ‰ç‰¹å®šåç§°çš„é˜Ÿåˆ—(è¿˜è®°å¾— hello å’Œ ack_queue å—ï¼Ÿ)ã€‚é˜Ÿåˆ—çš„åç§°æˆ‘ä»¬ æ¥è¯´è‡³å…³é‡è¦-æˆ‘ä»¬éœ€è¦æŒ‡å®šæˆ‘ä»¬çš„æ¶ˆè´¹è€…å»æ¶ˆè´¹å“ªä¸ªé˜Ÿåˆ—çš„æ¶ˆæ¯ã€‚</p><p>â€‹æ¯å½“æˆ‘ä»¬è¿æ¥åˆ° Rabbit æ—¶ï¼Œæˆ‘ä»¬éƒ½éœ€è¦ä¸€ä¸ªå…¨æ–°çš„ç©ºé˜Ÿåˆ—ï¼Œä¸ºæ­¤æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª<strong>å…·æœ‰éšæœºåç§°çš„é˜Ÿåˆ—</strong>ï¼Œæˆ–è€…èƒ½è®©æœåŠ¡å™¨ä¸ºæˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªéšæœºé˜Ÿåˆ—åç§°é‚£å°±æ›´å¥½äº†ã€‚å…¶æ¬¡<strong>ä¸€æ—¦æˆ‘ä»¬æ–­å¼€äº†æ¶ˆè´¹è€…çš„è¿æ¥ï¼Œé˜Ÿåˆ—å°†è¢«è‡ªåŠ¨åˆ é™¤ã€‚</strong></p><p>åˆ›å»ºä¸´æ—¶é˜Ÿåˆ—çš„æ–¹å¼å¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> channel.queueDeclare().getQueue();</span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061443690.png" alt="image-20230206144301384"></p><h3 id="5-3ç»‘å®šï¼ˆbindingsï¼‰"><a href="#5-3ç»‘å®šï¼ˆbindingsï¼‰" class="headerlink" title="5.3ç»‘å®šï¼ˆbindingsï¼‰"></a>5.3ç»‘å®šï¼ˆbindingsï¼‰</h3><p>â€‹ä»€ä¹ˆæ˜¯ bingding å‘¢ï¼Œbinding å…¶å®æ˜¯ exchange å’Œ queue ä¹‹é—´çš„æ¡¥æ¢ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬ exchange å’Œé‚£ä¸ªé˜Ÿ åˆ—è¿›è¡Œäº†ç»‘å®šå…³ç³»ã€‚æ¯”å¦‚è¯´ä¸‹é¢è¿™å¼ å›¾å‘Šè¯‰æˆ‘ä»¬çš„å°±æ˜¯ X ä¸ Q1 å’Œ Q2 è¿›è¡Œäº†ç»‘å®š</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061443553.png" alt="image-20230206144353313"></p><h3 id="5-4Fanout"><a href="#5-4Fanout" class="headerlink" title="5.4Fanout"></a>5.4Fanout</h3><h4 id="5-4-1Fanout-ä»‹ç»"><a href="#5-4-1Fanout-ä»‹ç»" class="headerlink" title="5.4.1Fanout ä»‹ç»"></a>5.4.1Fanout ä»‹ç»</h4><p>â€‹Fanout è¿™ç§ç±»å‹éå¸¸ç®€å•ã€‚æ­£å¦‚ä»åç§°ä¸­çŒœåˆ°çš„é‚£æ ·ï¼Œå®ƒæ˜¯å°†æ¥æ”¶åˆ°çš„æ‰€æœ‰æ¶ˆæ¯<strong>å¹¿æ’­</strong>åˆ°å®ƒçŸ¥é“çš„ æ‰€æœ‰é˜Ÿåˆ—ä¸­ã€‚ç³»ç»Ÿä¸­é»˜è®¤æœ‰äº› exchange ç±»å‹</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061446628.png" alt="image-20230206144651541"></p><h4 id="5-4-2-Fanout-å®æˆ˜"><a href="#5-4-2-Fanout-å®æˆ˜" class="headerlink" title="5.4.2 Fanout å®æˆ˜"></a>5.4.2 Fanout å®æˆ˜</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061447080.png" alt="image-20230206144736810"></p><p>Logs å’Œä¸´æ—¶é˜Ÿåˆ—çš„ç»‘å®šå…³ç³»å¦‚ä¸‹å›¾</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061449491.png" alt="image-20230206144927335"></p><p>ReceiveLogs01 å°†æ¥æ”¶åˆ°çš„æ¶ˆæ¯æ‰“å°åœ¨æ§åˆ¶å°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æ¶ˆæ¯æ¥æ”¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/5 9:58</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReceiveLog01</span> &#123;</span><br><span class="line">    <span class="comment">// äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;logs&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// å£°æ˜ä¸€ä¸ªäº¤æ¢æœº</span></span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, <span class="string">&quot;fanout&quot;</span>);</span><br><span class="line">        <span class="comment">// å£°æ˜ä¸€ä¸ªä¸´æ—¶é˜Ÿåˆ—ï¼ˆéè¿æ¥çŠ¶æ€ä¼šåˆ é™¤ï¼‰</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * ç”Ÿæˆä¸€ä¸ªä¸´æ—¶é˜Ÿåˆ—ã€é˜Ÿåˆ—çš„åç§°æ˜¯éšæœºçš„</span></span><br><span class="line"><span class="comment">         * å½“æ¶ˆè´¹è€…æ–­å¼€ä¸é˜Ÿåˆ—çš„è¿æ¥çš„æ—¶å€™ï¼Œé˜Ÿåˆ—ä¼šè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> channel.queueDeclare().getQueue();</span><br><span class="line">        <span class="comment">// ç»‘å®šäº¤æ¢æœºä¸é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueBind(queueName, EXCHANGE_NAME, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯ï¼ŒæŠŠæ¥æ”¶æ¶ˆæ¯æ‰“å°åœ¨å±å¹•ä¸Šã€‚ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt;&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ReceiveLog01æ§åˆ¶å°æ‰“å°æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆæ¯æ—¶å›è°ƒæ¥å£</span></span><br><span class="line">        channel.basicConsume(queueName, <span class="literal">true</span>, deliverCallback, consumerTag -&gt; &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ReceiveLogs02 å°†æ¥æ”¶åˆ°çš„æ¶ˆæ¯æ‰“å°åœ¨æ§åˆ¶å°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æ¶ˆæ¯æ¥æ”¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/5 9:58</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReceiveLog02</span> &#123;</span><br><span class="line">    <span class="comment">// äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;logs&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// å£°æ˜ä¸€ä¸ªäº¤æ¢æœº</span></span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, <span class="string">&quot;fanout&quot;</span>);</span><br><span class="line">        <span class="comment">// å£°æ˜ä¸€ä¸ªä¸´æ—¶é˜Ÿåˆ—ï¼ˆéè¿æ¥çŠ¶æ€ä¼šåˆ é™¤ï¼‰</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * ç”Ÿæˆä¸€ä¸ªä¸´æ—¶é˜Ÿåˆ—ã€é˜Ÿåˆ—çš„åç§°æ˜¯éšæœºçš„</span></span><br><span class="line"><span class="comment">         * å½“æ¶ˆè´¹è€…æ–­å¼€ä¸é˜Ÿåˆ—çš„è¿æ¥çš„æ—¶å€™ï¼Œé˜Ÿåˆ—ä¼šè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> channel.queueDeclare().getQueue();</span><br><span class="line">        <span class="comment">// ç»‘å®šäº¤æ¢æœºä¸é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueBind(queueName, EXCHANGE_NAME, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯ï¼ŒæŠŠæ¥æ”¶æ¶ˆæ¯æ‰“å°åœ¨å±å¹•ä¸Šã€‚ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt;&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ReceiveLog02 æ§åˆ¶å°æ‰“å°æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            <span class="comment">//File file = new File(&quot;D:\\æ¡Œé¢\\RabbitMQ\\fanoutPrint.txt&quot;);</span></span><br><span class="line">            <span class="comment">//FileUtils.writeStringToFile(file, new String(message.getBody(), &quot;UTF-8&quot;), &quot;UTF-8&quot;);</span></span><br><span class="line">            <span class="comment">//System.out.println(&quot;æ•°æ®å†™å…¥æ–‡ä»¶æˆåŠŸï¼&quot;);</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆæ¯æ—¶å›è°ƒæ¥å£</span></span><br><span class="line">        channel.basicConsume(queueName, <span class="literal">true</span>, deliverCallback, consumerTag -&gt; &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>EmitLog å‘é€æ¶ˆæ¯ç»™ä¸¤ä¸ªæ¶ˆè´¹è€…æ¥æ”¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å‘æ¶ˆæ¯ äº¤æ¢æœº</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 12:09</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmitLog</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;logs&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, <span class="string">&quot;fanout&quot;</span>);</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="keyword">while</span> (scanner.hasNext())&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">            channel.basicPublish(EXCHANGE_NAME, <span class="string">&quot;&quot;</span>, <span class="literal">null</span>, message.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯ï¼š&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-5-Direct-exchange"><a href="#5-5-Direct-exchange" class="headerlink" title="5.5 Direct exchange"></a>5.5 Direct exchange</h3><h4 id="5-5-1å›é¡¾"><a href="#5-5-1å›é¡¾" class="headerlink" title="5.5.1å›é¡¾"></a>5.5.1å›é¡¾</h4><p>â€‹åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªç®€å•çš„æ—¥å¿—è®°å½•ç³»ç»Ÿã€‚æˆ‘ä»¬èƒ½å¤Ÿå‘è®¸å¤šæ¥æ”¶è€…å¹¿æ’­æ—¥å¿—æ¶ˆæ¯ã€‚åœ¨æœ¬ èŠ‚æˆ‘ä»¬å°†å‘å…¶ä¸­æ·»åŠ ä¸€äº›ç‰¹åˆ«çš„åŠŸèƒ½-æ¯”æ–¹è¯´æˆ‘ä»¬åªè®©æŸä¸ªæ¶ˆè´¹è€…è®¢é˜…å‘å¸ƒçš„éƒ¨åˆ†æ¶ˆæ¯ã€‚ä¾‹å¦‚æˆ‘ä»¬åªæŠŠ ä¸¥é‡é”™è¯¯æ¶ˆæ¯å®šå‘å­˜å‚¨åˆ°æ—¥å¿—æ–‡ä»¶(ä»¥èŠ‚çœç£ç›˜ç©ºé—´)ï¼ŒåŒæ—¶ä»ç„¶èƒ½å¤Ÿåœ¨æ§åˆ¶å°ä¸Šæ‰“å°æ‰€æœ‰æ—¥å¿—æ¶ˆæ¯ã€‚</p><p>â€‹æˆ‘ä»¬å†æ¬¡æ¥å›é¡¾ä¸€ä¸‹ä»€ä¹ˆæ˜¯ bindingsï¼Œç»‘å®šæ˜¯äº¤æ¢æœºå’Œé˜Ÿåˆ—ä¹‹é—´çš„æ¡¥æ¢å…³ç³»ã€‚ä¹Ÿå¯ä»¥è¿™ä¹ˆç†è§£ï¼š <strong>é˜Ÿåˆ—åªå¯¹å®ƒç»‘å®šçš„äº¤æ¢æœºçš„æ¶ˆæ¯æ„Ÿå…´è¶£ã€‚</strong>ç»‘å®šç”¨å‚æ•°ï¼šroutingKey æ¥è¡¨ç¤ºä¹Ÿå¯ç§°è¯¥å‚æ•°ä¸º binding keyï¼Œ åˆ›å»ºç»‘å®šæˆ‘ä»¬ç”¨ä»£ç :channel.queueBind(queueName, EXCHANGE_NAME, â€œroutingKeyâ€);<strong>ç»‘å®šä¹‹åçš„ æ„ä¹‰ç”±å…¶äº¤æ¢ç±»å‹å†³å®šã€‚</strong></p><h4 id="5-5-2-Direct-exhcange-ä»‹ç»"><a href="#5-5-2-Direct-exhcange-ä»‹ç»" class="headerlink" title="5.5.2 Direct exhcange ä»‹ç»"></a>5.5.2 Direct exhcange ä»‹ç»</h4><p>â€‹ä¸Šä¸€èŠ‚ä¸­çš„æˆ‘ä»¬çš„æ—¥å¿—ç³»ç»Ÿå°†æ‰€æœ‰æ¶ˆæ¯å¹¿æ’­ç»™æ‰€æœ‰æ¶ˆè´¹è€…ï¼Œå¯¹æ­¤æˆ‘ä»¬æƒ³åšä¸€äº›æ”¹å˜ï¼Œä¾‹å¦‚æˆ‘ä»¬å¸Œ æœ›å°†æ—¥å¿—æ¶ˆæ¯å†™å…¥ç£ç›˜çš„ç¨‹åºä»…æ¥æ”¶ä¸¥é‡é”™è¯¯(errros)ï¼Œè€Œä¸å­˜å‚¨å“ªäº›è­¦å‘Š(warning)æˆ–ä¿¡æ¯(info)æ—¥å¿— æ¶ˆæ¯é¿å…æµªè´¹ç£ç›˜ç©ºé—´ã€‚Fanout è¿™ç§äº¤æ¢ç±»å‹å¹¶ä¸èƒ½ç»™æˆ‘ä»¬å¸¦æ¥å¾ˆå¤§çš„çµæ´»æ€§-å®ƒåªèƒ½è¿›è¡Œæ— æ„è¯†çš„ å¹¿æ’­ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨ direct è¿™ç§ç±»å‹æ¥è¿›è¡Œæ›¿æ¢ï¼Œè¿™ç§ç±»å‹çš„å·¥ä½œæ–¹å¼æ˜¯ï¼Œæ¶ˆæ¯åªå»åˆ°å®ƒç»‘å®šçš„ routingKey é˜Ÿåˆ—ä¸­å»ã€‚</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061502033.png" alt="image-20230206150241071"></p><p>â€‹åœ¨ä¸Šé¢è¿™å¼ å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° X ç»‘å®šäº†ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œç»‘å®šç±»å‹æ˜¯ directã€‚é˜Ÿåˆ— Q1 ç»‘å®šé”®ä¸º orangeï¼Œ é˜Ÿåˆ— Q2 ç»‘å®šé”®æœ‰ä¸¤ä¸ª:ä¸€ä¸ªç»‘å®šé”®ä¸º blackï¼Œå¦ä¸€ä¸ªç»‘å®šé”®ä¸º green.</p><p>â€‹åœ¨è¿™ç§ç»‘å®šæƒ…å†µä¸‹ï¼Œç”Ÿäº§è€…å‘å¸ƒæ¶ˆæ¯åˆ° exchange ä¸Šï¼Œç»‘å®šé”®ä¸º orange çš„æ¶ˆæ¯ä¼šè¢«å‘å¸ƒåˆ°é˜Ÿåˆ— Q1ã€‚ç»‘å®šé”®ä¸º blackgreen å’Œçš„æ¶ˆæ¯ä¼šè¢«å‘å¸ƒåˆ°é˜Ÿåˆ— Q2ï¼Œå…¶ä»–æ¶ˆæ¯ç±»å‹çš„æ¶ˆæ¯å°†è¢«ä¸¢å¼ƒã€‚</p><h4 id="5-5-3-å¤šé‡ç»‘å®š"><a href="#5-5-3-å¤šé‡ç»‘å®š" class="headerlink" title="5.5.3 å¤šé‡ç»‘å®š"></a>5.5.3 å¤šé‡ç»‘å®š</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061503490.png" alt="image-20230206150325345"></p><p>â€‹å½“ç„¶å¦‚æœ exchange çš„ç»‘å®šç±»å‹æ˜¯ directï¼Œ<strong>ä½†æ˜¯å®ƒç»‘å®šçš„å¤šä¸ªé˜Ÿåˆ—çš„ key å¦‚æœéƒ½ç›¸åŒ</strong>ï¼Œåœ¨è¿™ç§æƒ… å†µä¸‹è™½ç„¶ç»‘å®šç±»å‹æ˜¯ direct <strong>ä½†æ˜¯å®ƒè¡¨ç°çš„å°±å’Œ fanout æœ‰ç‚¹ç±»ä¼¼äº†</strong>ï¼Œå°±è·Ÿå¹¿æ’­å·®ä¸å¤šï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚</p><h4 id="5-5-4-Direct-Exchange-å®æˆ˜"><a href="#5-5-4-Direct-Exchange-å®æˆ˜" class="headerlink" title="5.5.4 Direct Exchange å®æˆ˜"></a>5.5.4 Direct Exchange å®æˆ˜</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061504204.png" alt="image-20230206150431067"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061506532.png" alt="image-20230206150649262"></p><p>ReceiveLogsDirect01.java æ¥æ”¶æ¶ˆæ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:ç­‰å¾…æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 12:21</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReceiveLogsDirect01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;direct_logs&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// å£°æ˜ä¸€ä¸ªäº¤æ¢æœº</span></span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.DIRECT);</span><br><span class="line">        <span class="comment">// å£°æ˜ä¸€ä¸ªé˜Ÿåˆ—</span></span><br><span class="line">        channel.queueDeclare(<span class="string">&quot;console&quot;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        channel.queueBind(<span class="string">&quot;console&quot;</span>, EXCHANGE_NAME, <span class="string">&quot;info&quot;</span>);</span><br><span class="line">        channel.queueBind(<span class="string">&quot;console&quot;</span>, EXCHANGE_NAME, <span class="string">&quot;warning&quot;</span>);</span><br><span class="line">        <span class="comment">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt;&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ReceiveLogsDirect01 æ§åˆ¶å°æ‰“å°æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆæ¯æ—¶å›è°ƒæ¥å£</span></span><br><span class="line">        channel.basicConsume(<span class="string">&quot;console&quot;</span>, <span class="literal">true</span>, deliverCallback, consumerTag -&gt; &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ReceiveLogsDirect02.java æ¥æ”¶æ¶ˆæ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ç­‰å¾…æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 12:21</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReceiveLogsDirect02</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;direct_logs&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// å£°æ˜ä¸€ä¸ªäº¤æ¢æœº</span></span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.DIRECT);</span><br><span class="line">        <span class="comment">// å£°æ˜ä¸€ä¸ªé˜Ÿåˆ—</span></span><br><span class="line">        channel.queueDeclare(<span class="string">&quot;disk&quot;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        channel.queueBind(<span class="string">&quot;disk&quot;</span>, EXCHANGE_NAME, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">        <span class="comment">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt;&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ReceiveLogsDirect02 æ§åˆ¶å°æ‰“å°æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆæ¯æ—¶å›è°ƒæ¥å£</span></span><br><span class="line">        channel.basicConsume(<span class="string">&quot;disk&quot;</span>, <span class="literal">true</span>, deliverCallback, consumerTag -&gt; &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>DirectLogs ç”Ÿäº§è€…å‘æ¶ˆæ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å‘æ¶ˆæ¯ äº¤æ¢æœº</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 12:09</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DirectLogs</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;direct_logs&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="keyword">while</span> (scanner.hasNext())&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">            channel.basicPublish(EXCHANGE_NAME, <span class="string">&quot;error&quot;</span>, <span class="literal">null</span>, message.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯ï¼š&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-6-Topics"><a href="#5-6-Topics" class="headerlink" title="5.6 Topics"></a>5.6 Topics</h3><h4 id="5-6-1-fanoutã€directç±»å‹çš„é—®é¢˜"><a href="#5-6-1-fanoutã€directç±»å‹çš„é—®é¢˜" class="headerlink" title="5.6.1 fanoutã€directç±»å‹çš„é—®é¢˜"></a>5.6.1 fanoutã€directç±»å‹çš„é—®é¢˜</h4><p>â€‹åœ¨ä¸Šä¸€ä¸ªå°èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ”¹è¿›äº†æ—¥å¿—è®°å½•ç³»ç»Ÿã€‚æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨åªèƒ½è¿›è¡Œéšæ„å¹¿æ’­çš„ fanout äº¤æ¢æœºï¼Œè€Œæ˜¯ ä½¿ç”¨äº† direct äº¤æ¢æœºï¼Œä»è€Œæœ‰èƒ½å®ç°æœ‰é€‰æ‹©æ€§åœ°æ¥æ”¶æ—¥å¿—ã€‚</p><p>â€‹å°½ç®¡ä½¿ç”¨ direct äº¤æ¢æœºæ”¹è¿›äº†æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œä½†æ˜¯å®ƒä»ç„¶å­˜åœ¨å±€é™æ€§-æ¯”æ–¹è¯´æˆ‘ä»¬æƒ³æ¥æ”¶çš„æ—¥å¿—ç±»å‹æœ‰ info.base å’Œ info.advantageï¼ŒæŸä¸ªé˜Ÿåˆ—åªæƒ³ info.base çš„æ¶ˆæ¯ï¼Œé‚£è¿™ä¸ªæ—¶å€™ direct å°±åŠä¸åˆ°äº†ã€‚è¿™ä¸ªæ—¶å€™ å°±åªèƒ½ä½¿ç”¨ topic ç±»å‹</p><h4 id="5-6-2-Topic-çš„è¦æ±‚"><a href="#5-6-2-Topic-çš„è¦æ±‚" class="headerlink" title="5.6.2 Topic çš„è¦æ±‚"></a>5.6.2 Topic çš„è¦æ±‚</h4><p>â€‹å‘é€åˆ°ç±»å‹æ˜¯ topic äº¤æ¢æœºçš„æ¶ˆæ¯çš„ routing_key ä¸èƒ½éšæ„å†™ï¼Œå¿…é¡»æ»¡è¶³ä¸€å®šçš„è¦æ±‚ï¼Œå®ƒ<strong>å¿…é¡»æ˜¯ä¸€ä¸ªå•è¯åˆ—è¡¨ï¼Œä»¥ç‚¹å·åˆ†éš”å¼€ã€‚</strong>è¿™äº›å•è¯å¯ä»¥æ˜¯ä»»æ„å•è¯ï¼Œæ¯”å¦‚è¯´ï¼šâ€stock.usd.nyseâ€, â€œnyse.vmwâ€,  â€œquick.orange.rabbitâ€.è¿™ç§ç±»å‹çš„ã€‚å½“ç„¶è¿™ä¸ªå•è¯åˆ—è¡¨æœ€å¤šä¸èƒ½è¶…è¿‡ 255 ä¸ªå­—èŠ‚ã€‚</p><p>åœ¨è¿™ä¸ªè§„åˆ™åˆ—è¡¨ä¸­ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªæ›¿æ¢ç¬¦æ˜¯å¤§å®¶éœ€è¦æ³¨æ„çš„ </p><ul><li>***(æ˜Ÿå·)å¯ä»¥ä»£æ›¿ä¸€ä¸ªå•è¯** </li><li><strong>#(äº•å·)å¯ä»¥æ›¿ä»£é›¶ä¸ªæˆ–å¤šä¸ªå•è¯</strong></li></ul><h4 id="5-6-3-Topic-åŒ¹é…æ¡ˆä¾‹"><a href="#5-6-3-Topic-åŒ¹é…æ¡ˆä¾‹" class="headerlink" title="5.6.3 Topic åŒ¹é…æ¡ˆä¾‹"></a>5.6.3 Topic åŒ¹é…æ¡ˆä¾‹</h4><p>ä¸‹å›¾ç»‘å®šå…³ç³»å¦‚ä¸‹<br>Q1â€“&gt;ç»‘å®šçš„æ˜¯<br>         ä¸­é—´å¸¦ orange å¸¦ 3 ä¸ªå•è¯çš„å­—ç¬¦ä¸²(<em>.orange.</em>)<br>Q2â€“&gt;ç»‘å®šçš„æ˜¯<br>        æœ€åä¸€ä¸ªå•è¯æ˜¯ rabbit çš„ 3 ä¸ªå•è¯(<em>.</em>.rabbit)<br>        ç¬¬ä¸€ä¸ªå•è¯æ˜¯ lazy çš„å¤šä¸ªå•è¯(lazy.#)</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061513539.png" alt="image-20230206151331534"></p><p>ä¸Šå›¾æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ç»‘å®šå…³ç³»å›¾ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä»–ä»¬ä¹‹é—´æ•°æ®æ¥æ”¶æƒ…å†µæ˜¯æ€ä¹ˆæ ·çš„</p><table><thead><tr><th>routingKey</th><th>æ•°æ®å†…å®¹</th></tr></thead><tbody><tr><td>quick.orange.rabbit</td><td>è¢«é˜Ÿåˆ— Q1Q2 æ¥æ”¶åˆ°</td></tr><tr><td>lazy.orange.elephant</td><td>è¢«é˜Ÿåˆ— Q1Q2 æ¥æ”¶åˆ°</td></tr><tr><td>quick.orange.fox</td><td>è¢«é˜Ÿåˆ— Q1 æ¥æ”¶åˆ°</td></tr><tr><td>lazy.brown.fox</td><td>è¢«é˜Ÿåˆ— Q2 æ¥æ”¶åˆ°</td></tr><tr><td>lazy.pink.rabbit</td><td>è™½ç„¶æ»¡è¶³ä¸¤ä¸ªç»‘å®šä½†åªè¢«é˜Ÿåˆ— Q2 æ¥æ”¶ä¸€æ¬¡</td></tr><tr><td>quick.brown.fox</td><td>ä¸åŒ¹é…ä»»ä½•ç»‘å®šä¸ä¼šè¢«ä»»ä½•é˜Ÿåˆ—æ¥æ”¶åˆ°ä¼šè¢«ä¸¢å¼ƒ</td></tr><tr><td>quick.orange.male.rabbit</td><td>æ˜¯å››ä¸ªå•è¯ä¸åŒ¹é…ä»»ä½•ç»‘å®šä¼šè¢«ä¸¢å¼ƒ</td></tr><tr><td>lazy.orange.male.rabbit</td><td>æ˜¯å››ä¸ªå•è¯ä½†åŒ¹é… Q2</td></tr></tbody></table><p>å½“é˜Ÿåˆ—ç»‘å®šå…³ç³»æ˜¯ä¸‹åˆ—è¿™ç§æƒ…å†µæ—¶éœ€è¦å¼•èµ·æ³¨æ„</p><ul><li><strong>å½“ä¸€ä¸ªé˜Ÿåˆ—ç»‘å®šé”®æ˜¯#,é‚£ä¹ˆè¿™ä¸ªé˜Ÿåˆ—å°†æ¥æ”¶æ‰€æœ‰æ•°æ®ï¼Œå°±æœ‰ç‚¹åƒ fanout äº†</strong> </li><li><strong>å¦‚æœé˜Ÿåˆ—ç»‘å®šé”®å½“ä¸­æ²¡æœ‰#å’Œ*å‡ºç°ï¼Œé‚£ä¹ˆè¯¥é˜Ÿåˆ—ç»‘å®šç±»å‹å°±æ˜¯ direct äº†</strong></li></ul><h4 id="5-6-4-Topic-å®æˆ˜"><a href="#5-6-4-Topic-å®æˆ˜" class="headerlink" title="5.6.4 Topic å®æˆ˜"></a>5.6.4 Topic å®æˆ˜</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061520103.png" alt="image-20230206152004674"></p><p>ç”Ÿäº§è€… EmitLogTopic</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ç”Ÿäº§è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 13:32</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmitLogTopic</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;topic_logs&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Q1--&gt;ç»‘å®šçš„æ˜¯</span></span><br><span class="line"><span class="comment">         *  ä¸­é—´å¸¦ orange å¸¦ 3 ä¸ªå•è¯çš„å­—ç¬¦ä¸²(*.orange.*)</span></span><br><span class="line"><span class="comment">         * Q2--&gt;ç»‘å®šçš„æ˜¯</span></span><br><span class="line"><span class="comment">         * æœ€åä¸€ä¸ªå•è¯æ˜¯ rabbit çš„ 3 ä¸ªå•è¯(*.*.rabbit)</span></span><br><span class="line"><span class="comment">         * ç¬¬ä¸€ä¸ªå•è¯æ˜¯ lazy çš„å¤šä¸ªå•è¯(lazy.#)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        Map&lt;String, String&gt; bindingKeyMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;quick.orange.rabbit&quot;</span>,<span class="string">&quot;è¢«é˜Ÿåˆ— Q1Q2 æ¥æ”¶åˆ°&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;lazy.orange.elephant&quot;</span>,<span class="string">&quot;è¢«é˜Ÿåˆ— Q1Q2 æ¥æ”¶åˆ°&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;quick.orange.fox&quot;</span>,<span class="string">&quot;è¢«é˜Ÿåˆ— Q1 æ¥æ”¶åˆ°&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;lazy.brown.fox&quot;</span>,<span class="string">&quot;è¢«é˜Ÿåˆ— Q2 æ¥æ”¶åˆ°&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;lazy.pink.rabbit&quot;</span>,<span class="string">&quot;è™½ç„¶æ»¡è¶³ä¸¤ä¸ªç»‘å®šä½†åªè¢«é˜Ÿåˆ— Q2 æ¥æ”¶ä¸€æ¬¡&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;quick.brown.fox&quot;</span>,<span class="string">&quot;ä¸åŒ¹é…ä»»ä½•ç»‘å®šä¸ä¼šè¢«ä»»ä½•é˜Ÿåˆ—æ¥æ”¶åˆ°ä¼šè¢«ä¸¢å¼ƒ&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;quick.orange.male.rabbit&quot;</span>,<span class="string">&quot;æ˜¯å››ä¸ªå•è¯ä¸åŒ¹é…ä»»ä½•ç»‘å®šä¼šè¢«ä¸¢å¼ƒ&quot;</span>);</span><br><span class="line">        bindingKeyMap.put(<span class="string">&quot;lazy.orange.male.rabbit&quot;</span>,<span class="string">&quot;æ˜¯å››ä¸ªå•è¯ä½†åŒ¹é… Q2&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; bindingKeyEntry : bindingKeyMap.entrySet()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">routingKey</span> <span class="operator">=</span> bindingKeyEntry.getKey();</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> bindingKeyEntry.getValue();</span><br><span class="line">            channel.basicPublish(EXCHANGE_NAME, routingKey, <span class="literal">null</span>, message.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯ï¼š&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€… ReceiveLogsTopic01</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å£°æ˜ä¸»é¢˜äº¤æ¢æœºåŠç›¸å…³é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment"> * æ¶ˆè´¹è€… C1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 13:18</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReceiveLogsTopic01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;topic_logs&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// å£°æ˜äº¤æ¢æœº</span></span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, <span class="string">&quot;topic&quot;</span>);</span><br><span class="line">        <span class="comment">// å£°æ˜é˜Ÿåˆ—</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> <span class="string">&quot;Q1&quot;</span>;</span><br><span class="line">        channel.queueDeclare(queueName, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        channel.queueBind(queueName, EXCHANGE_NAME, <span class="string">&quot;*.orange.*&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯......&quot;</span>);</span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥æ”¶é˜Ÿåˆ—ï¼š&quot;</span> + queueName + <span class="string">&quot;    ç»‘å®šé”®ï¼š&quot;</span> + message.getEnvelope().getRoutingKey());</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        channel.basicConsume(queueName, <span class="literal">true</span>, deliverCallback, consumerTag -&gt; &#123;&#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€… ReceiveLogsTopic02</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å£°æ˜ä¸»é¢˜äº¤æ¢æœºåŠç›¸å…³é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment"> * æ¶ˆè´¹è€… C2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 13:18</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReceiveLogsTopic02</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;topic_logs&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// å£°æ˜äº¤æ¢æœº</span></span><br><span class="line">        channel.exchangeDeclare(EXCHANGE_NAME, <span class="string">&quot;topic&quot;</span>);</span><br><span class="line">        <span class="comment">// å£°æ˜é˜Ÿåˆ—</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">queueName</span> <span class="operator">=</span> <span class="string">&quot;Q2&quot;</span>;</span><br><span class="line">        channel.queueDeclare(queueName, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        channel.queueBind(queueName, EXCHANGE_NAME, <span class="string">&quot;*.*.rabbit&quot;</span>);</span><br><span class="line">        channel.queueBind(queueName, EXCHANGE_NAME, <span class="string">&quot;lazy.#&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯......&quot;</span>);</span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥æ”¶é˜Ÿåˆ—ï¼š&quot;</span> + queueName + <span class="string">&quot;    ç»‘å®šé”®ï¼š&quot;</span> + message.getEnvelope().getRoutingKey());</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        channel.basicConsume(queueName, <span class="literal">true</span>, deliverCallback, consumerTag -&gt; &#123;&#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-6-5-å®æˆ˜ç»“æœ"><a href="#5-6-5-å®æˆ˜ç»“æœ" class="headerlink" title="5.6.5 å®æˆ˜ç»“æœ"></a>5.6.5 å®æˆ˜ç»“æœ</h4><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061523899.png" alt="image-20230206152253327" style="zoom: 80%;" /><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061523044.png" alt="image-20230206152331685" style="zoom:80%;" /><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302061524085.png" alt="image-20230206152357134" style="zoom:80%;" /><h2 id="6-æ­»ä¿¡é˜Ÿåˆ—"><a href="#6-æ­»ä¿¡é˜Ÿåˆ—" class="headerlink" title="6.æ­»ä¿¡é˜Ÿåˆ—"></a>6.æ­»ä¿¡é˜Ÿåˆ—</h2><h3 id="6-1-æ­»ä¿¡çš„æ¦‚å¿µ"><a href="#6-1-æ­»ä¿¡çš„æ¦‚å¿µ" class="headerlink" title="6.1 æ­»ä¿¡çš„æ¦‚å¿µ"></a>6.1 æ­»ä¿¡çš„æ¦‚å¿µ</h3><p>â€‹å…ˆä»æ¦‚å¿µè§£é‡Šä¸Šææ¸…æ¥šè¿™ä¸ªå®šä¹‰ï¼Œæ­»ä¿¡ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æ— æ³•è¢«æ¶ˆè´¹çš„æ¶ˆæ¯ï¼Œå­—é¢æ„æ€å¯ä»¥è¿™æ ·ç† è§£ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œproducer å°†æ¶ˆæ¯æŠ•é€’åˆ° broker æˆ–è€…ç›´æ¥åˆ° queue é‡Œäº†ï¼Œconsumer ä» queue å–å‡ºæ¶ˆæ¯ è¿›è¡Œæ¶ˆè´¹ï¼Œä½†æŸäº›æ—¶å€™<strong>ç”±äºç‰¹å®šçš„åŸå› å¯¼è‡´ queue ä¸­çš„æŸäº›æ¶ˆæ¯æ— æ³•è¢«æ¶ˆè´¹</strong>ï¼Œè¿™æ ·çš„æ¶ˆæ¯å¦‚æœæ²¡æœ‰ åç»­çš„å¤„ç†ï¼Œå°±å˜æˆäº†æ­»ä¿¡ï¼Œæœ‰æ­»ä¿¡è‡ªç„¶å°±æœ‰äº†æ­»ä¿¡é˜Ÿåˆ—ã€‚</p><p>â€‹åº”ç”¨åœºæ™¯:ä¸ºäº†ä¿è¯è®¢å•ä¸šåŠ¡çš„æ¶ˆæ¯æ•°æ®ä¸ä¸¢å¤±ï¼Œéœ€è¦ä½¿ç”¨åˆ° RabbitMQ çš„æ­»ä¿¡é˜Ÿåˆ—æœºåˆ¶ï¼Œå½“æ¶ˆæ¯ æ¶ˆè´¹å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå°†æ¶ˆæ¯æŠ•å…¥æ­»ä¿¡é˜Ÿåˆ—ä¸­.è¿˜æœ‰æ¯”å¦‚è¯´: ç”¨æˆ·åœ¨å•†åŸä¸‹å•æˆåŠŸå¹¶ç‚¹å‡»å»æ”¯ä»˜ååœ¨æŒ‡å®šæ—¶ é—´æœªæ”¯ä»˜æ—¶è‡ªåŠ¨å¤±æ•ˆ</p><h3 id="6-2-æ­»ä¿¡çš„æ¥æº"><a href="#6-2-æ­»ä¿¡çš„æ¥æº" class="headerlink" title="6.2 æ­»ä¿¡çš„æ¥æº"></a>6.2 æ­»ä¿¡çš„æ¥æº</h3><ul><li>æ¶ˆæ¯ TTL è¿‡æœŸ</li><li>é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦(é˜Ÿåˆ—æ»¡äº†ï¼Œæ— æ³•å†æ·»åŠ æ•°æ®åˆ° mq ä¸­)</li><li>æ¶ˆæ¯è¢«æ‹’ç»(basic.reject æˆ– basic.nack)å¹¶ä¸” requeue&#x3D;false</li></ul><h3 id="6-3-æ­»ä¿¡å®æˆ˜"><a href="#6-3-æ­»ä¿¡å®æˆ˜" class="headerlink" title="6.3 æ­»ä¿¡å®æˆ˜"></a>6.3 æ­»ä¿¡å®æˆ˜</h3><h4 id="6-3-1-ä»£ç æ¶æ„å›¾"><a href="#6-3-1-ä»£ç æ¶æ„å›¾" class="headerlink" title="6.3.1 ä»£ç æ¶æ„å›¾"></a>6.3.1 ä»£ç æ¶æ„å›¾</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302062010451.png" alt="image-20230206201046563"></p><h4 id="6-3-2-æ¶ˆæ¯-TTL-è¿‡æœŸ"><a href="#6-3-2-æ¶ˆæ¯-TTL-è¿‡æœŸ" class="headerlink" title="6.3.2 æ¶ˆæ¯ TTL è¿‡æœŸ"></a>6.3.2 æ¶ˆæ¯ TTL è¿‡æœŸ</h4><p>ç”Ÿäº§è€…ä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æ­»ä¿¡é˜Ÿåˆ—ä¹‹ç”Ÿäº§è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 16:59</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeadQueueProducer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;normal_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// æ­»ä¿¡æ¶ˆæ¯ è®¾ç½® TTL æ—¶é—´ time to live å•ä½æ˜¯ ms 1000ms = 10s</span></span><br><span class="line">        AMQP.<span class="type">BasicProperties</span> <span class="variable">properties</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">AMQP</span>.BasicProperties()</span><br><span class="line">                        .builder().expiration(<span class="string">&quot;10000&quot;</span>).build();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; <span class="number">11</span>; i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;info&quot;</span> + i;</span><br><span class="line">            channel.basicPublish(NORMAL_EXCHANGE, <span class="string">&quot;zhangsan&quot;</span>, properties, message.getBytes());</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘æ¶ˆæ¯ï¼š&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€… C1 ä»£ç (<strong>å¯åŠ¨ä¹‹åå…³é—­è¯¥æ¶ˆè´¹è€… æ¨¡æ‹Ÿå…¶æ¥æ”¶ä¸åˆ°æ¶ˆæ¯</strong>)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 19:56</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerTest01</span> &#123;</span><br><span class="line">    <span class="comment">//æ™®é€šäº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;normal_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;dead_exchange&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] argv)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">//å£°æ˜æ­»ä¿¡å’Œæ™®é€šäº¤æ¢æœº ç±»å‹ä¸º direct</span></span><br><span class="line">        channel.exchangeDeclare(NORMAL_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line">        channel.exchangeDeclare(DEAD_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line">        <span class="comment">//å£°æ˜æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">deadQueue</span> <span class="operator">=</span> <span class="string">&quot;dead-queue&quot;</span>;</span><br><span class="line">        channel.queueDeclare(deadQueue, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">//æ­»ä¿¡é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœºä¸ routingkey</span></span><br><span class="line">        channel.queueBind(deadQueue, DEAD_EXCHANGE, <span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        <span class="comment">//æ­£å¸¸é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡é˜Ÿåˆ—ä¿¡æ¯</span></span><br><span class="line">        Map&lt;String, Object&gt; params = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//æ­£å¸¸é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡äº¤æ¢æœº å‚æ•° key æ˜¯å›ºå®šå€¼</span></span><br><span class="line">        params.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, DEAD_EXCHANGE);</span><br><span class="line">        <span class="comment">//æ­£å¸¸é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡ routing-key å‚æ•° key æ˜¯å›ºå®šå€¼</span></span><br><span class="line">        params.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;lisi&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">normalQueue</span> <span class="operator">=</span> <span class="string">&quot;normal-queue&quot;</span>;</span><br><span class="line">        channel.queueDeclare(normalQueue, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, params);</span><br><span class="line">        channel.queueBind(normalQueue, NORMAL_EXCHANGE, <span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯.....&quot;</span>);</span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, delivery) -&gt; &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Consumer01 æ¥æ”¶åˆ°æ¶ˆæ¯&quot;</span>+message);</span><br><span class="line">        &#125;;</span><br><span class="line">        channel.basicConsume(normalQueue, <span class="literal">true</span>, deliverCallback, consumerTag -&gt; &#123;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”Ÿäº§è€…æœªå‘æ¶ˆæ¯</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302062017485.png" alt="image-20230206201726068"></p><p><strong>å…³é—­è¯¥æ¶ˆè´¹è€… æ¨¡æ‹Ÿå…¶æ¥æ”¶ä¸åˆ°æ¶ˆæ¯ï¼Œ</strong>ç”Ÿäº§è€…å‘é€äº† 10 æ¡æ¶ˆæ¯ æ­¤æ—¶æ­£å¸¸æ¶ˆæ¯é˜Ÿåˆ—æœ‰ 10 æ¡æœªæ¶ˆè´¹æ¶ˆæ¯</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302062019755.png" alt="image-20230206201902124"></p><p>æ—¶é—´è¿‡å» 10 ç§’æ­£å¸¸é˜Ÿåˆ—é‡Œé¢çš„æ¶ˆæ¯ç”±äºæ²¡æœ‰è¢«æ¶ˆè´¹ æ¶ˆæ¯è¿›å…¥æ­»ä¿¡é˜Ÿåˆ—</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302062020450.png" alt="image-20230206202022049"></p><p>æ¶ˆè´¹è€… C2 ä»£ç (<strong>ä»¥ä¸Šæ­¥éª¤å®Œæˆå å¯åŠ¨ C2 æ¶ˆè´¹è€… å®ƒæ¶ˆè´¹æ­»ä¿¡é˜Ÿåˆ—é‡Œé¢çš„æ¶ˆæ¯</strong>) </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æ¶ˆè´¹è€… 2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 19:56</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerTest02</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;dead_exchange&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] argv)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        channel.exchangeDeclare(DEAD_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line">        <span class="type">String</span> <span class="variable">deadQueue</span> <span class="operator">=</span> <span class="string">&quot;dead-queue&quot;</span>;</span><br><span class="line">        channel.queueDeclare(deadQueue, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        channel.queueBind(deadQueue, DEAD_EXCHANGE, <span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ­»ä¿¡é˜Ÿåˆ—æ¶ˆæ¯.....&quot;</span>);</span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, delivery) -&gt; &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Consumer02 æ¥æ”¶æ­»ä¿¡é˜Ÿåˆ—çš„æ¶ˆæ¯&quot;</span> + message);</span><br><span class="line">        &#125;;</span><br><span class="line">        channel.basicConsume(deadQueue, <span class="literal">true</span>, deliverCallback, consumerTag -&gt; &#123;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302062028996.png" alt="image-20230206202810630"></p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302062029507.png" alt="image-20230206202853014" style="zoom:80%;" /><h4 id="6-3-3-é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦"><a href="#6-3-3-é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦" class="headerlink" title="6.3.3 é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦"></a>6.3.3 é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦</h4><ol><li>æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç å»æ‰ TTL å±æ€§<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æ­»ä¿¡é˜Ÿåˆ—ä¹‹ç”Ÿäº§è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 16:59</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeadQueueProducer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;normal_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">// æ­»ä¿¡æ¶ˆæ¯ è®¾ç½® TTL æ—¶é—´ time to live å•ä½æ˜¯ ms 1000ms = 10s</span></span><br><span class="line">        <span class="comment">//AMQP.BasicProperties properties =</span></span><br><span class="line">        <span class="comment">//        new AMQP.BasicProperties()</span></span><br><span class="line">        <span class="comment">//                .builder().expiration(&quot;10000&quot;).build();</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; <span class="number">11</span>; i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;info&quot;</span> + i;</span><br><span class="line">            channel.basicPublish(NORMAL_EXCHANGE, <span class="string">&quot;zhangsan&quot;</span>, <span class="literal">null</span>, message.getBytes());</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”Ÿäº§è€…å‘æ¶ˆæ¯ï¼š&quot;</span> + message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302062040910.png" alt="image-20230206204034841"></p><ol start="2"><li>C1 æ¶ˆè´¹è€…ä¿®æ”¹ä»¥ä¸‹ä»£ç (<strong>å¯åŠ¨ä¹‹åå…³é—­è¯¥æ¶ˆè´¹è€… æ¨¡æ‹Ÿå…¶æ¥æ”¶ä¸åˆ°æ¶ˆæ¯</strong>)</li></ol><p>â€‹ä¸»è¦æ˜¯ä¿®æ”¹ä¸€ä¸‹ä»£ç <br>â€‹<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302062043693.png" alt="image-20230206204318136" style="zoom: 80%;" /></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æ¶ˆè´¹è€… 1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 19:56</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerTest01</span> &#123;</span><br><span class="line">    <span class="comment">//æ™®é€šäº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;normal_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;dead_exchange&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] argv)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">//å£°æ˜æ­»ä¿¡å’Œæ™®é€šäº¤æ¢æœº ç±»å‹ä¸º direct</span></span><br><span class="line">        channel.exchangeDeclare(NORMAL_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line">        channel.exchangeDeclare(DEAD_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line">        <span class="comment">//å£°æ˜æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">deadQueue</span> <span class="operator">=</span> <span class="string">&quot;dead-queue&quot;</span>;</span><br><span class="line">        channel.queueDeclare(deadQueue, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">//æ­»ä¿¡é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœºä¸ routingkey</span></span><br><span class="line">        channel.queueBind(deadQueue, DEAD_EXCHANGE, <span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        <span class="comment">//æ­£å¸¸é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡é˜Ÿåˆ—ä¿¡æ¯</span></span><br><span class="line">        Map&lt;String, Object&gt; params = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//æ­£å¸¸é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡äº¤æ¢æœº å‚æ•° key æ˜¯å›ºå®šå€¼</span></span><br><span class="line">        params.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, DEAD_EXCHANGE);</span><br><span class="line">        <span class="comment">//æ­£å¸¸é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡ routing-key å‚æ•° key æ˜¯å›ºå®šå€¼</span></span><br><span class="line">        params.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        <span class="comment">// è®¾ç½®æ­£å¸¸é˜Ÿåˆ—çš„é•¿åº¦çš„é™åˆ¶</span></span><br><span class="line">        params.put(<span class="string">&quot;x-max-length&quot;</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">normalQueue</span> <span class="operator">=</span> <span class="string">&quot;normal-queue&quot;</span>;</span><br><span class="line">        channel.queueDeclare(normalQueue, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, params);</span><br><span class="line">        channel.queueBind(normalQueue, NORMAL_EXCHANGE, <span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯.....&quot;</span>);</span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, delivery) -&gt; &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Consumer01 æ¥æ”¶åˆ°æ¶ˆæ¯&quot;</span>+message);</span><br><span class="line">        &#125;;</span><br><span class="line">        channel.basicConsume(normalQueue, <span class="literal">true</span>, deliverCallback, consumerTag -&gt; &#123;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„æ­¤æ—¶éœ€è¦æŠŠåŸå…ˆé˜Ÿåˆ—åˆ é™¤ å› ä¸ºå‚æ•°æ”¹å˜äº†</strong></p><ol start="3"><li>C2 æ¶ˆè´¹è€…ä¸å˜ï¼Œç›´æ¥å¯åŠ¨å³å¯<br><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302062046744.png" alt="image-20230206204541411"></li></ol><p>â€‹<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302062046084.png" alt="image-20230206204628773"></p><h4 id="6-3-4-æ¶ˆæ¯è¢«æ‹’"><a href="#6-3-4-æ¶ˆæ¯è¢«æ‹’" class="headerlink" title="6.3.4 æ¶ˆæ¯è¢«æ‹’"></a>6.3.4 æ¶ˆæ¯è¢«æ‹’</h4><p>1.æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç åŒä¸Šç”Ÿäº§è€…ä¸€è‡´ </p><p>2.C1 æ¶ˆè´¹è€…ä»£ç (<strong>å¯åŠ¨ä¹‹åå…³é—­è¯¥æ¶ˆè´¹è€… æ¨¡æ‹Ÿå…¶æ¥æ”¶ä¸åˆ°æ¶ˆæ¯</strong>)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æ¶ˆè´¹è€… 1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/6 19:56</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerTest01</span> &#123;</span><br><span class="line">    <span class="comment">//æ™®é€šäº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;normal_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;dead_exchange&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] argv)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMqUtils.getChannel();</span><br><span class="line">        <span class="comment">//å£°æ˜æ­»ä¿¡å’Œæ™®é€šäº¤æ¢æœº ç±»å‹ä¸º direct</span></span><br><span class="line">        channel.exchangeDeclare(NORMAL_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line">        channel.exchangeDeclare(DEAD_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line">        <span class="comment">//å£°æ˜æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">deadQueue</span> <span class="operator">=</span> <span class="string">&quot;dead-queue&quot;</span>;</span><br><span class="line">        channel.queueDeclare(deadQueue, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">//æ­»ä¿¡é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœºä¸ routingkey</span></span><br><span class="line">        channel.queueBind(deadQueue, DEAD_EXCHANGE, <span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        <span class="comment">//æ­£å¸¸é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡é˜Ÿåˆ—ä¿¡æ¯</span></span><br><span class="line">        Map&lt;String, Object&gt; params = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//æ­£å¸¸é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡äº¤æ¢æœº å‚æ•° key æ˜¯å›ºå®šå€¼</span></span><br><span class="line">        params.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, DEAD_EXCHANGE);</span><br><span class="line">        <span class="comment">//æ­£å¸¸é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡ routing-key å‚æ•° key æ˜¯å›ºå®šå€¼</span></span><br><span class="line">        params.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        <span class="comment">// è®¾ç½®æ­£å¸¸é˜Ÿåˆ—çš„é•¿åº¦çš„é™åˆ¶</span></span><br><span class="line">        <span class="comment">//params.put(&quot;x-max-length&quot;, 6);</span></span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">normalQueue</span> <span class="operator">=</span> <span class="string">&quot;normal-queue&quot;</span>;</span><br><span class="line">        channel.queueDeclare(normalQueue, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, params);</span><br><span class="line">        channel.queueBind(normalQueue, NORMAL_EXCHANGE, <span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯.....&quot;</span>);</span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, delivery) -&gt; &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(delivery.getBody(), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">&quot;info5&quot;</span>.equals(message))&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Consumer01 æ¥æ”¶åˆ°æ¶ˆæ¯&quot;</span> + message + <span class="string">&quot;æ­¤æ¶ˆæ¯æ˜¯è¢« C1 æ‹’ç»çš„&quot;</span>);</span><br><span class="line">                channel.basicReject(delivery.getEnvelope().getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Consumer01 æ¥æ”¶åˆ°æ¶ˆæ¯&quot;</span>+message);</span><br><span class="line">                channel.basicAck(delivery.getEnvelope().getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// å¼€å¯æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line">        channel.basicConsume(normalQueue, <span class="literal">false</span>, deliverCallback, consumerTag -&gt; &#123;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æ¶ˆè´¹è€… C1 ï¼Œå¯åŠ¨ç”Ÿäº§è€…å‘é€æ¶ˆæ¯ï¼›æœ‰ä¸€æ¡æ¶ˆæ¯æœªè¢«æ¶ˆè´¹</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302062108663.png" alt="image-20230206210828079"></p><p>å¯åŠ¨ C2 æ¶ˆè´¹æ­»ä¿¡é˜Ÿåˆ—</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302062109067.png" alt="image-20230206210949858"></p><h2 id="7-å»¶è¿Ÿé˜Ÿåˆ—"><a href="#7-å»¶è¿Ÿé˜Ÿåˆ—" class="headerlink" title="7.å»¶è¿Ÿé˜Ÿåˆ—"></a>7.å»¶è¿Ÿé˜Ÿåˆ—</h2><h3 id="7-1-å»¶è¿Ÿé˜Ÿåˆ—çš„æ¦‚å¿µ"><a href="#7-1-å»¶è¿Ÿé˜Ÿåˆ—çš„æ¦‚å¿µ" class="headerlink" title="7.1 å»¶è¿Ÿé˜Ÿåˆ—çš„æ¦‚å¿µ"></a>7.1 å»¶è¿Ÿé˜Ÿåˆ—çš„æ¦‚å¿µ</h3><p>â€‹å»¶æ—¶é˜Ÿåˆ—,é˜Ÿåˆ—å†…éƒ¨æ˜¯æœ‰åºçš„ï¼Œæœ€é‡è¦çš„ç‰¹æ€§å°±ä½“ç°åœ¨å®ƒçš„å»¶æ—¶å±æ€§ä¸Šï¼Œå»¶æ—¶é˜Ÿåˆ—ä¸­çš„å…ƒç´ æ˜¯å¸Œæœ› åœ¨æŒ‡å®šæ—¶é—´åˆ°äº†ä»¥åæˆ–ä¹‹å‰å–å‡ºå’Œå¤„ç†ï¼Œç®€å•æ¥è¯´ï¼Œå»¶æ—¶é˜Ÿåˆ—å°±æ˜¯ç”¨æ¥å­˜æ”¾éœ€è¦åœ¨æŒ‡å®šæ—¶é—´è¢«å¤„ç†çš„ å…ƒç´ çš„é˜Ÿåˆ—ã€‚</p><h3 id="7-2-å»¶è¿Ÿé˜Ÿåˆ—ä½¿ç”¨åœºæ™¯"><a href="#7-2-å»¶è¿Ÿé˜Ÿåˆ—ä½¿ç”¨åœºæ™¯" class="headerlink" title="7.2 å»¶è¿Ÿé˜Ÿåˆ—ä½¿ç”¨åœºæ™¯"></a>7.2 å»¶è¿Ÿé˜Ÿåˆ—ä½¿ç”¨åœºæ™¯</h3><ol><li>è®¢å•åœ¨ååˆ†é’Ÿä¹‹å†…æœªæ”¯ä»˜åˆ™è‡ªåŠ¨å–æ¶ˆ</li><li>æ–°åˆ›å»ºçš„åº—é“ºï¼Œå¦‚æœåœ¨åå¤©å†…éƒ½æ²¡æœ‰ä¸Šä¼ è¿‡å•†å“ï¼Œåˆ™è‡ªåŠ¨å‘é€æ¶ˆæ¯æé†’ã€‚ </li><li>ç”¨æˆ·æ³¨å†ŒæˆåŠŸåï¼Œå¦‚æœä¸‰å¤©å†…æ²¡æœ‰ç™»é™†åˆ™è¿›è¡ŒçŸ­ä¿¡æé†’ã€‚ </li><li>ç”¨æˆ·å‘èµ·é€€æ¬¾ï¼Œå¦‚æœä¸‰å¤©å†…æ²¡æœ‰å¾—åˆ°å¤„ç†åˆ™é€šçŸ¥ç›¸å…³è¿è¥äººå‘˜ã€‚ </li><li>é¢„å®šä¼šè®®åï¼Œéœ€è¦åœ¨é¢„å®šçš„æ—¶é—´ç‚¹å‰ååˆ†é’Ÿé€šçŸ¥å„ä¸ªä¸ä¼šäººå‘˜å‚åŠ ä¼šè®®</li></ol><p>â€‹è¿™äº›åœºæ™¯éƒ½æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œéœ€è¦åœ¨æŸä¸ªäº‹ä»¶å‘ç”Ÿä¹‹åæˆ–è€…ä¹‹å‰çš„æŒ‡å®šæ—¶é—´ç‚¹å®ŒæˆæŸä¸€é¡¹ä»»åŠ¡ï¼Œå¦‚ï¼š å‘ç”Ÿè®¢å•ç”Ÿæˆäº‹ä»¶ï¼Œåœ¨ååˆ†é’Ÿä¹‹åæ£€æŸ¥è¯¥è®¢å•æ”¯ä»˜çŠ¶æ€ï¼Œç„¶åå°†æœªæ”¯ä»˜çš„è®¢å•è¿›è¡Œå…³é—­ï¼›çœ‹èµ·æ¥ä¼¼ä¹ ä½¿ç”¨å®šæ—¶ä»»åŠ¡ï¼Œä¸€ç›´è½®è¯¢æ•°æ®ï¼Œæ¯ç§’æŸ¥ä¸€æ¬¡ï¼Œå–å‡ºéœ€è¦è¢«å¤„ç†çš„æ•°æ®ï¼Œç„¶åå¤„ç†ä¸å°±å®Œäº‹äº†å—ï¼Ÿå¦‚æœ æ•°æ®é‡æ¯”è¾ƒå°‘ï¼Œç¡®å®å¯ä»¥è¿™æ ·åšï¼Œæ¯”å¦‚ï¼šå¯¹äºâ€œå¦‚æœè´¦å•ä¸€å‘¨å†…æœªæ”¯ä»˜åˆ™è¿›è¡Œè‡ªåŠ¨ç»“ç®—â€è¿™æ ·çš„éœ€æ±‚ï¼Œ å¦‚æœå¯¹äºæ—¶é—´ä¸æ˜¯ä¸¥æ ¼é™åˆ¶ï¼Œè€Œæ˜¯å®½æ¾æ„ä¹‰ä¸Šçš„ä¸€å‘¨ï¼Œé‚£ä¹ˆæ¯å¤©æ™šä¸Šè·‘ä¸ªå®šæ—¶ä»»åŠ¡æ£€æŸ¥ä¸€ä¸‹æ‰€æœ‰æœªæ”¯ ä»˜çš„è´¦å•ï¼Œç¡®å®ä¹Ÿæ˜¯ä¸€ä¸ªå¯è¡Œçš„æ–¹æ¡ˆã€‚ä½†å¯¹äºæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œå¹¶ä¸”æ—¶æ•ˆæ€§è¾ƒå¼ºçš„åœºæ™¯ï¼Œå¦‚ï¼šâ€œè®¢å•å åˆ†é’Ÿå†…æœªæ”¯ä»˜åˆ™å…³é—­â€œï¼ŒçŸ­æœŸå†…æœªæ”¯ä»˜çš„è®¢å•æ•°æ®å¯èƒ½ä¼šæœ‰å¾ˆå¤šï¼Œæ´»åŠ¨æœŸé—´ç”šè‡³ä¼šè¾¾åˆ°ç™¾ä¸‡ç”šè‡³åƒä¸‡ çº§åˆ«ï¼Œå¯¹è¿™ä¹ˆåºå¤§çš„æ•°æ®é‡ä»æ—§ä½¿ç”¨è½®è¯¢çš„æ–¹å¼æ˜¾ç„¶æ˜¯ä¸å¯å–çš„ï¼Œå¾ˆå¯èƒ½åœ¨ä¸€ç§’å†…æ— æ³•å®Œæˆæ‰€æœ‰è®¢å• çš„æ£€æŸ¥ï¼ŒåŒæ—¶ä¼šç»™æ•°æ®åº“å¸¦æ¥å¾ˆå¤§å‹åŠ›ï¼Œæ— æ³•æ»¡è¶³ä¸šåŠ¡è¦æ±‚è€Œä¸”æ€§èƒ½ä½ä¸‹ã€‚</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302081157842.png" alt="image-20230208115734612"></p><h3 id="7-3-RabbitMQ-ä¸­çš„-TTL"><a href="#7-3-RabbitMQ-ä¸­çš„-TTL" class="headerlink" title="7.3 RabbitMQ ä¸­çš„ TTL"></a>7.3 RabbitMQ ä¸­çš„ TTL</h3><p>â€‹TTL æ˜¯ä»€ä¹ˆå‘¢ï¼ŸTTL æ˜¯ RabbitMQ ä¸­ä¸€ä¸ªæ¶ˆæ¯æˆ–è€…é˜Ÿåˆ—çš„å±æ€§ï¼Œè¡¨æ˜ä¸€æ¡æ¶ˆæ¯æˆ–è€…è¯¥é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ æ¶ˆæ¯çš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼Œ</p><p>â€‹å•ä½æ˜¯æ¯«ç§’ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸€æ¡æ¶ˆæ¯è®¾ç½®äº† TTL å±æ€§æˆ–è€…è¿›å…¥äº†è®¾ç½® TTL å±æ€§çš„é˜Ÿåˆ—ï¼Œé‚£ä¹ˆè¿™ æ¡æ¶ˆæ¯å¦‚æœåœ¨ TTL è®¾ç½®çš„æ—¶é—´å†…æ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œåˆ™ä¼šæˆä¸ºâ€æ­»ä¿¡â€ã€‚å¦‚æœåŒæ—¶é…ç½®äº†é˜Ÿåˆ—çš„ TTL å’Œæ¶ˆæ¯çš„ TTLï¼Œé‚£ä¹ˆè¾ƒå°çš„é‚£ä¸ªå€¼å°†ä¼šè¢«ä½¿ç”¨ï¼Œæœ‰ä¸¤ç§æ–¹å¼è®¾ç½® TTLã€‚</p><h3 id="7-4-æ•´åˆ-springboot"><a href="#7-4-æ•´åˆ-springboot" class="headerlink" title="7.4 æ•´åˆ springboot"></a>7.4 æ•´åˆ springboot</h3><h4 id="7-4-1-åˆ›å»ºé¡¹ç›®"><a href="#7-4-1-åˆ›å»ºé¡¹ç›®" class="headerlink" title="7.4.1 åˆ›å»ºé¡¹ç›®"></a>7.4.1 åˆ›å»ºé¡¹ç›®</h4><ol><li>åˆ›å»º spring initializr<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302081200689.png" alt="image-20230208120020531"></li></ol><h4 id="7-4-2æ·»åŠ ä¾èµ–"><a href="#7-4-2æ·»åŠ ä¾èµ–" class="headerlink" title="7.4.2æ·»åŠ ä¾èµ–"></a>7.4.2æ·»åŠ ä¾èµ–</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;!--RabbitMQ ä¾èµ–--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class="line">&lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;fastjson&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;<span class="number">1.2</span><span class="number">.47</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;!--swagger--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;<span class="number">2.9</span><span class="number">.2</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;<span class="number">2.9</span><span class="number">.2</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;!--RabbitMQ æµ‹è¯•ä¾èµ–--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.amqp&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-rabbit-test&lt;/artifactId&gt;</span><br><span class="line">&lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure><h4 id="7-4-3-ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#7-4-3-ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="7.4.3 ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>7.4.3 ä¿®æ”¹é…ç½®æ–‡ä»¶</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  rabbitmq:</span><br><span class="line">    host: <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">    port: <span class="number">5672</span></span><br><span class="line">    username: admin</span><br><span class="line">    password: <span class="number">123</span></span><br><span class="line">server:</span><br><span class="line">  port: <span class="number">8088</span></span><br></pre></td></tr></table></figure><h4 id="7-4-4-æ·»åŠ -Swagger-é…ç½®ç±»"><a href="#7-4-4-æ·»åŠ -Swagger-é…ç½®ç±»" class="headerlink" title="7.4.4 æ·»åŠ  Swagger é…ç½®ç±»"></a>7.4.4 æ·»åŠ  Swagger é…ç½®ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mofeng.rabbitmq.springbootrabbitmq.config;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.Contact;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SwaggerConfig</span> &#123;</span><br><span class="line"> <span class="meta">@Bean</span></span><br><span class="line"> <span class="keyword">public</span> Docket <span class="title function_">webApiConfig</span><span class="params">()</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2)</span><br><span class="line"> .groupName(<span class="string">&quot;webApi&quot;</span>)</span><br><span class="line"> .apiInfo(webApiInfo())</span><br><span class="line"> .select()</span><br><span class="line"> .build();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">private</span> ApiInfo <span class="title function_">webApiInfo</span><span class="params">()</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApiInfoBuilder</span>()</span><br><span class="line"> .title(<span class="string">&quot;rabbitmq æ¥å£æ–‡æ¡£&quot;</span>)</span><br><span class="line"> .description(<span class="string">&quot;æœ¬æ–‡æ¡£æè¿°äº† rabbitmq å¾®æœåŠ¡æ¥å£å®šä¹‰&quot;</span>)</span><br><span class="line"> .version(<span class="string">&quot;1.0&quot;</span>)</span><br><span class="line"> .contact(<span class="keyword">new</span> <span class="title class_">Contact</span>(<span class="string">&quot;enjoy6288&quot;</span>, <span class="string">&quot;inkmaple.xyz&quot;</span>, </span><br><span class="line"><span class="string">&quot;2435301806@qq.com&quot;</span>))</span><br><span class="line"> .build();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="7-5-é˜Ÿåˆ—-TTL"><a href="#7-5-é˜Ÿåˆ—-TTL" class="headerlink" title="7.5 é˜Ÿåˆ— TTL"></a>7.5 é˜Ÿåˆ— TTL</h3><h4 id="7-5-1-ä»£ç ç»“æ„å›¾"><a href="#7-5-1-ä»£ç ç»“æ„å›¾" class="headerlink" title="7.5.1 ä»£ç ç»“æ„å›¾"></a>7.5.1 ä»£ç ç»“æ„å›¾</h4><p>â€‹åˆ›å»ºä¸¤ä¸ªé˜Ÿåˆ— QA å’Œ QBï¼Œä¸¤è€…é˜Ÿåˆ— TTL åˆ†åˆ«è®¾ç½®ä¸º 10S å’Œ 40Sï¼Œç„¶ååœ¨åˆ›å»ºä¸€ä¸ªäº¤æ¢æœº X å’Œæ­»ä¿¡äº¤ æ¢æœº Yï¼Œå®ƒä»¬çš„ç±»å‹éƒ½æ˜¯ directï¼Œåˆ›å»ºä¸€ä¸ªæ­»ä¿¡é˜Ÿåˆ— QDï¼Œå®ƒä»¬çš„ç»‘å®šå…³ç³»å¦‚ä¸‹ï¼š</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302081233133.png" alt="image-20230208123334952"></p><h4 id="7-5-2-é…ç½®æ–‡ä»¶ç±»ä»£ç "><a href="#7-5-2-é…ç½®æ–‡ä»¶ç±»ä»£ç " class="headerlink" title="7.5.2 é…ç½®æ–‡ä»¶ç±»ä»£ç "></a>7.5.2 é…ç½®æ–‡ä»¶ç±»ä»£ç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TTL é˜Ÿåˆ— é…ç½®æ–‡ä»¶ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/8 12:34</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TtlQueueConfig</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">X_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;X&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_A</span> <span class="operator">=</span> <span class="string">&quot;QA&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_B</span> <span class="operator">=</span> <span class="string">&quot;QB&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">Y_DEAD_LETTER_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;Y&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_LETTER_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;QD&quot;</span>;</span><br><span class="line">    <span class="comment">// å£°æ˜ xExchange</span></span><br><span class="line">    <span class="meta">@Bean(&quot;xExchange&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">xExchange</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DirectExchange</span>(X_EXCHANGE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å£°æ˜ xExchange</span></span><br><span class="line">    <span class="meta">@Bean(&quot;yExchange&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">yExchange</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DirectExchange</span>(Y_DEAD_LETTER_EXCHANGE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å£°æ˜é˜Ÿåˆ— A ttl ä¸º 10s å¹¶ç»‘å®šåˆ°å¯¹åº”çš„æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean(&quot;queueA&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">queueA</span><span class="params">()</span>&#123;</span><br><span class="line">        Map&lt;String, Object&gt; args = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">3</span>);</span><br><span class="line">        <span class="comment">//å£°æ˜å½“å‰é˜Ÿåˆ—ç»‘å®šçš„æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">        args.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, Y_DEAD_LETTER_EXCHANGE);</span><br><span class="line">        <span class="comment">//å£°æ˜å½“å‰é˜Ÿåˆ—çš„æ­»ä¿¡è·¯ç”± key</span></span><br><span class="line">        args.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;YD&quot;</span>);</span><br><span class="line">        <span class="comment">//å£°æ˜é˜Ÿåˆ—çš„ TTL</span></span><br><span class="line">        args.put(<span class="string">&quot;x-message-ttl&quot;</span>, <span class="number">10000</span>);</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(QUEUE_A).withArguments(args).build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å£°æ˜é˜Ÿåˆ— A ç»‘å®š X äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">queueaBindingX</span><span class="params">(<span class="meta">@Qualifier(&quot;queueA&quot;)</span> Queue queueA,</span></span><br><span class="line"><span class="params">                                  <span class="meta">@Qualifier(&quot;xExchange&quot;)</span> DirectExchange xExchange)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queueA).to(xExchange).with(<span class="string">&quot;XA&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å£°æ˜é˜Ÿåˆ— B ttl ä¸º 40s å¹¶ç»‘å®šåˆ°å¯¹åº”çš„æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean(&quot;queueB&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">queueB</span><span class="params">()</span>&#123;</span><br><span class="line">        Map&lt;String, Object&gt; args = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">3</span>);</span><br><span class="line">        <span class="comment">//å£°æ˜å½“å‰é˜Ÿåˆ—ç»‘å®šçš„æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">        args.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, Y_DEAD_LETTER_EXCHANGE);</span><br><span class="line">        <span class="comment">//å£°æ˜å½“å‰é˜Ÿåˆ—çš„æ­»ä¿¡è·¯ç”± key</span></span><br><span class="line">        args.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;YD&quot;</span>);</span><br><span class="line">        <span class="comment">//å£°æ˜é˜Ÿåˆ—çš„ TTL</span></span><br><span class="line">        args.put(<span class="string">&quot;x-message-ttl&quot;</span>, <span class="number">40000</span>);</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(QUEUE_B).withArguments(args).build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å£°æ˜é˜Ÿåˆ— B ç»‘å®š X äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">queuebBindingX</span><span class="params">(<span class="meta">@Qualifier(&quot;queueB&quot;)</span> Queue queue1B,</span></span><br><span class="line"><span class="params">                                  <span class="meta">@Qualifier(&quot;xExchange&quot;)</span> DirectExchange xExchange)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue1B).to(xExchange).with(<span class="string">&quot;XB&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å£°æ˜æ­»ä¿¡é˜Ÿåˆ— QD</span></span><br><span class="line">    <span class="meta">@Bean(&quot;queueD&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">queueD</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(DEAD_LETTER_QUEUE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å£°æ˜æ­»ä¿¡é˜Ÿåˆ— QD ç»‘å®šå…³ç³»</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">deadLetterBindingQAD</span><span class="params">(<span class="meta">@Qualifier(&quot;queueD&quot;)</span> Queue queueD,</span></span><br><span class="line"><span class="params">                                        <span class="meta">@Qualifier(&quot;yExchange&quot;)</span> DirectExchange yExchange)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queueD).to(yExchange).with(<span class="string">&quot;YD&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="7-5-3-æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç "><a href="#7-5-3-æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç " class="headerlink" title="7.5.3 æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç "></a>7.5.3 æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å‘é€å»¶è¿Ÿæ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> * http://localhost:8080/ttl/sendMsg/å˜»å˜»å˜»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/8 13:05</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/ttl&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SendMsgController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼€å§‹å‘æ¶ˆæ¯</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/sendMsg/&#123;message&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMsg</span><span class="params">(<span class="meta">@PathVariable</span> String message)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;å½“å‰æ—¶é—´ï¼š&#123;&#125;, å‘é€ä¸€æ¡ä¿¡æ¯ç»™ä¸¤ä¸ª TTL é˜Ÿåˆ—ï¼š&#123;&#125;&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>().toString(), message);</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;X&quot;</span>, <span class="string">&quot;XA&quot;</span>, <span class="string">&quot;æ¶ˆæ¯æ¥è‡ª TTL ä¸º 10s çš„é˜Ÿåˆ—ï¼š&quot;</span> + message);</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;X&quot;</span>, <span class="string">&quot;XB&quot;</span>, <span class="string">&quot;æ¶ˆæ¯æ¥è‡ª TTL ä¸º 40s çš„é˜Ÿåˆ—ï¼š&quot;</span> + message);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-5-4-æ¶ˆæ¯æ¶ˆè´¹è€…ä»£ç "><a href="#7-5-4-æ¶ˆæ¯æ¶ˆè´¹è€…ä»£ç " class="headerlink" title="7.5.4 æ¶ˆæ¯æ¶ˆè´¹è€…ä»£ç "></a>7.5.4 æ¶ˆæ¯æ¶ˆè´¹è€…ä»£ç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: é˜Ÿåˆ— TTL çš„æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/8 13:14</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeadLetterQueueConsumer</span> &#123;</span><br><span class="line">    <span class="comment">//æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;QD&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveD</span><span class="params">(Message message, Channel channel)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody());</span><br><span class="line">        log.info(<span class="string">&quot;å½“å‰æ—¶é—´ï¼š&#123;&#125;,æ”¶åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¿¡æ¯&#123;&#125;&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>().toString(), msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="7-5-5-å¯åŠ¨ç±»å¤±è´¥"><a href="#7-5-5-å¯åŠ¨ç±»å¤±è´¥" class="headerlink" title="7.5.5 å¯åŠ¨ç±»å¤±è´¥"></a>7.5.5 å¯åŠ¨ç±»å¤±è´¥</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302081343513.png" alt="image-20230208134356194"></p><p><strong>è§£å†³æ–¹æ¡ˆï¼šåœ¨å¯åŠ¨ç±»æ·»åŠ æ³¨è§£ @EnableWebMvc</strong></p><h4 id="7-5-6-å‘é€æ¶ˆæ¯æŠ¥é”™"><a href="#7-5-6-å‘é€æ¶ˆæ¯æŠ¥é”™" class="headerlink" title="7.5.6 å‘é€æ¶ˆæ¯æŠ¥é”™"></a>7.5.6 å‘é€æ¶ˆæ¯æŠ¥é”™</h4><p>å‘é€<a href="http://localhost:8088/ttl/sendMsg/xxx">http://localhost:8088/ttl/sendMsg/xxx</a></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302081347300.png" alt="image-20230208134739893"></p><p>æ£€æŸ¥ controller ç±»çš„ Mapping æ˜¯å¦æ­£ç¡®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/ttl&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/sendMsg/&#123;message&#125;&quot;)</span></span><br></pre></td></tr></table></figure><h4 id="7-5-7-Channel-å¯¼åŒ…é”™è¯¯"><a href="#7-5-7-Channel-å¯¼åŒ…é”™è¯¯" class="headerlink" title="7.5.7 Channel å¯¼åŒ…é”™è¯¯"></a>7.5.7 Channel å¯¼åŒ…é”™è¯¯</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302081402510.png" alt="image-20230208140219774"></p><p>é”™è¯¯çš„åŒ…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.nio.channels.Channel;</span><br></pre></td></tr></table></figure><p>å¯¼å…¥æ­£ç¡®çš„åŒ…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br></pre></td></tr></table></figure><h4 id="7-5-8-ç»“æœå±•ç¤º"><a href="#7-5-8-ç»“æœå±•ç¤º" class="headerlink" title="7.5.8 ç»“æœå±•ç¤º"></a>7.5.8 ç»“æœå±•ç¤º</h4><p>10s å’Œ 40s åä¼šåœ¨æ§åˆ¶å°è¾“å‡ºç»“æœ</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302081406242.png" alt="image-20230208140621305"></p><p>â€‹ç¬¬ä¸€æ¡æ¶ˆæ¯åœ¨ 10S åå˜æˆäº†æ­»ä¿¡æ¶ˆæ¯ï¼Œç„¶åè¢«æ¶ˆè´¹è€…æ¶ˆè´¹æ‰ï¼Œç¬¬äºŒæ¡æ¶ˆæ¯åœ¨ 40S ä¹‹åå˜æˆäº†æ­»ä¿¡æ¶ˆæ¯ï¼Œ ç„¶åè¢«æ¶ˆè´¹æ‰ï¼Œè¿™æ ·ä¸€ä¸ªå»¶æ—¶é˜Ÿåˆ—å°±æ‰“é€ å®Œæˆäº†ã€‚</p><p>â€‹ä¸è¿‡ï¼Œå¦‚æœè¿™æ ·ä½¿ç”¨çš„è¯ï¼Œå²‚ä¸æ˜¯<strong>æ¯å¢åŠ ä¸€ä¸ªæ–°çš„æ—¶é—´éœ€æ±‚ï¼Œå°±è¦æ–°å¢ä¸€ä¸ªé˜Ÿåˆ—</strong>ï¼Œè¿™é‡Œåªæœ‰ 10S å’Œ 40S ä¸¤ä¸ªæ—¶é—´é€‰é¡¹ï¼Œå¦‚æœéœ€è¦ä¸€ä¸ªå°æ—¶åå¤„ç†ï¼Œé‚£ä¹ˆå°±éœ€è¦å¢åŠ  TTL ä¸ºä¸€ä¸ªå°æ—¶çš„é˜Ÿåˆ—ï¼Œå¦‚æœæ˜¯é¢„å®šä¼šè®®å®¤ç„¶ åæå‰é€šçŸ¥è¿™æ ·çš„åœºæ™¯ï¼Œå²‚ä¸æ˜¯è¦å¢åŠ æ— æ•°ä¸ªé˜Ÿåˆ—æ‰èƒ½æ»¡è¶³éœ€æ±‚ï¼Ÿ</p><h3 id="7-6-å»¶æ—¶é˜Ÿåˆ—ä¼˜åŒ–"><a href="#7-6-å»¶æ—¶é˜Ÿåˆ—ä¼˜åŒ–" class="headerlink" title="7.6 å»¶æ—¶é˜Ÿåˆ—ä¼˜åŒ–"></a>7.6 å»¶æ—¶é˜Ÿåˆ—ä¼˜åŒ–</h3><h4 id="7-6-1-ä»£ç æ¶æ„å›¾"><a href="#7-6-1-ä»£ç æ¶æ„å›¾" class="headerlink" title="7.6.1 ä»£ç æ¶æ„å›¾"></a>7.6.1 ä»£ç æ¶æ„å›¾</h4><p>â€‹åœ¨è¿™é‡Œæ–°å¢äº†ä¸€ä¸ªé˜Ÿåˆ— QC,ç»‘å®šå…³ç³»å¦‚ä¸‹,è¯¥é˜Ÿåˆ—ä¸è®¾ç½® TTL æ—¶é—´</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302081636571.png" alt="image-20230208163609478"></p><h4 id="7-6-2-é…ç½®æ–‡ä»¶ç±»æ·»åŠ ä»£ç "><a href="#7-6-2-é…ç½®æ–‡ä»¶ç±»æ·»åŠ ä»£ç " class="headerlink" title="7.6.2 é…ç½®æ–‡ä»¶ç±»æ·»åŠ ä»£ç "></a>7.6.2 é…ç½®æ–‡ä»¶ç±»æ·»åŠ ä»£ç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MsgTtlQueueConfig</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">Y_DEAD_LETTER_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;Y&quot;</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_C</span> <span class="operator">=</span> <span class="string">&quot;QC&quot;</span>;</span><br><span class="line"> <span class="comment">//å£°æ˜é˜Ÿåˆ— C æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line"> <span class="meta">@Bean(&quot;queueC&quot;)</span></span><br><span class="line"> <span class="keyword">public</span> Queue <span class="title function_">queueB</span><span class="params">()</span>&#123;</span><br><span class="line"> Map&lt;String, Object&gt; args = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">3</span>);</span><br><span class="line"> <span class="comment">//å£°æ˜å½“å‰é˜Ÿåˆ—ç»‘å®šçš„æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line"> args.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, Y_DEAD_LETTER_EXCHANGE);</span><br><span class="line"> <span class="comment">//å£°æ˜å½“å‰é˜Ÿåˆ—çš„æ­»ä¿¡è·¯ç”± key</span></span><br><span class="line"> args.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;YD&quot;</span>);</span><br><span class="line"> <span class="comment">//æ²¡æœ‰å£°æ˜ TTL å±æ€§</span></span><br><span class="line"> <span class="keyword">return</span> QueueBuilder.durable(QUEUE_C).withArguments(args).build();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//å£°æ˜é˜Ÿåˆ— B ç»‘å®š X äº¤æ¢æœº</span></span><br><span class="line"> <span class="meta">@Bean</span></span><br><span class="line"> <span class="keyword">public</span> Binding <span class="title function_">queuecBindingX</span><span class="params">(<span class="meta">@Qualifier(&quot;queueC&quot;)</span> Queue queueC,</span></span><br><span class="line"><span class="params"> <span class="meta">@Qualifier(&quot;xExchange&quot;)</span> DirectExchange xExchange)</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> BindingBuilder.bind(queueC).to(xExchange).with(<span class="string">&quot;XC&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-6-3-æ¶ˆæ¯ç”Ÿäº§è€…æ·»åŠ ä»£ç "><a href="#7-6-3-æ¶ˆæ¯ç”Ÿäº§è€…æ·»åŠ ä»£ç " class="headerlink" title="7.6.3 æ¶ˆæ¯ç”Ÿäº§è€…æ·»åŠ ä»£ç "></a>7.6.3 æ¶ˆæ¯ç”Ÿäº§è€…æ·»åŠ ä»£ç </h4><p>åœ¨æ§åˆ¶ç±»ä¸­æ·»åŠ  sendMsg æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;sendExpirationMsg/&#123;message&#125;/&#123;ttlTime&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMsg</span><span class="params">(<span class="meta">@PathVariable</span> String message,<span class="meta">@PathVariable</span> String ttlTime)</span> &#123;</span><br><span class="line"> rabbitTemplate.convertAndSend(<span class="string">&quot;X&quot;</span>, <span class="string">&quot;XC&quot;</span>, message, correlationData -&gt;&#123;</span><br><span class="line"> correlationData.getMessageProperties().setExpiration(ttlTime);</span><br><span class="line"> <span class="keyword">return</span> correlationData;</span><br><span class="line"> &#125;);</span><br><span class="line"> log.info(<span class="string">&quot;å½“å‰æ—¶é—´ï¼š&#123;&#125;,å‘é€ä¸€æ¡æ—¶é•¿&#123;&#125;æ¯«ç§’ TTL ä¿¡æ¯ç»™é˜Ÿåˆ— C:&#123;&#125;&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>(),ttlTime, message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘èµ·è¯·æ±‚ </p><ul><li><p><a href="http://localhost:8080/ttl/sendExpirationMsg/%E4%BD%A0%E5%A5%BD">http://localhost:8080/ttl/sendExpirationMsg/ä½ å¥½</a> 1&#x2F;20000 </p></li><li><p><a href="http://localhost:8080/ttl/sendExpirationMsg/%E4%BD%A0%E5%A5%BD">http://localhost:8080/ttl/sendExpirationMsg/ä½ å¥½</a> 2&#x2F;2000</p></li></ul><p>æ§åˆ¶å°è¾“å‡ºç»“æœ</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302081646330.png" alt="image-20230208164611943"></p><p>â€‹çœ‹èµ·æ¥ä¼¼ä¹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯åœ¨æœ€å¼€å§‹çš„æ—¶å€™ï¼Œå°±ä»‹ç»è¿‡å¦‚æœä½¿ç”¨åœ¨æ¶ˆæ¯å±æ€§ä¸Šè®¾ç½® TTL çš„æ–¹å¼ï¼Œæ¶ˆ æ¯å¯èƒ½å¹¶ä¸ä¼šæŒ‰æ—¶â€œæ­»äº¡â€œï¼Œå› ä¸º <strong>RabbitMQ åªä¼šæ£€æŸ¥ç¬¬ä¸€ä¸ªæ¶ˆæ¯æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸåˆ™ä¸¢åˆ°æ­»ä¿¡é˜Ÿåˆ—ï¼Œ å¦‚æœç¬¬ä¸€ä¸ªæ¶ˆæ¯çš„å»¶æ—¶æ—¶é•¿å¾ˆé•¿ï¼Œè€Œç¬¬äºŒä¸ªæ¶ˆæ¯çš„å»¶æ—¶æ—¶é•¿å¾ˆçŸ­ï¼Œç¬¬äºŒä¸ªæ¶ˆæ¯å¹¶ä¸ä¼šä¼˜å…ˆå¾—åˆ°æ‰§è¡Œã€‚</strong></p><p>â€‹<strong>é˜Ÿåˆ—ä¸­ï¼Œå®è¡Œå…ˆè¿›å…ˆå‡ºçš„åŸåˆ™</strong></p><h3 id="7-7-RabbitMQ-æ’ä»¶å®ç°å»¶è¿Ÿé˜Ÿåˆ—"><a href="#7-7-RabbitMQ-æ’ä»¶å®ç°å»¶è¿Ÿé˜Ÿåˆ—" class="headerlink" title="7.7 RabbitMQ æ’ä»¶å®ç°å»¶è¿Ÿé˜Ÿåˆ—"></a>7.7 RabbitMQ æ’ä»¶å®ç°å»¶è¿Ÿé˜Ÿåˆ—</h3><p>â€‹ä¸Šæ–‡ä¸­æåˆ°çš„é—®é¢˜ï¼Œç¡®å®æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœä¸èƒ½å®ç°åœ¨æ¶ˆæ¯ç²’åº¦ä¸Šçš„ TTLï¼Œå¹¶ä½¿å…¶åœ¨è®¾ç½®çš„ TTL æ—¶é—´ åŠæ—¶æ­»äº¡ï¼Œå°±æ— æ³•è®¾è®¡æˆä¸€ä¸ªé€šç”¨çš„å»¶æ—¶é˜Ÿåˆ—ã€‚é‚£å¦‚ä½•è§£å†³å‘¢ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å»è§£å†³è¯¥é—®é¢˜ã€‚</p><h4 id="7-7-1-å®‰è£…å»¶æ—¶é˜Ÿåˆ—æ’ä»¶"><a href="#7-7-1-å®‰è£…å»¶æ—¶é˜Ÿåˆ—æ’ä»¶" class="headerlink" title="7.7.1 å®‰è£…å»¶æ—¶é˜Ÿåˆ—æ’ä»¶"></a>7.7.1 å®‰è£…å»¶æ—¶é˜Ÿåˆ—æ’ä»¶</h4><p>å®˜ç½‘ä¸‹è½½ <a href="https://www.rabbitmq.com/community-plugins.html">https://www.rabbitmq.com/community-plugins.html</a></p><p>ä¸‹è½½ rabbitmq_delayed_message_exchange æ’ä»¶ï¼Œç„¶åè§£å‹æ”¾ç½®åˆ° RabbitMQ çš„æ’ä»¶ç›®å½•ã€‚</p><p>å‚è€ƒä¸‹è½½å’Œå®‰è£…æ–‡ç« ï¼š<a href="https://blog.csdn.net/u010404909/article/details/125329160">https://blog.csdn.net/u010404909/article/details/125329160</a></p><ol><li>ä¸‹è½½</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302081704718.png" alt="image-20230208170412118"></p><ol start="2"><li>ä¸‹è½½ä¹‹åä¸Šä¼ åˆ° plugins ç›®å½•ä¸‹</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302081708179.png" alt="image-20230208170850734"></p><ol start="3"><li>è¿›å…¥ rabbitmq çš„æ’ä»¶ç›®å½•</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/lib/rabbitmq/lib/rabbitmq_server-<span class="number">3.8</span><span class="number">.8</span>/plugins</span><br></pre></td></tr></table></figure><ol start="4"><li>å®‰è£</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitmq-plugins enable rabbitmq_delayed_message_exchange</span><br></pre></td></tr></table></figure><ol start="5"><li>é‡å¯ RabbitMQ</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart rabbitmq-server</span><br></pre></td></tr></table></figure><ol start="6"><li>é‡å¯ä¹‹ååœ¨ RabbitMQ æ§åˆ¶åå°å¦‚ä¸‹æ˜¾ç¤ºå³å¯</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302081711108.png" alt="image-20230208171155972"></p><h4 id="7-7-2-ä»£ç æ¶æ„å›¾"><a href="#7-7-2-ä»£ç æ¶æ„å›¾" class="headerlink" title="7.7.2 ä»£ç æ¶æ„å›¾"></a>7.7.2 ä»£ç æ¶æ„å›¾</h4><p>â€‹åœ¨è¿™é‡Œæ–°å¢äº†ä¸€ä¸ªé˜Ÿåˆ— delayed.queue,ä¸€ä¸ªè‡ªå®šä¹‰äº¤æ¢æœº delayed.exchangeï¼Œç»‘å®šå…³ç³»å¦‚ä¸‹:</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302082121961.png" alt="image-20230208212145760"></p><h4 id="7-7-3-é…ç½®æ–‡ä»¶ç±»-DelayedQueueConfig"><a href="#7-7-3-é…ç½®æ–‡ä»¶ç±»-DelayedQueueConfig" class="headerlink" title="7.7.3 é…ç½®æ–‡ä»¶ç±» DelayedQueueConfig"></a>7.7.3 é…ç½®æ–‡ä»¶ç±» DelayedQueueConfig</h4><p>â€‹åœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„äº¤æ¢æœºä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ–°çš„äº¤æ¢ç±»å‹ï¼Œè¯¥ç±»å‹æ¶ˆæ¯æ”¯æŒå»¶è¿ŸæŠ•é€’æœºåˆ¶ æ¶ˆæ¯ä¼ é€’åå¹¶ä¸ä¼šç«‹å³æŠ•é€’åˆ°ç›®æ ‡é˜Ÿåˆ—ä¸­ï¼Œè€Œæ˜¯å­˜å‚¨åœ¨ mnesia(ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®ç³»ç»Ÿ)è¡¨ä¸­ï¼Œå½“è¾¾åˆ°æŠ•é€’æ—¶é—´æ—¶ï¼Œæ‰ æŠ•é€’åˆ°ç›®æ ‡é˜Ÿåˆ—ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DelayedQueueConfig</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DELAYED_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;delayed.queue&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DELAYED_EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;delayed.exchange&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DELAYED_ROUTING_KEY</span> <span class="operator">=</span> <span class="string">&quot;delayed.routingkey&quot;</span>;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">delayedQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(DELAYED_QUEUE_NAME);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è‡ªå®šä¹‰äº¤æ¢æœº æˆ‘ä»¬åœ¨è¿™é‡Œå®šä¹‰çš„æ˜¯ä¸€ä¸ªå»¶è¿Ÿäº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CustomExchange <span class="title function_">delayedExchange</span><span class="params">()</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; args = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//è‡ªå®šä¹‰äº¤æ¢æœºçš„ç±»å‹</span></span><br><span class="line">        args.put(<span class="string">&quot;x-delayed-type&quot;</span>, <span class="string">&quot;direct&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CustomExchange</span>(DELAYED_EXCHANGE_NAME, <span class="string">&quot;x-delayed-message&quot;</span>, <span class="literal">true</span>, <span class="literal">false</span>,</span><br><span class="line">                args);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingDelayedQueue</span><span class="params">(<span class="meta">@Qualifier(&quot;delayedQueue&quot;)</span> Queue queue,</span></span><br><span class="line"><span class="params">                                       <span class="meta">@Qualifier(&quot;delayedExchange&quot;)</span> CustomExchange</span></span><br><span class="line"><span class="params">                                               delayedExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">                BindingBuilder.bind(queue).to(delayedExchange).with(DELAYED_ROUTING_KEY).noargs();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-7-4-æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç "><a href="#7-7-4-æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç " class="headerlink" title="7.7.4 æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç "></a>7.7.4 æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DELAYED_EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;delayed.exchange&quot;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DELAYED_ROUTING_KEY</span> <span class="operator">=</span> <span class="string">&quot;delayed.routingkey&quot;</span>;</span><br><span class="line"><span class="comment">// åŸºäºæ’ä»¶çš„ å¼€å§‹å‘æ¶ˆæ¯ æ¶ˆæ¯ ä»¥åŠ å»¶è¿Ÿçš„æ—¶é—´</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/sendDelayMsg/&#123;message&#125;/&#123;delayTime&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMsg</span><span class="params">(<span class="meta">@PathVariable</span> String message, <span class="meta">@PathVariable</span> Integer delayTime)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;å½“å‰æ—¶é—´ï¼š&#123;&#125;, å‘é€ä¸€æ¡æ—¶é•¿ &#123;&#125; æ¯«ç§’ ä¿¡æ¯ç»™å»¶è¿Ÿé˜Ÿåˆ—delayed.queue ï¼š&#123;&#125;&quot;</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Date</span>().toString(), delayTime, message);</span><br><span class="line">        rabbitTemplate.convertAndSend(DelayedQueueConfig.DELAYED_EXCHANGE_NAME, DelayedQueueConfig.DELAYED_ROUTING_KEY, message, msg -&gt;&#123;</span><br><span class="line">            <span class="comment">// å‘é€æ¶ˆæ¯çš„æ—¶å€™ å»¶é•¿æ—¶é•¿ å•ä½æ˜¯ ms</span></span><br><span class="line">            msg.getMessageProperties().setDelay(delayTime);</span><br><span class="line">            <span class="keyword">return</span> msg;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="7-7-5-æ¶ˆæ¯æ¶ˆè´¹è€…ä»£ç "><a href="#7-7-5-æ¶ˆæ¯æ¶ˆè´¹è€…ä»£ç " class="headerlink" title="7.7.5 æ¶ˆæ¯æ¶ˆè´¹è€…ä»£ç "></a>7.7.5 æ¶ˆæ¯æ¶ˆè´¹è€…ä»£ç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: åŸºäºçš„æ’ä»¶å»¶è¿Ÿæ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/8 21:03</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DelayQueueConsumer</span> &#123;</span><br><span class="line">    <span class="comment">// ç›‘å¬æ¶ˆæ¯</span></span><br><span class="line">    <span class="meta">@RabbitListener(queues = DelayedQueueConfig.DELAYED_QUEUE_NAME)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveDelayQueue</span><span class="params">(Message message)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody());</span><br><span class="line">        log.info(<span class="string">&quot;å½“å‰æ—¶é—´ï¼š&#123;&#125;ï¼Œ æ”¶åˆ°å»¶è¿Ÿé˜Ÿåˆ—çš„æ¶ˆæ¯ï¼š&#123;&#125;&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>().toString(), msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-7-6-ç»“æœå±•ç¤º"><a href="#7-7-6-ç»“æœå±•ç¤º" class="headerlink" title="7.7.6 ç»“æœå±•ç¤º"></a>7.7.6 ç»“æœå±•ç¤º</h4><p>å‘é€è¯·æ±‚ï¼š</p><ul><li><a href="http://localhost:8080/ttl/sendDelayMsg/come">http://localhost:8080/ttl/sendDelayMsg/come</a> on baby1&#x2F;20000</li><li><a href="http://localhost:8080/ttl/sendDelayMsg/come">http://localhost:8080/ttl/sendDelayMsg/come</a> on baby2&#x2F;2000</li></ul><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302082126200.png" alt="image-20230208212615797"></p><p>ç¬¬äºŒä¸ªæ¶ˆæ¯è¢«æ¶ˆè´¹æ‰ï¼Œå¤åˆé¢„æœŸ</p><h3 id="7-8-æ€»ç»“"><a href="#7-8-æ€»ç»“" class="headerlink" title="7.8 æ€»ç»“"></a>7.8 æ€»ç»“</h3><p>â€‹å»¶æ—¶é˜Ÿåˆ—åœ¨éœ€è¦å»¶æ—¶å¤„ç†çš„åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ï¼Œä½¿ç”¨ RabbitMQ æ¥å®ç°å»¶æ—¶é˜Ÿåˆ—å¯ä»¥å¾ˆå¥½çš„åˆ©ç”¨ RabbitMQ çš„ç‰¹æ€§ï¼Œå¦‚ï¼šæ¶ˆæ¯å¯é å‘é€ã€æ¶ˆæ¯å¯é æŠ•é€’ã€æ­»ä¿¡é˜Ÿåˆ—æ¥ä¿éšœæ¶ˆæ¯è‡³å°‘è¢«æ¶ˆè´¹ä¸€æ¬¡ä»¥åŠæœªè¢«æ­£ ç¡®å¤„ç†çš„æ¶ˆæ¯ä¸ä¼šè¢«ä¸¢å¼ƒã€‚å¦å¤–ï¼Œé€šè¿‡ RabbitMQ é›†ç¾¤çš„ç‰¹æ€§ï¼Œå¯ä»¥å¾ˆå¥½çš„è§£å†³å•ç‚¹æ•…éšœé—®é¢˜ï¼Œä¸ä¼šå› ä¸º å•ä¸ªèŠ‚ç‚¹æŒ‚æ‰å¯¼è‡´å»¶æ—¶é˜Ÿåˆ—ä¸å¯ç”¨æˆ–è€…æ¶ˆæ¯ä¸¢å¤±ã€‚</p><p>â€‹å½“ç„¶ï¼Œå»¶æ—¶é˜Ÿåˆ—è¿˜æœ‰å¾ˆå¤šå…¶å®ƒé€‰æ‹©ï¼Œæ¯”å¦‚åˆ©ç”¨ Java çš„ DelayQueueï¼Œåˆ©ç”¨ Redis çš„ zsetï¼Œåˆ©ç”¨ Quartz æˆ–è€…åˆ©ç”¨ kafka çš„æ—¶é—´è½®ï¼Œè¿™äº›æ–¹å¼å„æœ‰ç‰¹ç‚¹,çœ‹éœ€è¦é€‚ç”¨çš„åœºæ™¯</p><h2 id="8-å‘å¸ƒç¡®è®¤é«˜çº§"><a href="#8-å‘å¸ƒç¡®è®¤é«˜çº§" class="headerlink" title="8.å‘å¸ƒç¡®è®¤é«˜çº§"></a>8.å‘å¸ƒç¡®è®¤é«˜çº§</h2><p>â€‹åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç”±äºä¸€äº›ä¸æ˜åŸå› ï¼Œå¯¼è‡´ rabbitmq é‡å¯ï¼Œåœ¨ RabbitMQ é‡å¯æœŸé—´ç”Ÿäº§è€…æ¶ˆæ¯æŠ•é€’å¤±è´¥ï¼Œ å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼Œéœ€è¦æ‰‹åŠ¨å¤„ç†å’Œæ¢å¤ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å¼€å§‹æ€è€ƒï¼Œå¦‚ä½•æ‰èƒ½è¿›è¡Œ RabbitMQ çš„æ¶ˆæ¯å¯é æŠ•é€’å‘¢ï¼Ÿ ç‰¹åˆ«æ˜¯åœ¨è¿™æ ·æ¯”è¾ƒæç«¯çš„æƒ…å†µï¼ŒRabbitMQ é›†ç¾¤ä¸å¯ç”¨çš„æ—¶å€™ï¼Œæ— æ³•æŠ•é€’çš„æ¶ˆæ¯è¯¥å¦‚ä½•å¤„ç†å‘¢:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">åº” ç”¨ [xxx] åœ¨ [08-<span class="number">1516</span>:<span class="number">36</span>:<span class="number">04</span>] å‘ ç”Ÿ [ é”™è¯¯æ—¥å¿—å¼‚å¸¸ ] ï¼Œ alertId=[xxx] ã€‚ ç”±</span><br><span class="line">[org.springframework.amqp.rabbit.listener.BlockingQueueConsumer:start:<span class="number">620</span>] è§¦å‘ã€‚ </span><br><span class="line">åº”ç”¨ xxx å¯èƒ½åŸå› å¦‚ä¸‹</span><br><span class="line">æœåŠ¡åä¸ºï¼š </span><br><span class="line">å¼‚å¸¸ä¸ºï¼š org.springframework.amqp.rabbit.listener.BlockingQueueConsumer:start:<span class="number">620</span>, </span><br><span class="line">äº§ ç”Ÿ åŸ å›  å¦‚ ä¸‹ :<span class="number">1.</span>org.springframework.amqp.rabbit.listener.QueuesNotAvailableException: </span><br><span class="line">Cannot prepare queue <span class="keyword">for</span> listener. Either the queue doesn<span class="string">&#x27;t exist or the broker will not </span></span><br><span class="line"><span class="string">allow us to use it.||Consumer received fatal=false exception on startup:</span></span><br></pre></td></tr></table></figure><h3 id="8-1-å‘å¸ƒç¡®è®¤-springboot-ç‰ˆæœ¬"><a href="#8-1-å‘å¸ƒç¡®è®¤-springboot-ç‰ˆæœ¬" class="headerlink" title="8.1 å‘å¸ƒç¡®è®¤ springboot ç‰ˆæœ¬"></a>8.1 å‘å¸ƒç¡®è®¤ springboot ç‰ˆæœ¬</h3><h4 id="8-1-1-ç¡®è®¤æœºåˆ¶æ–¹æ¡ˆ"><a href="#8-1-1-ç¡®è®¤æœºåˆ¶æ–¹æ¡ˆ" class="headerlink" title="8.1.1 ç¡®è®¤æœºåˆ¶æ–¹æ¡ˆ"></a>8.1.1 ç¡®è®¤æœºåˆ¶æ–¹æ¡ˆ</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302082241533.png" alt="image-20230208224129404"></p><h4 id="8-1-2-ä»£ç æ¶æ„å›¾"><a href="#8-1-2-ä»£ç æ¶æ„å›¾" class="headerlink" title="8.1.2 ä»£ç æ¶æ„å›¾"></a>8.1.2 ä»£ç æ¶æ„å›¾</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302082242563.png" alt="image-20230208224247445"></p><h4 id="8-1-3-é…ç½®æ–‡ä»¶"><a href="#8-1-3-é…ç½®æ–‡ä»¶" class="headerlink" title="8.1.3 é…ç½®æ–‡ä»¶"></a>8.1.3 é…ç½®æ–‡ä»¶</h4><p>åœ¨ application.yml é…ç½®æ–‡ä»¶ä¸­æ·»åŠ </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">publisher-confirm-type:</span> <span class="string">correlated</span></span><br></pre></td></tr></table></figure><p>publisher-confirm-type æœ‰ä¸‰ç§å€¼ï¼š</p><ul><li>NONE ï¼šç¦ç”¨å‘å¸ƒç¡®è®¤æ¨¡å¼ï¼Œæ˜¯é»˜è®¤å€¼</li><li>CORRELATED ï¼šå‘å¸ƒæ¶ˆæ¯æˆåŠŸåˆ°äº¤æ¢å™¨åä¼šè§¦å‘å›è°ƒæ–¹æ³•</li><li>SIMPLE</li></ul><p>â€‹ç»æµ‹è¯•æœ‰ä¸¤ç§æ•ˆæœï¼Œå…¶ä¸€æ•ˆæœå’Œ CORRELATED å€¼ä¸€æ ·ä¼šè§¦å‘å›è°ƒæ–¹æ³•ï¼Œ </p><p>â€‹å…¶äºŒåœ¨å‘å¸ƒæ¶ˆæ¯æˆåŠŸåä½¿ç”¨ rabbitTemplate è°ƒç”¨ waitForConfirms æˆ– waitForConfirmsOrDie æ–¹æ³• ç­‰å¾… broker èŠ‚ç‚¹è¿”å›å‘é€ç»“æœï¼Œæ ¹æ®è¿”å›ç»“æœæ¥åˆ¤å®šä¸‹ä¸€æ­¥çš„é€»è¾‘ï¼Œ<strong>è¦æ³¨æ„çš„ç‚¹æ˜¯ waitForConfirmsOrDie æ–¹æ³•å¦‚æœè¿”å› false åˆ™ä¼šå…³é—­ channelï¼Œåˆ™æ¥ä¸‹æ¥æ— æ³•å‘é€æ¶ˆæ¯åˆ° broker</strong></p><h4 id="8-1-4-æ·»åŠ é…ç½®ç±»"><a href="#8-1-4-æ·»åŠ é…ç½®ç±»" class="headerlink" title="8.1.4 æ·»åŠ é…ç½®ç±»"></a>8.1.4 æ·»åŠ é…ç½®ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: é…ç½®ç±» å‘å¸ƒç¡®è®¤ï¼ˆé«˜çº§ï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/8 22:13</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConfirmConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// äº¤æ¢æœº</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CONFIRM_EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;confirm_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CONFIRM_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;confirm_queue&quot;</span>;</span><br><span class="line">    <span class="comment">// routingKey</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CONFIRM_ROUTING_KEY</span> <span class="operator">=</span> <span class="string">&quot;key1&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean(&quot;confirmExchange&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">confirmExchange</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DirectExchange</span>(CONFIRM_EXCHANGE_NAME);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean(&quot;confirmQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">confirmQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(CONFIRM_QUEUE_NAME).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç»‘å®š</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">queueBindingExchange</span><span class="params">(<span class="meta">@Qualifier(&quot;confirmQueue&quot;)</span> Queue confirmQueue,</span></span><br><span class="line"><span class="params">                                        <span class="meta">@Qualifier(&quot;confirmExchange&quot;)</span> DirectExchange confirmExchange)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(confirmQueue).to(confirmExchange).with(CONFIRM_ROUTING_KEY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-1-5-æ¶ˆæ¯ç”Ÿäº§è€…"><a href="#8-1-5-æ¶ˆæ¯ç”Ÿäº§è€…" class="headerlink" title="8.1.5 æ¶ˆæ¯ç”Ÿäº§è€…"></a>8.1.5 æ¶ˆæ¯ç”Ÿäº§è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å¼€å§‹å‘æ¶ˆæ¯ æµ‹è¯•ç¡®è®¤</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/8 22:30</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/confirm&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line">    <span class="comment">// å‘é€æ¶ˆæ¯</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;sendMessage/&#123;message&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMessage</span><span class="params">(<span class="meta">@PathVariable</span> String message)</span>&#123;</span><br><span class="line">        <span class="type">CorrelationData</span> <span class="variable">correlationData1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CorrelationData</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        rabbitTemplate.convertAndSend(ConfirmConfig.CONFIRM_EXCHANGE_NAME,</span><br><span class="line">                ConfirmConfig.CONFIRM_ROUTING_KEY, message + <span class="string">&quot;key1&quot;</span>, correlationData1);</span><br><span class="line">        log.info(<span class="string">&quot;å‘é€æ¶ˆæ¯å†…å®¹ï¼š&#123;&#125;&quot;</span>, message + <span class="string">&quot;key1&quot;</span>);</span><br><span class="line">        <span class="type">CorrelationData</span> <span class="variable">correlationData2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CorrelationData</span>(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">        rabbitTemplate.convertAndSend(ConfirmConfig.CONFIRM_EXCHANGE_NAME,</span><br><span class="line">                ConfirmConfig.CONFIRM_ROUTING_KEY + <span class="string">&quot;2&quot;</span>, message + <span class="string">&quot;key12&quot;</span>, correlationData2);</span><br><span class="line">        log.info(<span class="string">&quot;å‘é€æ¶ˆæ¯å†…å®¹ï¼š&#123;&#125;&quot;</span>, message + <span class="string">&quot;key2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-1-6-å›è°ƒæ¥å£"><a href="#8-1-6-å›è°ƒæ¥å£" class="headerlink" title="8.1.6 å›è°ƒæ¥å£"></a>8.1.6 å›è°ƒæ¥å£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å›è°ƒæ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/8 22:50</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyCallBack</span> <span class="keyword">implements</span> <span class="title class_">RabbitTemplate</span>.ConfirmCallback &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// æ³¨å…¥</span></span><br><span class="line">        rabbitTemplate.setConfirmCallback(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * äº¤æ¢æœºç¡®è®¤å›è°ƒæ–¹æ³•</span></span><br><span class="line"><span class="comment">     * 1.å‘æ¶ˆæ¯ äº¤æ¢æœºæ¥æ”¶åˆ°äº† å›è°ƒ</span></span><br><span class="line"><span class="comment">     *  1.1 correlationData ä¿å­˜å›è°ƒæ¶ˆæ¯çš„ ID åŠç›¸å…³ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *  1.2 äº¤æ¢æœºæ”¶åˆ°æ¶ˆæ¯ ack = true</span></span><br><span class="line"><span class="comment">     * 2.å‘æ¶ˆæ¯ äº¤æ¢æœºæ¥æ”¶å¤±è´¥äº† å›è°ƒ</span></span><br><span class="line"><span class="comment">     *  2.1 correlationData ä¿å­˜å›è°ƒæ¶ˆæ¯çš„ ID åŠç›¸å…³ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *  2.2 äº¤æ¢æœºæ”¶åˆ°æ¶ˆæ¯ ack = false</span></span><br><span class="line"><span class="comment">     *  2.3 cause å¼•èµ·å¤±è´¥çš„åŸå› </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> correlationData</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ack</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cause</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">confirm</span><span class="params">(CorrelationData correlationData, <span class="type">boolean</span> ack, String cause)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> correlationData != <span class="literal">null</span> ? correlationData.getId() : <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(ack)&#123;</span><br><span class="line">            log.info(<span class="string">&quot;äº¤æ¢æœºå·²ç»æ”¶åˆ° Id ä¸ºï¼š&#123;&#125; çš„æ¶ˆæ¯&quot;</span>, id);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;äº¤æ¢æœºè¿˜æœªæ”¶åˆ° Id ä¸ºï¼š&#123;&#125; çš„æ¶ˆæ¯ï¼ŒåŸå› ä¸ºï¼š&#123;&#125;&quot;</span>, id, cause);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-1-7-æ¶ˆæ¯æ¶ˆè´¹è€…"><a href="#8-1-7-æ¶ˆæ¯æ¶ˆè´¹è€…" class="headerlink" title="8.1.7 æ¶ˆæ¯æ¶ˆè´¹è€…"></a>8.1.7 æ¶ˆæ¯æ¶ˆè´¹è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/8 22:34</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer</span> &#123;</span><br><span class="line">    <span class="meta">@RabbitListener(queues = ConfirmConfig.CONFIRM_QUEUE_NAME)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveConfirmMessage</span><span class="params">(Message message)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody());</span><br><span class="line">        log.info(<span class="string">&quot;æ¥å—åˆ°çš„é˜Ÿåˆ— confirm.queue æ¶ˆæ¯ï¼š&#123;&#125;&quot;</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-1-8-ç»“æœåˆ†æ"><a href="#8-1-8-ç»“æœåˆ†æ" class="headerlink" title="8.1.8 ç»“æœåˆ†æ"></a>8.1.8 ç»“æœåˆ†æ</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302091338917.png" alt="image-20230209133818410"></p><p>ä¸Šå›¾ç»“æœæ˜¾ç¤ºï¼Œå‘é€äº†ä¸¤æ¡æ¶ˆæ¯ï¼Œç¬¬ä¸€æ¡æ¶ˆæ¯æ˜¯ routingKey ä¸º â€œkey1â€,ç¬¬äºŒæ¡æ¶ˆæ¯æ˜¯ routingKey ä¸º â€œkey2â€,ä¸¤æ¡æ¶ˆæ¯éƒ½æˆåŠŸè¢«äº¤æ¢æœºæ¥æ”¶ï¼Œä¹Ÿæ”¶åˆ°äº†äº¤æ¢æœºçš„ç¡®è®¤å›è°ƒï¼Œä½†æ¶ˆè´¹è€…åªæ”¶åˆ°äº†ä¸€æ¡æ¶ˆæ¯ï¼Œå› ä¸º ç¬¬äºŒæ¡æ¶ˆæ¯çš„ RoutingKey ä¸é˜Ÿåˆ—çš„ BindingKey ä¸ä¸€è‡´ï¼Œä¹Ÿæ²¡æœ‰å…¶å®ƒé˜Ÿåˆ—èƒ½æ¥æ”¶è¿™ä¸ªæ¶ˆæ¯ï¼Œæ‰€æœ‰ç¬¬äºŒæ¡ æ¶ˆæ¯è¢«ç›´æ¥ä¸¢å¼ƒäº†ã€‚</p><h3 id="8-2-å›é€€æ¶ˆæ¯"><a href="#8-2-å›é€€æ¶ˆæ¯" class="headerlink" title="8.2 å›é€€æ¶ˆæ¯"></a>8.2 å›é€€æ¶ˆæ¯</h3><h4 id="8-2-1-Mandatory-å‚æ•°"><a href="#8-2-1-Mandatory-å‚æ•°" class="headerlink" title="8.2.1 Mandatory å‚æ•°"></a>8.2.1 Mandatory å‚æ•°</h4><p>â€‹<strong>åœ¨ä»…å¼€å¯äº†ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶çš„æƒ…å†µä¸‹ï¼Œäº¤æ¢æœºæ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šç›´æ¥ç»™æ¶ˆæ¯ç”Ÿäº§è€…å‘é€ç¡®è®¤æ¶ˆæ¯ï¼Œå¦‚ æœå‘ç°è¯¥æ¶ˆæ¯ä¸å¯è·¯ç”±ï¼Œé‚£ä¹ˆæ¶ˆæ¯ä¼šè¢«ç›´æ¥ä¸¢å¼ƒï¼Œæ­¤æ—¶ç”Ÿäº§è€…æ˜¯ä¸çŸ¥é“æ¶ˆæ¯è¢«ä¸¢å¼ƒè¿™ä¸ªäº‹ä»¶çš„ã€‚</strong>é‚£ä¹ˆå¦‚ä½• è®©æ— æ³•è¢«è·¯ç”±çš„æ¶ˆæ¯å¸®æˆ‘æƒ³åŠæ³•å¤„ç†ä¸€ä¸‹ï¼Ÿæœ€èµ·ç é€šçŸ¥æˆ‘ä¸€å£°ï¼Œæˆ‘å¥½è‡ªå·±å¤„ç†å•Šã€‚é€šè¿‡è®¾ç½® mandatory å‚ æ•°å¯ä»¥åœ¨å½“æ¶ˆæ¯ä¼ é€’è¿‡ç¨‹ä¸­ä¸å¯è¾¾ç›®çš„åœ°æ—¶å°†æ¶ˆæ¯è¿”å›ç»™ç”Ÿäº§è€…ã€‚</p><h4 id="8-2-2-application-yml-æ·»åŠ "><a href="#8-2-2-application-yml-æ·»åŠ " class="headerlink" title="8.2.2 application.yml æ·»åŠ "></a>8.2.2 application.yml æ·»åŠ </h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">publisher-returns:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h4 id="8-2-3-å›è°ƒæ¥å£"><a href="#8-2-3-å›è°ƒæ¥å£" class="headerlink" title="8.2.3 å›è°ƒæ¥å£"></a>8.2.3 å›è°ƒæ¥å£</h4><p>è®¾ç½®å›è°ƒæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitTemplate.setReturnsCallback(<span class="built_in">this</span>);</span><br></pre></td></tr></table></figure><p>é‡å†™ returnedMessage æ–¹æ³•ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å›è°ƒæ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/8 22:50</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyCallBack</span> <span class="keyword">implements</span> <span class="title class_">RabbitTemplate</span>.ConfirmCallback, RabbitTemplate.ReturnsCallback &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// æ³¨å…¥</span></span><br><span class="line">        rabbitTemplate.setConfirmCallback(<span class="built_in">this</span>);</span><br><span class="line">        rabbitTemplate.setReturnsCallback(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * äº¤æ¢æœºç¡®è®¤å›è°ƒæ–¹æ³•</span></span><br><span class="line"><span class="comment">     * 1.å‘æ¶ˆæ¯ äº¤æ¢æœºæ¥æ”¶åˆ°äº† å›è°ƒ</span></span><br><span class="line"><span class="comment">     *  1.1 correlationData ä¿å­˜å›è°ƒæ¶ˆæ¯çš„ ID åŠç›¸å…³ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *  1.2 äº¤æ¢æœºæ”¶åˆ°æ¶ˆæ¯ ack = true</span></span><br><span class="line"><span class="comment">     * 2.å‘æ¶ˆæ¯ äº¤æ¢æœºæ¥æ”¶å¤±è´¥äº† å›è°ƒ</span></span><br><span class="line"><span class="comment">     *  2.1 correlationData ä¿å­˜å›è°ƒæ¶ˆæ¯çš„ ID åŠç›¸å…³ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *  2.2 äº¤æ¢æœºæ”¶åˆ°æ¶ˆæ¯ ack = false</span></span><br><span class="line"><span class="comment">     *  2.3 cause å¼•èµ·å¤±è´¥çš„åŸå› </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> correlationData</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ack</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cause</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">confirm</span><span class="params">(CorrelationData correlationData, <span class="type">boolean</span> ack, String cause)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> correlationData != <span class="literal">null</span> ? correlationData.getId() : <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(ack)&#123;</span><br><span class="line">            log.info(<span class="string">&quot;äº¤æ¢æœºå·²ç»æ”¶åˆ° Id ä¸ºï¼š&#123;&#125; çš„æ¶ˆæ¯&quot;</span>, id);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;äº¤æ¢æœºè¿˜æœªæ”¶åˆ° Id ä¸ºï¼š&#123;&#125; çš„æ¶ˆæ¯ï¼ŒåŸå› ä¸ºï¼š&#123;&#125;&quot;</span>, id, cause);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åªæœ‰æ¶ˆæ¯åˆ°è¾¾ä¸äº†ç›®çš„åœ°çš„æ—¶å€™ï¼Œ æ‰è¿›è¡Œå›é€€</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">returnedMessage</span><span class="params">(ReturnedMessage returned)</span> &#123;</span><br><span class="line">        log.error(<span class="string">&quot;æ¶ˆæ¯ &#123;&#125;ï¼Œ è¢«äº¤æ¢æœº &#123;&#125; é€€å›ï¼Œ é€€å›åŸå› ï¼š&#123;&#125;ï¼Œ è·¯ç”± key ï¼š&#123;&#125;&quot;</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">String</span>(returned.getMessage().getBody()),</span><br><span class="line">                returned.getExchange(), returned.getReplyText(), returned.getRoutingKey());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-2-4-ç»“æœ"><a href="#8-2-4-ç»“æœ" class="headerlink" title="8.2.4 ç»“æœ"></a>8.2.4 ç»“æœ</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302091421109.png" alt="image-20230209142155747"></p><h3 id="8-3-å¤‡ä»½äº¤æ¢æœº"><a href="#8-3-å¤‡ä»½äº¤æ¢æœº" class="headerlink" title="8.3 å¤‡ä»½äº¤æ¢æœº"></a>8.3 å¤‡ä»½äº¤æ¢æœº</h3><p>â€‹æœ‰äº† mandatory å‚æ•°å’Œå›é€€æ¶ˆæ¯ï¼Œæˆ‘ä»¬è·å¾—äº†å¯¹æ— æ³•æŠ•é€’æ¶ˆæ¯çš„æ„ŸçŸ¥èƒ½åŠ›ï¼Œæœ‰æœºä¼šåœ¨ç”Ÿäº§è€…çš„æ¶ˆæ¯ æ— æ³•è¢«æŠ•é€’æ—¶å‘ç°å¹¶å¤„ç†ã€‚ä½†æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“è¯¥å¦‚ä½•å¤„ç†è¿™äº›æ— æ³•è·¯ç”±çš„æ¶ˆæ¯ï¼Œæœ€å¤šæ‰“ä¸ªæ—¥å¿—ï¼Œç„¶ åè§¦å‘æŠ¥è­¦ï¼Œå†æ¥æ‰‹åŠ¨å¤„ç†ã€‚è€Œé€šè¿‡æ—¥å¿—æ¥å¤„ç†è¿™äº›æ— æ³•è·¯ç”±çš„æ¶ˆæ¯æ˜¯å¾ˆä¸ä¼˜é›…çš„åšæ³•ï¼Œç‰¹åˆ«æ˜¯å½“ç”Ÿäº§è€… æ‰€åœ¨çš„æœåŠ¡æœ‰å¤šå°æœºå™¨çš„æ—¶å€™ï¼Œæ‰‹åŠ¨å¤åˆ¶æ—¥å¿—ä¼šæ›´åŠ éº»çƒ¦è€Œä¸”å®¹æ˜“å‡ºé”™ã€‚è€Œä¸”è®¾ç½® mandatory å‚æ•°ä¼šå¢ åŠ ç”Ÿäº§è€…çš„å¤æ‚æ€§ï¼Œéœ€è¦æ·»åŠ å¤„ç†è¿™äº›è¢«é€€å›çš„æ¶ˆæ¯çš„é€»è¾‘ã€‚å¦‚æœæ—¢ä¸æƒ³ä¸¢å¤±æ¶ˆæ¯ï¼Œåˆä¸æƒ³å¢åŠ ç”Ÿäº§è€…çš„ å¤æ‚æ€§ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿå‰é¢åœ¨è®¾ç½®æ­»ä¿¡é˜Ÿåˆ—çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æåˆ°ï¼Œå¯ä»¥ä¸ºé˜Ÿåˆ—è®¾ç½®æ­»ä¿¡äº¤æ¢æœºæ¥å­˜å‚¨é‚£äº› å¤„ç†å¤±è´¥çš„æ¶ˆæ¯ï¼Œå¯æ˜¯è¿™äº›ä¸å¯è·¯ç”±æ¶ˆæ¯æ ¹æœ¬æ²¡æœ‰æœºä¼šè¿›å…¥åˆ°é˜Ÿåˆ—ï¼Œå› æ­¤æ— æ³•ä½¿ç”¨æ­»ä¿¡é˜Ÿåˆ—æ¥ä¿å­˜æ¶ˆæ¯ã€‚ åœ¨ RabbitMQ ä¸­ï¼Œæœ‰ä¸€ç§å¤‡ä»½äº¤æ¢æœºçš„æœºåˆ¶å­˜åœ¨ï¼Œå¯ä»¥å¾ˆå¥½çš„åº”å¯¹è¿™ä¸ªé—®é¢˜ã€‚ä»€ä¹ˆæ˜¯å¤‡ä»½äº¤æ¢æœºå‘¢ï¼Ÿå¤‡ä»½ äº¤æ¢æœºå¯ä»¥ç†è§£ä¸º RabbitMQ ä¸­äº¤æ¢æœºçš„â€œå¤‡èƒâ€ï¼Œå½“æˆ‘ä»¬ä¸ºæŸä¸€ä¸ªäº¤æ¢æœºå£°æ˜ä¸€ä¸ªå¯¹åº”çš„å¤‡ä»½äº¤æ¢æœºæ—¶ï¼Œ å°±æ˜¯ä¸ºå®ƒåˆ›å»ºä¸€ä¸ªå¤‡èƒï¼Œå½“äº¤æ¢æœºæ¥æ”¶åˆ°ä¸€æ¡ä¸å¯è·¯ç”±æ¶ˆæ¯æ—¶ï¼Œå°†ä¼šæŠŠè¿™æ¡æ¶ˆæ¯è½¬å‘åˆ°å¤‡ä»½äº¤æ¢æœºä¸­ï¼Œç”± å¤‡ä»½äº¤æ¢æœºæ¥è¿›è¡Œè½¬å‘å’Œå¤„ç†ï¼Œé€šå¸¸å¤‡ä»½äº¤æ¢æœºçš„ç±»å‹ä¸º Fanout ï¼Œè¿™æ ·å°±èƒ½æŠŠæ‰€æœ‰æ¶ˆæ¯éƒ½æŠ•é€’åˆ°ä¸å…¶ç»‘ å®šçš„é˜Ÿåˆ—ä¸­ï¼Œç„¶åæˆ‘ä»¬åœ¨å¤‡ä»½äº¤æ¢æœºä¸‹ç»‘å®šä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿™æ ·æ‰€æœ‰é‚£äº›åŸäº¤æ¢æœºæ— æ³•è¢«è·¯ç”±çš„æ¶ˆæ¯ï¼Œå°±ä¼šéƒ½ è¿›å…¥è¿™ä¸ªé˜Ÿåˆ—äº†ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å»ºç«‹ä¸€ä¸ªæŠ¥è­¦é˜Ÿåˆ—ï¼Œç”¨ç‹¬ç«‹çš„æ¶ˆè´¹è€…æ¥è¿›è¡Œç›‘æµ‹å’ŒæŠ¥è­¦ã€‚</p><h4 id="8-3-1-ä»£ç æ¶æ„å›¾"><a href="#8-3-1-ä»£ç æ¶æ„å›¾" class="headerlink" title="8.3.1 ä»£ç æ¶æ„å›¾"></a>8.3.1 ä»£ç æ¶æ„å›¾</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302091453657.png" alt="image-20230209145343572"></p><h4 id="8-3-2-ä¿®æ”¹é…ç½®ç±»-ConfirmConfig"><a href="#8-3-2-ä¿®æ”¹é…ç½®ç±»-ConfirmConfig" class="headerlink" title="8.3.2 ä¿®æ”¹é…ç½®ç±» ConfirmConfig"></a>8.3.2 ä¿®æ”¹é…ç½®ç±» ConfirmConfig</h4><ul><li>ä¸»è¦æ˜¯å£°æ˜å’Œç»‘å®šå¤‡ä»½äº¤æ¢æœºã€å¤‡ä»½é˜Ÿåˆ—å’ŒæŠ¥è­¦é˜Ÿåˆ—</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: é…ç½®ç±» å‘å¸ƒç¡®è®¤ï¼ˆé«˜çº§ï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/8 22:13</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConfirmConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// äº¤æ¢æœº</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CONFIRM_EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;confirm_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CONFIRM_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;confirm_queue&quot;</span>;</span><br><span class="line">    <span class="comment">// routingKey</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CONFIRM_ROUTING_KEY</span> <span class="operator">=</span> <span class="string">&quot;key1&quot;</span>;</span><br><span class="line">    <span class="comment">// å¤‡ä»½äº¤æ¢æœº</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">BACKUP_EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;backup_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">// å¤‡ä»½é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">BACKUP_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;backup_queue&quot;</span>;</span><br><span class="line">    <span class="comment">// æŠ¥è­¦é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">WARNING_QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;warning_queue&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean(&quot;confirmExchange&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">confirmExchange</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ExchangeBuilder.directExchange(CONFIRM_EXCHANGE_NAME)</span><br><span class="line">                .durable(<span class="literal">true</span>).withArgument(<span class="string">&quot;alternate-exchange&quot;</span>, BACKUP_EXCHANGE_NAME).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean(&quot;confirmQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">confirmQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(CONFIRM_QUEUE_NAME).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç»‘å®š</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">queueBindingExchange</span><span class="params">(<span class="meta">@Qualifier(&quot;confirmQueue&quot;)</span> Queue confirmQueue,</span></span><br><span class="line"><span class="params">                                        <span class="meta">@Qualifier(&quot;confirmExchange&quot;)</span> DirectExchange confirmExchange)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(confirmQueue).to(confirmExchange).with(CONFIRM_ROUTING_KEY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤‡ä»½äº¤æ¢æœºåˆ›å»º</span></span><br><span class="line">    <span class="meta">@Bean(&quot;backupExchange&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> FanoutExchange <span class="title function_">BackupExchange</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FanoutExchange</span>(BACKUP_EXCHANGE_NAME);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¤‡ä»½é˜Ÿåˆ—åˆ›å»º</span></span><br><span class="line">    <span class="meta">@Bean(&quot;backupQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">backupQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(BACKUP_QUEUE_NAME).build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æŠ¥è­¦é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean(&quot;warningQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">warningQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(WARNING_QUEUE_NAME).build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¤‡ä»½äº¤æ¢æœºç»‘å®šå¤‡ä»½é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">backupQueueBindingBackupExchange</span><span class="params">(<span class="meta">@Qualifier(&quot;backupQueue&quot;)</span> Queue backupQueue,</span></span><br><span class="line"><span class="params">                                        <span class="meta">@Qualifier(&quot;backupExchange&quot;)</span> FanoutExchange backupExchange)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(backupQueue).to(backupExchange);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤‡ä»½äº¤æ¢æœºç»‘å®šæŠ¥è­¦é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">warningQueueBindingBackupExchange</span><span class="params">(<span class="meta">@Qualifier(&quot;warningQueue&quot;)</span> Queue warningQueue,</span></span><br><span class="line"><span class="params">                                                    <span class="meta">@Qualifier(&quot;backupExchange&quot;)</span> FanoutExchange backupExchange)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(warningQueue).to(backupExchange);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-3-3-æŠ¥è­¦æ¶ˆè´¹è€…-WarningConsumer"><a href="#8-3-3-æŠ¥è­¦æ¶ˆè´¹è€…-WarningConsumer" class="headerlink" title="8.3.3 æŠ¥è­¦æ¶ˆè´¹è€… WarningConsumer"></a>8.3.3 æŠ¥è­¦æ¶ˆè´¹è€… WarningConsumer</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æŠ¥è­¦æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/2/9 14:44</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WarningConsumer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¥æ”¶æŠ¥è­¦æ¶ˆæ¯</span></span><br><span class="line">    <span class="meta">@RabbitListener(queues = ConfirmConfig.WARNING_QUEUE_NAME)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveWarningMsg</span><span class="params">(Message message)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody());</span><br><span class="line">        log.info(<span class="string">&quot;æŠ¥è­¦å‘ç°ä¸å¯è·¯ç”±æ¶ˆæ¯ï¼š &#123;&#125;&quot;</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-3-4-æµ‹è¯•æ³¨æ„äº‹é¡¹"><a href="#8-3-4-æµ‹è¯•æ³¨æ„äº‹é¡¹" class="headerlink" title="8.3.4 æµ‹è¯•æ³¨æ„äº‹é¡¹"></a>8.3.4 æµ‹è¯•æ³¨æ„äº‹é¡¹</h4><p>é‡æ–°å¯åŠ¨é¡¹ç›®çš„æ—¶å€™éœ€è¦æŠŠåŸæ¥çš„ confirm.exchange åˆ é™¤å› ä¸ºæˆ‘ä»¬ä¿®æ”¹äº†å…¶ç»‘å®šå±æ€§ï¼Œä¸ç„¶æŠ¥ä»¥ä¸‹é”™:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inequivalent arg <span class="string">&#x27;alternate-exchange&#x27;</span><span class="keyword">for</span> exchange <span class="string">&#x27;confirm.exchange&#x27;</span>in vhost <span class="string">&#x27;/</span></span><br><span class="line"><span class="string">inequivalent arg &#x27;</span>alternate-exchange<span class="string">&#x27;for exchange &#x27;</span>confirm.exchange<span class="string">&#x27;in vhost &#x27;</span>/<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="8-3-5-ç»“æœåˆ†æ"><a href="#8-3-5-ç»“æœåˆ†æ" class="headerlink" title="8.3.5 ç»“æœåˆ†æ"></a>8.3.5 ç»“æœåˆ†æ</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302091457828.png" alt="image-20230209145728615"></p><p>â€‹mandatory å‚æ•°ä¸å¤‡ä»½äº¤æ¢æœºå¯ä»¥ä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœä¸¤è€…åŒæ—¶å¼€å¯ï¼Œæ¶ˆæ¯ç©¶ç«Ÿä½•å»ä½•ä»ï¼Ÿè°ä¼˜å…ˆ çº§é«˜ï¼Œç»è¿‡ä¸Šé¢ç»“æœæ˜¾ç¤ºç­”æ¡ˆæ˜¯<strong>å¤‡ä»½äº¤æ¢æœºä¼˜å…ˆçº§é«˜ã€‚</strong></p><h2 id="9-RabbitMQ-å…¶ä»–çŸ¥è¯†ç‚¹"><a href="#9-RabbitMQ-å…¶ä»–çŸ¥è¯†ç‚¹" class="headerlink" title="9. RabbitMQ å…¶ä»–çŸ¥è¯†ç‚¹"></a>9. RabbitMQ å…¶ä»–çŸ¥è¯†ç‚¹</h2><h3 id="9-1-å¹‚ç­‰æ€§"><a href="#9-1-å¹‚ç­‰æ€§" class="headerlink" title="9.1 å¹‚ç­‰æ€§"></a>9.1 å¹‚ç­‰æ€§</h3><h4 id="9-1-1-æ¦‚å¿µ"><a href="#9-1-1-æ¦‚å¿µ" class="headerlink" title="9.1.1 æ¦‚å¿µ"></a>9.1.1 æ¦‚å¿µ</h4><p>â€‹ç”¨æˆ·å¯¹äºåŒä¸€æ“ä½œå‘èµ·çš„ä¸€æ¬¡è¯·æ±‚æˆ–è€…å¤šæ¬¡è¯·æ±‚çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä¸ä¼šå› ä¸ºå¤šæ¬¡ç‚¹å‡»è€Œäº§ç”Ÿäº†å‰¯ä½œç”¨ã€‚ ä¸¾ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼Œé‚£å°±æ˜¯æ”¯ä»˜ï¼Œç”¨æˆ·è´­ä¹°å•†å“åæ”¯ä»˜ï¼Œæ”¯ä»˜æ‰£æ¬¾æˆåŠŸï¼Œä½†æ˜¯è¿”å›ç»“æœçš„æ—¶å€™ç½‘ç»œå¼‚å¸¸ï¼Œ æ­¤æ—¶é’±å·²ç»æ‰£äº†ï¼Œç”¨æˆ·å†æ¬¡ç‚¹å‡»æŒ‰é’®ï¼Œæ­¤æ—¶ä¼šè¿›è¡Œç¬¬äºŒæ¬¡æ‰£æ¬¾ï¼Œè¿”å›ç»“æœæˆåŠŸï¼Œç”¨æˆ·æŸ¥è¯¢ä½™é¢å‘ç°å¤šæ‰£é’± äº†ï¼Œæµæ°´è®°å½•ä¹Ÿå˜æˆäº†ä¸¤æ¡ã€‚åœ¨ä»¥å‰çš„å•åº”ç”¨ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠæ•°æ®æ“ä½œæ”¾å…¥äº‹åŠ¡ä¸­å³å¯ï¼Œå‘ç”Ÿé”™è¯¯ ç«‹å³å›æ»šï¼Œä½†æ˜¯å†å“åº”å®¢æˆ·ç«¯çš„æ—¶å€™ä¹Ÿæœ‰å¯èƒ½å‡ºç°ç½‘ç»œä¸­æ–­æˆ–è€…å¼‚å¸¸ç­‰ç­‰</p><h4 id="9-1-2-æ¶ˆæ¯é‡å¤æ¶ˆè´¹"><a href="#9-1-2-æ¶ˆæ¯é‡å¤æ¶ˆè´¹" class="headerlink" title="9.1.2 æ¶ˆæ¯é‡å¤æ¶ˆè´¹"></a>9.1.2 æ¶ˆæ¯é‡å¤æ¶ˆè´¹</h4><p>â€‹æ¶ˆè´¹è€…åœ¨æ¶ˆè´¹ MQ ä¸­çš„æ¶ˆæ¯æ—¶ï¼ŒMQ å·²æŠŠæ¶ˆæ¯å‘é€ç»™æ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…åœ¨ç»™ MQ è¿”å› ack æ—¶ç½‘ç»œä¸­æ–­ï¼Œ æ•… MQ æœªæ”¶åˆ°ç¡®è®¤ä¿¡æ¯ï¼Œè¯¥æ¡æ¶ˆæ¯ä¼šé‡æ–°å‘ç»™å…¶ä»–çš„æ¶ˆè´¹è€…ï¼Œæˆ–è€…åœ¨ç½‘ç»œé‡è¿åå†æ¬¡å‘é€ç»™è¯¥æ¶ˆè´¹è€…ï¼Œä½† å®é™…ä¸Šè¯¥æ¶ˆè´¹è€…å·²æˆåŠŸæ¶ˆè´¹äº†è¯¥æ¡æ¶ˆæ¯ï¼Œé€ æˆæ¶ˆè´¹è€…æ¶ˆè´¹äº†é‡å¤çš„æ¶ˆæ¯ã€‚</p><h4 id="9-1-3-è§£å†³æ€è·¯"><a href="#9-1-3-è§£å†³æ€è·¯" class="headerlink" title="9.1.3 è§£å†³æ€è·¯"></a>9.1.3 è§£å†³æ€è·¯</h4><p>â€‹MQ æ¶ˆè´¹è€…çš„å¹‚ç­‰æ€§çš„è§£å†³ä¸€èˆ¬ä½¿ç”¨å…¨å±€ ID æˆ–è€…å†™ä¸ªå”¯ä¸€æ ‡è¯†æ¯”å¦‚æ—¶é—´æˆ³ æˆ–è€… UUID æˆ–è€…è®¢å•æ¶ˆè´¹è€…æ¶ˆè´¹ MQ ä¸­çš„æ¶ˆæ¯ä¹Ÿå¯åˆ©ç”¨ MQ çš„è¯¥ id æ¥åˆ¤æ–­ï¼Œæˆ–è€…å¯æŒ‰è‡ªå·±çš„è§„åˆ™ç”Ÿæˆä¸€ä¸ªå…¨å±€å”¯ä¸€ idï¼Œæ¯æ¬¡æ¶ˆè´¹æ¶ˆ æ¯æ—¶ç”¨è¯¥ id å…ˆåˆ¤æ–­è¯¥æ¶ˆæ¯æ˜¯å¦å·²æ¶ˆè´¹è¿‡ã€‚</p><h4 id="9-1-4-æ¶ˆè´¹ç«¯çš„å¹‚ç­‰æ€§ä¿éšœ"><a href="#9-1-4-æ¶ˆè´¹ç«¯çš„å¹‚ç­‰æ€§ä¿éšœ" class="headerlink" title="9.1.4 æ¶ˆè´¹ç«¯çš„å¹‚ç­‰æ€§ä¿éšœ"></a>9.1.4 æ¶ˆè´¹ç«¯çš„å¹‚ç­‰æ€§ä¿éšœ</h4><p>â€‹åœ¨æµ·é‡è®¢å•ç”Ÿæˆçš„ä¸šåŠ¡é«˜å³°æœŸï¼Œç”Ÿäº§ç«¯æœ‰å¯èƒ½å°±ä¼šé‡å¤å‘ç”Ÿäº†æ¶ˆæ¯ï¼Œè¿™æ—¶å€™æ¶ˆè´¹ç«¯å°±è¦å®ç°å¹‚ç­‰æ€§ï¼Œ è¿™å°±æ„å‘³ç€æˆ‘ä»¬çš„æ¶ˆæ¯æ°¸è¿œä¸ä¼šè¢«æ¶ˆè´¹å¤šæ¬¡ï¼Œå³ä½¿æˆ‘ä»¬æ”¶åˆ°äº†ä¸€æ ·çš„æ¶ˆæ¯ã€‚ä¸šç•Œä¸»æµçš„å¹‚ç­‰æ€§æœ‰ä¸¤ç§æ“ä½œ:a. å”¯ä¸€ ID+æŒ‡çº¹ç æœºåˆ¶,åˆ©ç”¨æ•°æ®åº“ä¸»é”®å»é‡, b.åˆ©ç”¨ redis çš„åŸå­æ€§å»å®ç°</p><h4 id="9-1-5-å”¯ä¸€-ID-æŒ‡çº¹ç æœºåˆ¶"><a href="#9-1-5-å”¯ä¸€-ID-æŒ‡çº¹ç æœºåˆ¶" class="headerlink" title="9.1.5 å”¯ä¸€ ID + æŒ‡çº¹ç æœºåˆ¶"></a>9.1.5 å”¯ä¸€ ID + æŒ‡çº¹ç æœºåˆ¶</h4><p>â€‹æŒ‡çº¹ç :æˆ‘ä»¬çš„ä¸€äº›è§„åˆ™æˆ–è€…æ—¶é—´æˆ³åŠ åˆ«çš„æœåŠ¡ç»™åˆ°çš„å”¯ä¸€ä¿¡æ¯ç ,å®ƒå¹¶ä¸ä¸€å®šæ˜¯æˆ‘ä»¬ç³»ç»Ÿç”Ÿæˆçš„ï¼ŒåŸºæœ¬éƒ½æ˜¯ç”±æˆ‘ä»¬çš„ä¸šåŠ¡è§„åˆ™æ‹¼æ¥è€Œæ¥ï¼Œä½†æ˜¯ä¸€å®šè¦ä¿è¯å”¯ä¸€æ€§ï¼Œç„¶åå°±åˆ©ç”¨æŸ¥è¯¢è¯­å¥è¿›è¡Œåˆ¤æ–­è¿™ä¸ª id æ˜¯å¦å­˜ åœ¨æ•°æ®åº“ä¸­,ä¼˜åŠ¿å°±æ˜¯å®ç°ç®€å•å°±ä¸€ä¸ªæ‹¼æ¥ï¼Œç„¶åæŸ¥è¯¢åˆ¤æ–­æ˜¯å¦é‡å¤ï¼›åŠ£åŠ¿å°±æ˜¯åœ¨é«˜å¹¶å‘æ—¶ï¼Œå¦‚æœæ˜¯å•ä¸ªæ•° æ®åº“å°±ä¼šæœ‰å†™å…¥æ€§èƒ½ç“¶é¢ˆå½“ç„¶ä¹Ÿå¯ä»¥é‡‡ç”¨åˆ†åº“åˆ†è¡¨æå‡æ€§èƒ½ï¼Œä½†ä¹Ÿä¸æ˜¯æˆ‘ä»¬æœ€æ¨èçš„æ–¹å¼ã€‚</p><h4 id="9-1-6-Redis-åŸå­æ€§"><a href="#9-1-6-Redis-åŸå­æ€§" class="headerlink" title="9.1.6 Redis åŸå­æ€§"></a>9.1.6 Redis åŸå­æ€§</h4><p>â€‹åˆ©ç”¨ redis æ‰§è¡Œ setnx å‘½ä»¤ï¼Œå¤©ç„¶å…·æœ‰å¹‚ç­‰æ€§ã€‚ä»è€Œå®ç°ä¸é‡å¤æ¶ˆè´¹</p><h3 id="9-2-ä¼˜å…ˆé˜Ÿåˆ—"><a href="#9-2-ä¼˜å…ˆé˜Ÿåˆ—" class="headerlink" title="9.2 ä¼˜å…ˆé˜Ÿåˆ—"></a>9.2 ä¼˜å…ˆé˜Ÿåˆ—</h3><h4 id="9-2-1-ä½¿ç”¨åœºæ™¯"><a href="#9-2-1-ä½¿ç”¨åœºæ™¯" class="headerlink" title="9.2.1 ä½¿ç”¨åœºæ™¯"></a>9.2.1 ä½¿ç”¨åœºæ™¯</h4><p>â€‹åœ¨æˆ‘ä»¬ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ª<strong>è®¢å•å‚¬ä»˜</strong>çš„åœºæ™¯ï¼Œæˆ‘ä»¬çš„å®¢æˆ·åœ¨å¤©çŒ«ä¸‹çš„è®¢å•,æ·˜å®ä¼šåŠæ—¶å°†è®¢å•æ¨é€ç»™æˆ‘ä»¬ï¼Œå¦‚ æœåœ¨ç”¨æˆ·è®¾å®šçš„æ—¶é—´å†…æœªä»˜æ¬¾é‚£ä¹ˆå°±ä¼šç»™ç”¨æˆ·æ¨é€ä¸€æ¡çŸ­ä¿¡æé†’ï¼Œå¾ˆç®€å•çš„ä¸€ä¸ªåŠŸèƒ½å¯¹å§ï¼Œä½†æ˜¯ï¼Œtmall å•†å®¶å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œè‚¯å®šæ˜¯è¦åˆ†å¤§å®¢æˆ·å’Œå°å®¢æˆ·çš„å¯¹å§ï¼Œæ¯”å¦‚åƒè‹¹æœï¼Œå°ç±³è¿™æ ·å¤§å•†å®¶ä¸€å¹´èµ·ç èƒ½ç»™æˆ‘ä»¬åˆ› é€ å¾ˆå¤§çš„åˆ©æ¶¦ï¼Œæ‰€ä»¥ç†åº”å½“ç„¶ï¼Œä»–ä»¬çš„è®¢å•å¿…é¡»å¾—åˆ°ä¼˜å…ˆå¤„ç†ï¼Œè€Œæ›¾ç»æˆ‘ä»¬çš„åç«¯ç³»ç»Ÿæ˜¯ä½¿ç”¨ redis æ¥å­˜ æ”¾çš„å®šæ—¶è½®è¯¢ï¼Œå¤§å®¶éƒ½çŸ¥é“ redis åªèƒ½ç”¨ List åšä¸€ä¸ªç®€ç®€å•å•çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¹¶ä¸èƒ½å®ç°ä¸€ä¸ªä¼˜å…ˆçº§çš„åœºæ™¯ï¼Œ æ‰€ä»¥è®¢å•é‡å¤§äº†åé‡‡ç”¨ RabbitMQ è¿›è¡Œæ”¹é€ å’Œä¼˜åŒ–,å¦‚æœå‘ç°æ˜¯å¤§å®¢æˆ·çš„è®¢å•ç»™ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒé«˜çš„ä¼˜å…ˆçº§ï¼Œ å¦åˆ™å°±æ˜¯é»˜è®¤ä¼˜å…ˆçº§ã€‚</p><h4 id="9-2-2-å¦‚ä½•æ·»åŠ ä¼˜å…ˆé˜Ÿåˆ—"><a href="#9-2-2-å¦‚ä½•æ·»åŠ ä¼˜å…ˆé˜Ÿåˆ—" class="headerlink" title="9.2.2 å¦‚ä½•æ·»åŠ ä¼˜å…ˆé˜Ÿåˆ—"></a>9.2.2 å¦‚ä½•æ·»åŠ ä¼˜å…ˆé˜Ÿåˆ—</h4><ul><li><p>æ–¹æ³•ä¸€ï¼šåœ¨æ§åˆ¶å°<br><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302091545995.png" alt="image-20230209154459351"></p></li><li><p>é˜Ÿåˆ—ä¸­ä»£ç æ·»åŠ ä¼˜å…ˆçº§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="comment">// å®˜æ–¹å…è®¸æ˜¯ 0-255 ä¹‹é—´ æ­¤å¤„å…è®¸ä¼˜å…ˆçº§çš„èŒƒå›´è®¾ç½®ä¸º  0-10 è®¾ç½®å¤ªå¤§ä¼šæµªè´¹ CPU å’Œå†…å­˜</span></span><br><span class="line">arguments.put(<span class="string">&quot;x-max-priority&quot;</span>, <span class="number">10</span>);</span><br><span class="line">channel.queueDeclare(QUEUE_NAME, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, arguments);</span><br></pre></td></tr></table></figure><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302091601764.png" alt="image-20230209160115369"></p></li><li><p>æ¶ˆæ¯ä¸­ä»£ç æ·»åŠ ä¼˜å…ˆçº§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AMQP.<span class="type">BasicProperties</span> <span class="variable">properties</span> <span class="operator">=</span></span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">AMQP</span>.BasicProperties().builder().priority(<span class="number">5</span>).build();</span><br></pre></td></tr></table></figure></li><li><p>æ³¨æ„äº‹é¡¹ï¼š<br>è¦è®©é˜Ÿåˆ—å®ç°ä¼˜å…ˆçº§éœ€è¦åšçš„äº‹æƒ…æœ‰å¦‚ä¸‹äº‹æƒ…:<strong>é˜Ÿåˆ—éœ€è¦è®¾ç½®ä¸ºä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œæ¶ˆæ¯éœ€è¦è®¾ç½®æ¶ˆæ¯çš„ä¼˜å…ˆ çº§ï¼Œæ¶ˆè´¹è€…éœ€è¦ç­‰å¾…æ¶ˆæ¯å·²ç»å‘é€åˆ°é˜Ÿåˆ—ä¸­æ‰å»æ¶ˆè´¹ï¼Œå› ä¸ºè¿™æ ·æ‰æœ‰æœºä¼šå¯¹æ¶ˆæ¯è¿›è¡Œæ’åº</strong></p></li></ul><h4 id="9-2-3-ä¼˜å…ˆé˜Ÿåˆ—å®æˆ˜"><a href="#9-2-3-ä¼˜å…ˆé˜Ÿåˆ—å®æˆ˜" class="headerlink" title="9.2.3 ä¼˜å…ˆé˜Ÿåˆ—å®æˆ˜"></a>9.2.3 ä¼˜å…ˆé˜Ÿåˆ—å®æˆ˜</h4><ol><li><p>æ¶ˆæ¯ç”Ÿäº§è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">**</span><br><span class="line"> * <span class="meta">@Description</span>: ç”Ÿäº§è€…ï¼šå‘é€æ¶ˆæ¯</span><br><span class="line"> * <span class="meta">@Author</span>: mofeng</span><br><span class="line"> * <span class="meta">@DateTime</span>: <span class="number">2023</span>/<span class="number">1</span>/<span class="number">15</span> <span class="number">12</span>:<span class="number">07</span></span><br><span class="line"> **/</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Producer</span> &#123;</span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">RABBITMQ_HOST</span> <span class="operator">=</span> <span class="string">&quot;43.139.46.240&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªè¿æ¥å·¥å‚</span></span><br><span class="line">        <span class="type">ConnectionFactory</span> <span class="variable">connectionFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">        <span class="comment">// å·¥å‚ IP è¿æ¥ RabbitMQ çš„é˜Ÿåˆ—</span></span><br><span class="line">        connectionFactory.setHost(RABBITMQ_HOST);</span><br><span class="line">        <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        <span class="comment">// å¯†ç </span></span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> connectionFactory.newConnection();</span><br><span class="line">        <span class="comment">// è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * ç”Ÿæˆä¸€ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         * 1.é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.é˜Ÿåˆ—é‡Œé¢çš„æ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ï¼ˆç£ç›˜ï¼‰ é»˜è®¤æƒ…å†µä¸‹æ¶ˆæ¯å­˜å‚¨åœ¨å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">         * 3.è¯¥é˜Ÿåˆ—æ˜¯å¦åªä¾›ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œæ˜¯å¦è¿›è¡Œæ¶ˆæ¯å…±äº«ï¼Œtrue: å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ flase: åªèƒ½ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 4.æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œæœ€åä¸€ä¸ªæ¶ˆè´¹è€…ç«¯å¼€è¿æ¥ä»¥å è¯¥é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œtrue è‡ªåŠ¨åˆ é™¤ false ä¸è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">         * 5.å…¶ä»–å‚æ•°</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        Map&lt;String, Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// å®˜æ–¹å…è®¸æ˜¯ 0-255 ä¹‹é—´ æ­¤å¤„å…è®¸ä¼˜å…ˆçº§çš„èŒƒå›´è®¾ç½®ä¸º  0-10 è®¾ç½®å¤ªå¤§ä¼šæµªè´¹ CPU å’Œå†…å­˜</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-max-priority&quot;</span>, <span class="number">10</span>);</span><br><span class="line">        channel.queueDeclare(QUEUE_NAME, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, arguments);</span><br><span class="line">        <span class="comment">// å‘æ¶ˆæ¯</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; <span class="number">11</span>; i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;info&quot;</span> + i;</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">5</span>)&#123;</span><br><span class="line">                AMQP.<span class="type">BasicProperties</span> <span class="variable">properties</span> <span class="operator">=</span></span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">AMQP</span>.BasicProperties().builder().priority(<span class="number">5</span>).build();</span><br><span class="line">                channel.basicPublish(<span class="string">&quot;&quot;</span>,QUEUE_NAME, properties, message.getBytes());</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                channel.basicPublish(<span class="string">&quot;&quot;</span>,QUEUE_NAME, <span class="literal">null</span>, message.getBytes());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å‘é€ä¸€ä¸ªæ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 1.å‘é€åˆ°å“ªä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">         * 2.è·¯ç”±çš„ key å€¼æ˜¯å“ªä¸ª æœ¬æ¬¡é˜Ÿåˆ—çš„åç§°</span></span><br><span class="line"><span class="comment">         * 3.å…¶ä»–å‚æ•°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">         * 4.å‘é€æ¶ˆæ¯çš„æœ¬ä½“</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//channel.basicPublish(&quot;&quot;,QUEUE_NAME, null, message.getBytes());</span></span><br><span class="line">        System.out.println(<span class="string">&quot;æ¶ˆæ¯å‘é€å®Œæ¯•ï¼ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ¶ˆæ¯æ¶ˆè´¹è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æ¶ˆè´¹è€… æ¥å—æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: mofeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2023/1/15 14:19</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer</span> &#123;</span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">RABBITMQ_HOST</span> <span class="operator">=</span> <span class="string">&quot;43.139.46.240&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªè¿æ¥å·¥å‚</span></span><br><span class="line">        <span class="type">ConnectionFactory</span> <span class="variable">connectionFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">        <span class="comment">// å·¥å‚ IP è¿æ¥ RabbitMQ çš„é˜Ÿåˆ—</span></span><br><span class="line">        connectionFactory.setHost(RABBITMQ_HOST);</span><br><span class="line">        <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        <span class="comment">// å¯†ç </span></span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºè¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> connectionFactory.newConnection();</span><br><span class="line">        <span class="comment">// è·å–ä¿¡é“</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å£°æ˜æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody()));</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å–æ¶ˆæ¶ˆæ¯æ—¶çš„å›è°ƒ</span></span><br><span class="line">        <span class="type">CancelCallback</span> <span class="variable">cancelCallback</span> <span class="operator">=</span> consumerTag -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯æ¶ˆè´¹è¢«ä¸­æ–­ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line"><span class="comment">         * 1.æ¶ˆè´¹å“ªä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         * 2.æ¶ˆè´¹æˆåŠŸåæ˜¯å¦éœ€è¦è‡ªåŠ¨åº”ç­” true ä»£è¡¨è‡ªåŠ¨åº”ç­” false ä»£è¡¨æ‰‹åŠ¨åº”ç­”</span></span><br><span class="line"><span class="comment">         * 3.æ¶ˆè´¹è€…æœªæˆåŠŸæ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         * 4.æ¶ˆè´¹è€…å–å½•æ¶ˆè´¹çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        channel.basicConsume(QUEUE_NAME, <span class="literal">true</span>, deliverCallback, cancelCallback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>è¿è¡Œç»“æœ<br><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302091600334.png" alt="image-20230209160006737"></p><h3 id="9-3-æƒ°æ€§é˜Ÿåˆ—"><a href="#9-3-æƒ°æ€§é˜Ÿåˆ—" class="headerlink" title="9.3 æƒ°æ€§é˜Ÿåˆ—"></a>9.3 æƒ°æ€§é˜Ÿåˆ—</h3><h4 id="9-3-1-ä½¿ç”¨åœºæ™¯"><a href="#9-3-1-ä½¿ç”¨åœºæ™¯" class="headerlink" title="9.3.1 ä½¿ç”¨åœºæ™¯"></a>9.3.1 ä½¿ç”¨åœºæ™¯</h4><p>â€‹RabbitMQ ä» 3.6.0 ç‰ˆæœ¬å¼€å§‹å¼•å…¥äº†æƒ°æ€§é˜Ÿåˆ—çš„æ¦‚å¿µã€‚æƒ°æ€§é˜Ÿåˆ—ä¼šå°½å¯èƒ½çš„å°†æ¶ˆæ¯å­˜å…¥ç£ç›˜ä¸­ï¼Œè€Œåœ¨æ¶ˆè´¹è€…æ¶ˆè´¹åˆ°ç›¸åº”çš„æ¶ˆæ¯æ—¶æ‰ä¼šè¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå®ƒçš„ä¸€ä¸ªé‡è¦çš„è®¾è®¡ç›®æ ‡æ˜¯èƒ½å¤Ÿæ”¯æŒæ›´é•¿çš„é˜Ÿåˆ—ï¼Œå³æ”¯æŒæ›´å¤šçš„æ¶ˆæ¯å­˜å‚¨ã€‚å½“æ¶ˆè´¹è€…ç”±äºå„ç§å„æ ·çš„åŸå› (æ¯”å¦‚æ¶ˆè´¹è€…ä¸‹çº¿ã€å®•æœºäº¦æˆ–è€…æ˜¯ç”±äºç»´æŠ¤è€Œå…³é—­ç­‰)è€Œè‡´ ä½¿é•¿æ—¶é—´å†…ä¸èƒ½æ¶ˆè´¹æ¶ˆæ¯é€ æˆå †ç§¯æ—¶ï¼Œæƒ°æ€§é˜Ÿåˆ—å°±å¾ˆæœ‰å¿…è¦äº†ã€‚</p><p>â€‹é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ° RabbitMQ çš„æ—¶å€™ï¼Œé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ä¼šå°½å¯èƒ½çš„å­˜å‚¨åœ¨å†…å­˜ä¹‹ä¸­ï¼Œ è¿™æ ·å¯ä»¥æ›´åŠ å¿«é€Ÿçš„å°†æ¶ˆæ¯å‘é€ç»™æ¶ˆè´¹è€…ã€‚å³ä½¿æ˜¯æŒä¹…åŒ–çš„æ¶ˆæ¯ï¼Œåœ¨è¢«å†™å…¥ç£ç›˜çš„åŒæ—¶ä¹Ÿä¼šåœ¨å†…å­˜ä¸­é©»ç•™ ä¸€ä»½å¤‡ä»½ã€‚å½“ RabbitMQ éœ€è¦é‡Šæ”¾å†…å­˜çš„æ—¶å€™ï¼Œä¼šå°†å†…å­˜ä¸­çš„æ¶ˆæ¯æ¢é¡µè‡³ç£ç›˜ä¸­ï¼Œè¿™ä¸ªæ“ä½œä¼šè€—è´¹è¾ƒé•¿çš„æ—¶é—´ï¼Œä¹Ÿä¼šé˜»å¡é˜Ÿåˆ—çš„æ“ä½œï¼Œè¿›è€Œæ— æ³•æ¥æ”¶æ–°çš„æ¶ˆæ¯ã€‚è™½ç„¶ RabbitMQ çš„å¼€å‘è€…ä»¬ä¸€ç›´åœ¨å‡çº§ç›¸å…³çš„ç®—æ³•ï¼Œ ä½†æ˜¯æ•ˆæœå§‹ç»ˆä¸å¤ªç†æƒ³ï¼Œå°¤å…¶æ˜¯åœ¨æ¶ˆæ¯é‡ç‰¹åˆ«å¤§çš„æ—¶å€™</p><h4 id="9-3-2-ä¸¤ç§æ¨¡å¼"><a href="#9-3-2-ä¸¤ç§æ¨¡å¼" class="headerlink" title="9.3.2 ä¸¤ç§æ¨¡å¼"></a>9.3.2 ä¸¤ç§æ¨¡å¼</h4><p>â€‹é˜Ÿåˆ—å…·å¤‡ä¸¤ç§æ¨¡å¼ï¼š<strong>default å’Œ lazyã€‚</strong><br>â€‹é»˜è®¤çš„ä¸º default æ¨¡å¼ï¼Œåœ¨ 3.6.0 ä¹‹å‰çš„ç‰ˆæœ¬æ— éœ€åšä»»ä½•å˜æ›´ã€‚lazy æ¨¡å¼å³ä¸ºæƒ°æ€§é˜Ÿåˆ—çš„æ¨¡å¼ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ channel.queueDeclare æ–¹æ³•çš„æ—¶å€™åœ¨å‚æ•°ä¸­è®¾ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Policy çš„æ–¹å¼è®¾ç½®ï¼Œå¦‚æœä¸€ä¸ªé˜Ÿåˆ—åŒæ—¶ä½¿ç”¨è¿™ä¸¤ç§æ–¹å¼è®¾ç½®çš„è¯ï¼Œé‚£ä¹ˆ Policy çš„æ–¹å¼å…·å¤‡æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚ å¦‚æœè¦é€šè¿‡å£°æ˜çš„æ–¹å¼æ”¹å˜å·²æœ‰é˜Ÿåˆ—çš„æ¨¡å¼çš„è¯ï¼Œé‚£ä¹ˆåªèƒ½å…ˆåˆ é™¤é˜Ÿåˆ—ï¼Œç„¶åå†é‡æ–°å£°æ˜ä¸€ä¸ªæ–°çš„ã€‚</p><p>åœ¨é˜Ÿåˆ—å£°æ˜çš„æ—¶å€™å¯ä»¥é€šè¿‡â€œx-queue-modeâ€å‚æ•°æ¥è®¾ç½®é˜Ÿåˆ—çš„æ¨¡å¼ï¼Œå–å€¼ä¸ºâ€œdefaultâ€å’Œâ€œlazyâ€ã€‚ä¸‹é¢ç¤º ä¾‹ä¸­æ¼”ç¤ºäº†ä¸€ä¸ªæƒ°æ€§é˜Ÿåˆ—çš„å£°æ˜ç»†èŠ‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; args = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Object&gt;();</span><br><span class="line">args.put(<span class="string">&quot;x-queue-mode&quot;</span>, <span class="string">&quot;lazy&quot;</span>);</span><br><span class="line">channel.queueDeclare(<span class="string">&quot;myqueue&quot;</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, args);</span><br></pre></td></tr></table></figure><h4 id="9-3-3-å†…å­˜å¼€é”€å¯¹æ¯”"><a href="#9-3-3-å†…å­˜å¼€é”€å¯¹æ¯”" class="headerlink" title="9.3.3 å†…å­˜å¼€é”€å¯¹æ¯”"></a>9.3.3 å†…å­˜å¼€é”€å¯¹æ¯”</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com//9963/202302091611857.png" alt="image-20230209161131829"></p><p>â€‹åœ¨å‘é€ 1 ç™¾ä¸‡æ¡æ¶ˆæ¯ï¼Œæ¯æ¡æ¶ˆæ¯å¤§æ¦‚å  1KB çš„æƒ…å†µä¸‹ï¼Œæ™®é€šé˜Ÿåˆ—å ç”¨å†…å­˜æ˜¯ 1.2GBï¼Œè€Œæƒ°æ€§é˜Ÿåˆ—ä»…ä»… å ç”¨ 1.5MB</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;RabbitMQ&quot;&gt;&lt;a href=&quot;#RabbitMQ&quot; class=&quot;headerlink&quot; title=&quot;RabbitMQ&quot;&gt;&lt;/a&gt;RabbitMQ&lt;/h1&gt;&lt;h2 id=&quot;1-MQçš„ç›¸å…³æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#1-MQçš„ç›¸å…³æ¦‚å¿µ&quot; class=&quot;he</summary>
      
    
    
    
    <category term="æ¶ˆæ¯ä¸­é—´ä»¶" scheme="http://example.com/categories/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
    
    <category term="RabbitMQ" scheme="http://example.com/tags/RabbitMQ/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ƒã€API æ¥å£åˆ†æåŠŸèƒ½</title>
    <link href="http://example.com/2023/01/12/%E4%B8%83%E3%80%81API-%E6%8E%A5%E5%8F%A3%E5%88%86%E6%9E%90%E5%8A%9F%E8%83%BD/"/>
    <id>http://example.com/2023/01/12/%E4%B8%83%E3%80%81API-%E6%8E%A5%E5%8F%A3%E5%88%86%E6%9E%90%E5%8A%9F%E8%83%BD/</id>
    <published>2023-01-12T14:26:36.622Z</published>
    <updated>2023-08-04T15:00:26.836Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸ƒã€API-æ¥å£åˆ†æåŠŸèƒ½"><a href="#ä¸ƒã€API-æ¥å£åˆ†æåŠŸèƒ½" class="headerlink" title="ä¸ƒã€API æ¥å£åˆ†æåŠŸèƒ½"></a>ä¸ƒã€API æ¥å£åˆ†æåŠŸèƒ½</h1><p>ä¸»è¦å†…å®¹ï¼š</p><ol><li>å¼€å‘æŠ½è±¡å…¬å…±æœåŠ¡</li><li>å®ç°ç½‘å…³æ ¸å¿ƒä¸šåŠ¡æµç¨‹</li><li>å¼€å‘ç®¡ç†å‘˜æ¥å£åˆ†æåŠŸèƒ½</li><li>ä¸Šçº¿åˆ†æå’Œå‘å±•</li></ol><h2 id="æ¢³ç†ç½‘å…³ä¸šåŠ¡æµç¨‹"><a href="#æ¢³ç†ç½‘å…³ä¸šåŠ¡æµç¨‹" class="headerlink" title="æ¢³ç†ç½‘å…³ä¸šåŠ¡æµç¨‹"></a>æ¢³ç†ç½‘å…³ä¸šåŠ¡æµç¨‹</h2><p>ä¸€ä¸‹æ“ä½œå¯ä»¥å¤ç”¨ï¼š</p><ol><li>å®é™…æƒ…å†µåº”è¯¥æ˜¯å»æ•°æ®åº“ä¸­æŸ¥è¯¢æ˜¯å¦å·²åˆ†é…ç»™ç”¨æˆ·ç§˜é’¥ï¼ˆaccessKey, secretKey æ˜¯å¦åˆæ³•ï¼‰<ol><li>å…ˆæ ¹æ® accessKey åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼ŒæŸ¥åˆ° secretKey</li><li>å¯¹æ¯” secretKey å’Œç”¨æˆ·ä¼ çš„åŠ å¯†åçš„ secretKey æ˜¯å¦ä¸€è‡´</li></ol></li><li>ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ¨¡æ‹Ÿæ¥å£æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠè¯·æ±‚æ–¹æ³•æ˜¯å¦åŒ¹é…ï¼ˆè¿˜å¯ä»¥æ ¡éªŒå‚æ•°ï¼‰</li><li>è°ƒç”¨æˆåŠŸï¼Œæ¥å£è°ƒç”¨æ¬¡æ•° + 1 invokeCount</li></ol><h2 id="ä¸´æ—¶é—®é¢˜ï¼šå¦‚ä½•è·å–æ¥å£è½¬å‘æœåŠ¡å™¨çš„åœ°å€"><a href="#ä¸´æ—¶é—®é¢˜ï¼šå¦‚ä½•è·å–æ¥å£è½¬å‘æœåŠ¡å™¨çš„åœ°å€" class="headerlink" title="ä¸´æ—¶é—®é¢˜ï¼šå¦‚ä½•è·å–æ¥å£è½¬å‘æœåŠ¡å™¨çš„åœ°å€"></a>ä¸´æ—¶é—®é¢˜ï¼šå¦‚ä½•è·å–æ¥å£è½¬å‘æœåŠ¡å™¨çš„åœ°å€</h2><p>æ€è·¯ï¼šç½‘å…³å¯åŠ¨æ—¶ï¼Œè·å–æ‰€æœ‰çš„æ¥å£ä¿¡æ¯ï¼Œç»´æŠ¤åˆ°å†…å­˜çš„ hashmap ä¸­ï¼›æœ‰è¯·æ±‚æ—¶ï¼Œæ ¹æ®è¯·æ±‚çš„ URL è·¯å¾„æˆ–å…¶ä»–å‚æ•°ï¼ˆæ¯”å¦‚ host è¯·æ±‚å¤´ï¼‰ æ¥åˆ¤æ–­åº”è¯¥è½¬å‘åˆ°å“ªå°æœåŠ¡å™¨ã€ä»¥åŠç”¨æˆ·æ ¡éªŒæ¥å£æ˜¯å¦å­˜åœ¨</p><h2 id="æŠ½è±¡å…¬å…±æœåŠ¡"><a href="#æŠ½è±¡å…¬å…±æœåŠ¡" class="headerlink" title="æŠ½è±¡å…¬å…±æœåŠ¡"></a>æŠ½è±¡å…¬å…±æœåŠ¡</h2><p>é¡¹ç›®åï¼šmofeng-common</p><p>ç›®çš„æ˜¯è®©æ–¹æ³•ã€å®ä½“ç±»åœ¨å¤šä¸ªé¡¹ç›®ä¹‹é—´å¤ç”¨ï¼Œæé«˜ä»£ç å¤ç”¨ç‡ã€‚</p><p>æœåŠ¡æŠ½å–ï¼š</p><ol><li>æ•°æ®åº“ä¸­æŸ¥è¯¢æ˜¯å¦å·²åˆ†é…ç»™ç”¨æˆ·ç§˜é’¥ï¼ˆæ ¹æ® accessKey, æ‹¿åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œè¿”å›ç”¨æˆ·ä¿¡æ¯ï¼Œä¸ºç©ºè¡¨ç¤ºä¸å­˜åœ¨ï¼‰</li><li>ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ¨¡æ‹Ÿæ¥å£æ˜¯å¦å­˜åœ¨ï¼ˆè¯·æ±‚æ–¹æ³•ã€è¯·æ±‚è·¯å¾„ã€è¯·æ±‚å‚æ•°ã€è¿”å›æ¥å£ä¿¡æ¯ï¼Œä¸ºç©ºè¡¨ç¤ºä¸å­˜åœ¨ï¼‰</li><li>è°ƒç”¨æˆåŠŸï¼Œæ¥å£è°ƒç”¨æ¬¡æ•° + 1 invokeCount ï¼ˆaccessKeyã€secretKey ï¼ˆæ ‡è¯†ç”¨æˆ·ï¼‰ï¼Œè¯·æ±‚æ¥å£è·¯å¾„ï¼‰</li></ol><p>æ­¥éª¤ï¼š</p><ol><li>æ–°å»ºå¹²å‡€çš„ maven é¡¹ç›®ï¼Œåªä¿ç•™å¿…è¦çš„å…¬å…±ä¾èµ–</li><li>æŠ½å– service å’Œå®ä½“ç±»</li><li>install æœ¬åœ° maven åŒ…</li><li>è®©æœåŠ¡æä¾›è€…å¼•å…¥ common åŒ…ï¼Œæµ‹è¯•æ˜¯å¦æ­£å¸¸è¿è¡Œ</li><li>è®©æœåŠ¡æ¶ˆè´¹è€…å¼•å…¥ common åŒ…</li></ol><h2 id="ç»Ÿè®¡åˆ†æåŠŸèƒ½"><a href="#ç»Ÿè®¡åˆ†æåŠŸèƒ½" class="headerlink" title="ç»Ÿè®¡åˆ†æåŠŸèƒ½"></a>ç»Ÿè®¡åˆ†æåŠŸèƒ½</h2><h3 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h3><p>å„æ¥å£çš„æ€»è°ƒç”¨æ¬¡æ•°å æ¯”ï¼ˆé¥¼å›¾ï¼‰å–è°ƒç”¨æœ€å¤šçš„å‰ 3 ä¸ªæ¥å£ï¼Œä»è€Œåˆ†æå“ªäº›å±äºåºŸå¼ƒæ¥å£ï¼ˆé™ä½èµ„æºã€æˆ–è€…ä¸‹çº¿ï¼‰ï¼Œé«˜é¢‘æ¥å£ï¼ˆå¢åŠ èµ„æºã€æé«˜æ”¶è´¹ï¼‰</p><p>ç”¨é¥¼å›¾å±•ç¤º</p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h4><p>å¯ä»¥ä½¿ç”¨ç°æˆçš„åº“</p><p>æ¯”å¦‚ï¼š</p><ul><li>ECharts:<a href="https://echarts.apache.org/zh/index.html">https://echarts.apache.org/zh/index.html</a>    (æ¨è)</li><li>AntV:<a href="https://antv.vision/">https://antv.vision/</a>     ï¼ˆæ¨èï¼‰</li><li>BizCharts</li></ul><p>å¦‚æœæ˜¯ React é¡¹ç›®ï¼ŒECharts ç”¨è¿™ä¸ªåº“ï¼š<a href="https://github.com/hustcc/echarts-for-react">https://github.com/hustcc/echarts-for-react</a></p><h3 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h3><p>ç¼–å†™ä¸€ä¸ªæ¥å£ï¼Œå¾—åˆ°ä¸‹åˆ—ç¤ºä¾‹æ•°æ®ï¼š</p><p>æ¥å£ Aï¼š2 æ¬¡ï¼ˆè°ƒç”¨ï¼‰</p><p>æ¥å£ Bï¼š4 æ¬¡ï¼ˆè°ƒç”¨ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308042300276.png" alt="202301122208482"></p><p>æ­¥éª¤ï¼š</p><ol><li><p>SQL æŸ¥è¯¢è°ƒç”¨æ•°æ®ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> interfaceInfoId,<span class="built_in">sum</span>(totalNum) <span class="keyword">as</span> totalNum</span><br><span class="line"><span class="keyword">from</span> user_interface_info</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> interfaceInfoId</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> totalNum <span class="keyword">desc</span></span><br><span class="line">limit <span class="number">3</span></span><br></pre></td></tr></table></figure></li><li><p>ä¸šåŠ¡å±‚å»å…³è”æŸ¥è¯¢æ¥å£ä¿¡æ¯</p></li></ol><h2 id="ä¸Šçº¿è®¡åˆ’"><a href="#ä¸Šçº¿è®¡åˆ’" class="headerlink" title="ä¸Šçº¿è®¡åˆ’"></a>ä¸Šçº¿è®¡åˆ’</h2><p>å‰ç«¯ï¼šç›´æ¥æ‰“åŒ…éƒ¨ç½²å³å¯</p><p>åç«¯ï¼š</p><ul><li>backend é¡¹ç›®ï¼šweb é¡¹ç›®ï¼Œéƒ¨ç½² spring boot çš„ jar åŒ…ï¼ˆå¯¹å¤–ï¼‰</li><li>gateway é¡¹ç›®ï¼šweb é¡¹ç›®ï¼Œéƒ¨ç½² spring boot çš„ jar åŒ…ï¼ˆå¯¹å¤–ï¼‰</li><li>interface é¡¹ç›®ï¼šweb é¡¹ç›®ï¼Œéƒ¨ç½² spring boot çš„ jar åŒ…ï¼ˆå¯¹å†…ï¼‰</li></ul><p><strong>å…³é”®ï¼šç½‘ç»œå¿…é¡»è”é€š</strong></p><p>é¡¹ç›®ç”±è‡ªå·±å­¦ä¹ ä½¿ç”¨ï¼šå•ä¸ªæœåŠ¡å™¨éƒ¨ç½²è¿™ä¸‰ä¸ªé¡¹ç›®å°±è¶³å¤Ÿäº†</p><p>å®‰å…¨å¯é ï¼šå¤šä¸ªæœåŠ¡å™¨å»ºè®®åœ¨ <strong>åŒä¸€å†…ç½‘</strong>ï¼Œå†…ç½‘äº¤äº’ä¼šæ›´å¿«ã€ä¸”æ›´å®‰å…¨</p><h2 id="æ‰©å±•æ€è·¯"><a href="#æ‰©å±•æ€è·¯" class="headerlink" title="æ‰©å±•æ€è·¯"></a>æ‰©å±•æ€è·¯</h2><h3 id="1-ç”¨æˆ·å¯ä»¥ç”³è¯·æ›´æ¢ç­¾å"><a href="#1-ç”¨æˆ·å¯ä»¥ç”³è¯·æ›´æ¢ç­¾å" class="headerlink" title="1.ç”¨æˆ·å¯ä»¥ç”³è¯·æ›´æ¢ç­¾å"></a>1.ç”¨æˆ·å¯ä»¥ç”³è¯·æ›´æ¢ç­¾å</h3><h3 id="2-æ€ä¹ˆè®©å…¶ä»–ç”¨æˆ·ä¹Ÿä¸Šä¼ æ¥å£ï¼Ÿ"><a href="#2-æ€ä¹ˆè®©å…¶ä»–ç”¨æˆ·ä¹Ÿä¸Šä¼ æ¥å£ï¼Ÿ" class="headerlink" title="2.æ€ä¹ˆè®©å…¶ä»–ç”¨æˆ·ä¹Ÿä¸Šä¼ æ¥å£ï¼Ÿ"></a>2.æ€ä¹ˆè®©å…¶ä»–ç”¨æˆ·ä¹Ÿä¸Šä¼ æ¥å£ï¼Ÿ</h3><ul><li><p>éœ€è¦æä¾›ä¸€ä¸ªæœºåˆ¶ï¼ˆç•Œé¢ï¼‰ï¼Œè®©ç”¨æˆ·è¾“å…¥è‡ªå·±çš„æ¥å£ host ï¼ˆæœåŠ¡å™¨åœ°å€ï¼‰ã€æ¥å£ä¿¡æ¯ï¼Œå°†æ¥å£ä¿¡æ¯å†™å…¥æ•°æ®åº“ï¼Œå¯ä»¥åœ¨ interfaceInfo è¡¨é‡Œæ·»åŠ ä¸€ä¸ª host å­—æ®µï¼ŒåŒºåˆ†æœåŠ¡å™¨åœ°å€ï¼Œè®©æ¥å£æä¾›è€…æ›´åœ°æ¥å…¥ç³»ç»Ÿ</p></li><li><p>å°†æ¥å£ä¿¡æ¯å†™å…¥æ•°æ®åº“ä¹‹å‰ï¼Œè¦å¯¹æ¥å£è¿›è¡Œæ ¡éªŒï¼ˆæ¯”å¦‚æ£€æŸ¥åœ°å€æ˜¯å¦éµå¾ªè§„åˆ™ï¼Œæµ‹è¯•è°ƒç”¨ï¼‰ï¼Œä¿è¯æ¥å£ä½¿ç”¨æ­£å¸¸</p></li><li><p>å°†æ¥å£ä¿¡æ¯å†™å…¥æ•°æ®åº“ä¹‹å‰éµå¾ªæœ¬ç³»ç»Ÿçš„è¦æ±‚ï¼ˆå¹¶ä¸”ä½¿ç”¨æœ¬ç³»ç»Ÿçš„ SDKï¼‰</p></li><li><p>åœ¨æ¥å…¥æ—¶ï¼Œå¹³å°éœ€è¦æµ‹è¯•è°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œä¿è¯æ¥å£å¯ä»¥æ­£å¸¸ä½¿ç”¨</p></li></ul><h3 id="3-ç½‘å…³æ ¡éªŒæ˜¯å¦è¿˜æœ‰è°ƒç”¨æ¬¡æ•°"><a href="#3-ç½‘å…³æ ¡éªŒæ˜¯å¦è¿˜æœ‰è°ƒç”¨æ¬¡æ•°" class="headerlink" title="3.ç½‘å…³æ ¡éªŒæ˜¯å¦è¿˜æœ‰è°ƒç”¨æ¬¡æ•°"></a>3.ç½‘å…³æ ¡éªŒæ˜¯å¦è¿˜æœ‰è°ƒç”¨æ¬¡æ•°</h3><p>éœ€è¦è€ƒè™‘å¹¶å‘é—®é¢˜ï¼Œé˜²æ­¢ç¬é—´è°ƒç”¨è¶…é¢</p><h3 id="4-ç½‘å…³ä¼˜åŒ–"><a href="#4-ç½‘å…³ä¼˜åŒ–" class="headerlink" title="4.ç½‘å…³ä¼˜åŒ–"></a>4.ç½‘å…³ä¼˜åŒ–</h3><p>æ¯”å¦‚å¢åŠ é™æµ &#x2F; é™çº§ä¿æŠ¤ï¼Œæé«˜æ€§èƒ½ç­‰ã€‚è¿˜å¯ä»¥è€ƒè™‘æ­é… Nginx ç½‘å…³ä½¿ç”¨</p><h3 id="5-æ›´èƒ½å¢å¼º"><a href="#5-æ›´èƒ½å¢å¼º" class="headerlink" title="5.æ›´èƒ½å¢å¼º"></a>5.æ›´èƒ½å¢å¼º</h3><p>å¯ä»¥é’ˆå¯¹ä¸åŒçš„è¯·æ±‚å¤´æˆ–è€…æ¥å£ç±»å‹æ¥è®¾è®¡å‰ç«¯ç•Œé¢å’Œè¡¨å•ï¼Œä¾¿äºç”¨æˆ·è°ƒç”¨ï¼Œè·å¾—æ›´å¥½çš„ä½“éªŒã€‚</p><p>å¯ä»¥å‚è€ƒ swaggerã€postmanã€knife4j çš„é¡µé¢ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¸ƒã€API-æ¥å£åˆ†æåŠŸèƒ½&quot;&gt;&lt;a href=&quot;#ä¸ƒã€API-æ¥å£åˆ†æåŠŸèƒ½&quot; class=&quot;headerlink&quot; title=&quot;ä¸ƒã€API æ¥å£åˆ†æåŠŸèƒ½&quot;&gt;&lt;/a&gt;ä¸ƒã€API æ¥å£åˆ†æåŠŸèƒ½&lt;/h1&gt;&lt;p&gt;ä¸»è¦å†…å®¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¼€å‘æŠ½è±¡å…¬å…±æœåŠ¡&lt;/l</summary>
      
    
    
    
    <category term="API å¼€æ”¾å¹³å°" scheme="http://example.com/categories/API-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0/"/>
    
    
    <category term="æ˜Ÿçƒé¡¹ç›®" scheme="http://example.com/tags/%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>å…­ã€Dubbo æ¡†æ¶</title>
    <link href="http://example.com/2023/01/03/%E5%85%AD%E3%80%81Dubbo-%E6%A1%86%E6%9E%B6/"/>
    <id>http://example.com/2023/01/03/%E5%85%AD%E3%80%81Dubbo-%E6%A1%86%E6%9E%B6/</id>
    <published>2023-01-03T07:11:51.910Z</published>
    <updated>2023-08-04T14:59:29.976Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å…­ã€Dubbo-æ¡†æ¶"><a href="#å…­ã€Dubbo-æ¡†æ¶" class="headerlink" title="å…­ã€Dubbo æ¡†æ¶"></a>å…­ã€Dubbo æ¡†æ¶</h1><h2 id="ç½‘å…³ä¸šåŠ¡é€»è¾‘"><a href="#ç½‘å…³ä¸šåŠ¡é€»è¾‘" class="headerlink" title="ç½‘å…³ä¸šåŠ¡é€»è¾‘"></a>ç½‘å…³ä¸šåŠ¡é€»è¾‘</h2><p>é—®é¢˜ï¼šç½‘å…³é¡¹ç›®æ¯”è¾ƒçº¯å‡€ï¼Œæ²¡æœ‰æ“ä½œæ•°æ®åº“çš„åŒ…ã€å¹¶ä¸”è¿˜è¦è°ƒç”¨æˆ‘ä»¬ä¹‹å‰å†™è¿‡çš„ä»£ç ï¼Ÿå¤åˆ¶ç²˜è´´ç»´æŠ¤éº»çƒ¦</p><p>è§£å†³ï¼šç›´æ¥è¯·æ±‚åˆ°å…¶ä»–é¡¹ç›®çš„æ–¹æ³•</p><h3 id="å¦‚ä½•è°ƒç”¨å…¶ä»–é¡¹ç›®çš„æ–¹æ³•"><a href="#å¦‚ä½•è°ƒç”¨å…¶ä»–é¡¹ç›®çš„æ–¹æ³•" class="headerlink" title="å¦‚ä½•è°ƒç”¨å…¶ä»–é¡¹ç›®çš„æ–¹æ³•"></a>å¦‚ä½•è°ƒç”¨å…¶ä»–é¡¹ç›®çš„æ–¹æ³•</h3><ol><li>å¤åˆ¶ä»£ç ã€ä¾èµ–å’Œç¯å¢ƒ</li><li>HTTP è¯·æ±‚ï¼ˆæä¾›ä¸€ä¸ªæ¥å£ï¼Œä¾›å…¶ä»–é¡¹ç›®ä½¿ç”¨ï¼‰</li><li>RPC</li><li>æŠŠå…¬å…±çš„ä»£ç æ‰“åŒ… JAR åŒ…ï¼Œå…¶ä»–é¡¹ç›®å¼•ç”¨ï¼ˆå®¢æˆ·ç«¯ SDKï¼‰</li></ol><h3 id="HTTP-è¯·æ±‚å¦‚ä½•è°ƒç”¨ï¼Ÿ"><a href="#HTTP-è¯·æ±‚å¦‚ä½•è°ƒç”¨ï¼Ÿ" class="headerlink" title="HTTP è¯·æ±‚å¦‚ä½•è°ƒç”¨ï¼Ÿ"></a>HTTP è¯·æ±‚å¦‚ä½•è°ƒç”¨ï¼Ÿ</h3><ol><li>æä¾›å¼€å‘ä¸€ä¸ªæ¥å£ï¼ˆåœ°å€ã€è¯·æ±‚æ–¹æ³•ã€å‚æ•°ã€è¿”å›å€¼ï¼‰</li><li>è°ƒç”¨æ–¹ä½¿ç”¨ HTTP Client ä¹‹ç±»çš„ä»£ç åŒ…å»å‘é€ HTTP è¯·æ±‚</li></ol><h3 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h3><p><strong>ä½œç”¨ï¼šåƒæœ¬åœ°æ–¹æ³•ä¸€æ ·è°ƒç”¨è¿œç¨‹æ–¹æ³•</strong></p><ol><li>å¯¹å¼€å‘è€…æ›´é€æ˜ï¼Œå‡å°‘äº†å¾ˆå¤šçš„æ²Ÿé€š æˆæœ¬</li><li>RPC æƒ³è¿œç¨‹æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œæœªå¿…è¦ä½¿ç”¨ HTTP è¯·æ±‚ï¼Œæ¯”å¦‚è¿˜å¯ä»¥ç”¨ TCP&#x2F;IPï¼Œæ€§èƒ½æ›´é«˜ï¼ˆå†…éƒ¨æœåŠ¡æ›´é€‚ç”¨ï¼‰</li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308042259299.png" alt="202212272020718"></p><h3 id="Dubbo-æ¡†æ¶ï¼ˆRPC-å®ç°ï¼‰"><a href="#Dubbo-æ¡†æ¶ï¼ˆRPC-å®ç°ï¼‰" class="headerlink" title="Dubbo æ¡†æ¶ï¼ˆRPC å®ç°ï¼‰"></a>Dubbo æ¡†æ¶ï¼ˆRPC å®ç°ï¼‰</h3><p>GRPCã€TRPC</p><p>é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://cn.dubbo.apache.org/zh/docs3-v2/java-sdk/quick-start/spring-boot/">https://cn.dubbo.apache.org/zh/docs3-v2/java-sdk/quick-start/spring-boot/</a></p><p>ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š</p><ol><li>Spring Boot ä»£ç ï¼ˆæ³¨è§£ + ç¼–ç¨‹å¼ï¼‰ï¼šå†™ Java æ¥å£ï¼ŒæœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…éƒ½å»å¼•ç”¨è¿™ä¸ªæ¥å£</li><li>IDLï¼ˆæ¥å£è°ƒç”¨è¯­è¨€ï¼‰ï¼šåˆ›å»ºä¸€ä¸ªå…¬å…±çš„æ¥å£å®šä¹‰æ–‡ä»¶ï¼ŒæœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…éƒ½å»è¯»å–è¿™ä¸ªæ–‡ä»¶ã€‚ä¼˜ç‚¹æ˜¯è·¨è¯­è¨€ï¼Œæ‰€æœ‰çš„æ¡†æ¶éƒ½ç†Ÿæ‚‰ã€‚</li></ol><p>åº•å±‚æ˜¯ Triple åè®®ï¼š<a href="https://cn.dubbo.apache.org/zh/docs3-v2/java-sdk/concepts-and-architecture/triple/">https://cn.dubbo.apache.org/zh/docs3-v2/java-sdk/concepts-and-architecture/triple/</a></p><h4 id="ç¤ºä¾‹å­¦ä¹ "><a href="#ç¤ºä¾‹å­¦ä¹ " class="headerlink" title="ç¤ºä¾‹å­¦ä¹ "></a>ç¤ºä¾‹å­¦ä¹ </h4><p>zookeeper æ³¨å†Œä¸­å¿ƒï¼šé€šè¿‡å†…åµŒçš„æ–¹å¼è¿è¡Œï¼Œæ›´æ–¹ä¾¿</p><p>æœ€å…ˆå¯åŠ¨æ³¨å†Œä¸­å¿ƒï¼Œå…ˆå¯åŠ¨æœåŠ¡æä¾›è€…ï¼Œåœ¨å¯åŠ¨æœåŠ¡æ¶ˆè´¹è€…</p><h3 id="æ•´åˆè¿ç”¨"><a href="#æ•´åˆè¿ç”¨" class="headerlink" title="æ•´åˆè¿ç”¨"></a>æ•´åˆè¿ç”¨</h3><ol><li>backend é¡¹ç›®ä½œä¸ºæœåŠ¡æä¾›è€…ï¼Œæä¾› 3 ä¸ªæ–¹æ³•ï¼š<ol><li>å®é™…æƒ…å†µåº”è¯¥æ˜¯å»æ•°æ®åº“ä¸­æŸ¥æ˜¯å¦å·²åˆ†é…ç»™ç”¨æˆ·</li><li>ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ¨¡æ‹Ÿæ¥å£æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠè¯·æ±‚æ–¹æ³•æ˜¯å¦åŒ¹é…ï¼ˆè¿˜å¯ä»¥æ ¡éªŒè¯·æ±‚å‚æ•°ï¼‰</li><li>è°ƒç”¨æˆåŠŸï¼Œæ¥å£è°ƒç”¨æ¬¡æ•° + 1 invokeCount</li></ol></li><li>gateway é¡¹ç›®ä½œä¸ºæœåŠ¡è°ƒç”¨è€…ï¼Œè°ƒç”¨è¿™ 3 ä¸ªæ–¹æ³•</li></ol><p>æ•´åˆ Nacos æ³¨å†Œä¸­å¿ƒï¼š<a href="https://cn.dubbo.apache.org/zh/docs3-v2/java-sdk/reference-manual/registry/nacos/">https://cn.dubbo.apache.org/zh/docs3-v2/java-sdk/reference-manual/registry/nacos/</a></p><p>æ³¨æ„ï¼š</p><ol><li>æœåŠ¡è°ƒç”¨ç±»å¿…é¡»åœ¨åŒä¸€åŒ…ä¸‹ï¼Œå»ºè®®æ˜¯æŠ½è±¡å‡ºä¸€ä¸ªå…¬å…±é¡¹ç›®ï¼ˆæ”¾æ¥å£ã€å®ä½“ç±»ç­‰ï¼‰</li><li>è®¾ç½®æ³¨è§£ï¼ˆæ¯”å¦‚å¯åŠ¨ç±»çš„ EnableDubboã€æ¥å£å®ç°ç±»å’Œ Bean å¼•ç”¨çš„æ³¨è§£ï¼‰</li><li>æ·»åŠ é…ç½®</li><li>æœåŠ¡è°ƒç”¨é¡¹ç›®å’Œæä¾›è€…é¡¹ç›®å°½é‡å¼•å…¥ç›¸åŒçš„ä¾èµ–å’Œé…ç½®</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https:<span class="comment">//mvnrepository.com/artifact/org.apache.dubbo/dubbo --&gt;</span></span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line">     &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;</span><br><span class="line">     &lt;artifactId&gt;dubbo&lt;/artifactId&gt;</span><br><span class="line">     &lt;version&gt;<span class="number">3.1</span><span class="number">.3</span>&lt;/version&gt;</span><br><span class="line"> &lt;/dependency&gt;</span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line">     &lt;groupId&gt;com.alibaba.nacos&lt;/groupId&gt;</span><br><span class="line">     &lt;artifactId&gt;nacos-client&lt;/artifactId&gt;</span><br><span class="line">     &lt;version&gt;<span class="number">2.1</span><span class="number">.0</span>&lt;/version&gt;</span><br><span class="line"> &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å…­ã€Dubbo-æ¡†æ¶&quot;&gt;&lt;a href=&quot;#å…­ã€Dubbo-æ¡†æ¶&quot; class=&quot;headerlink&quot; title=&quot;å…­ã€Dubbo æ¡†æ¶&quot;&gt;&lt;/a&gt;å…­ã€Dubbo æ¡†æ¶&lt;/h1&gt;&lt;h2 id=&quot;ç½‘å…³ä¸šåŠ¡é€»è¾‘&quot;&gt;&lt;a href=&quot;#ç½‘å…³ä¸šåŠ¡é€»è¾‘&quot; class=&quot;</summary>
      
    
    
    
    <category term="API å¼€æ”¾å¹³å°" scheme="http://example.com/categories/API-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0/"/>
    
    
    <category term="æ˜Ÿçƒé¡¹ç›®" scheme="http://example.com/tags/%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>ä¸‰ã€API å¼€æ”¾å¹³å°-æ¥å£å‘å¸ƒ</title>
    <link href="http://example.com/2022/12/22/%E4%B8%89%E3%80%81API%20%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0-%E6%8E%A5%E5%8F%A3%E5%8F%91%E5%B8%83/"/>
    <id>http://example.com/2022/12/22/%E4%B8%89%E3%80%81API%20%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0-%E6%8E%A5%E5%8F%A3%E5%8F%91%E5%B8%83/</id>
    <published>2022-12-22T04:05:34.057Z</published>
    <updated>2023-08-04T15:01:02.437Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸‰ã€æ¥å£å‘å¸ƒ-ä¸‹çº¿-è°ƒç”¨"><a href="#ä¸‰ã€æ¥å£å‘å¸ƒ-ä¸‹çº¿-è°ƒç”¨" class="headerlink" title="ä¸‰ã€æ¥å£å‘å¸ƒ-ä¸‹çº¿-è°ƒç”¨"></a>ä¸‰ã€æ¥å£å‘å¸ƒ-ä¸‹çº¿-è°ƒç”¨</h1><ol><li>å¼€å‘æ¥å£å‘å¸ƒã€ä¸‹çº¿çš„åŠŸèƒ½ï¼ˆç®¡ç†å‘˜ï¼‰</li><li>å‰ç«¯å»æµè§ˆæ¥å£ã€æŸ¥çœ‹æ¥å£æ–‡æ¡£ã€ç”³è¯·ç­¾åï¼ˆæ³¨å†Œï¼‰</li><li>åœ¨çº¿è°ƒè¯•ï¼ˆç”¨æˆ·ï¼‰</li><li>ç»Ÿè®¡ç”¨æˆ·è°ƒç”¨æ¥å£çš„æ¬¡æ•°</li><li>ä¼˜åŒ–ç³»ç»Ÿ - API ç½‘å…³</li></ol><h2 id="å¼€å‘æ¥å£å‘å¸ƒ-x2F-ä¸‹çº¿åŠŸèƒ½"><a href="#å¼€å‘æ¥å£å‘å¸ƒ-x2F-ä¸‹çº¿åŠŸèƒ½" class="headerlink" title="å¼€å‘æ¥å£å‘å¸ƒ&#x2F;ä¸‹çº¿åŠŸèƒ½"></a>å¼€å‘æ¥å£å‘å¸ƒ&#x2F;ä¸‹çº¿åŠŸèƒ½</h2><p>åå°æ¥å£ï¼š</p><p>å‘å¸ƒæ¥å£ï¼ˆä»…ç®¡ç†å‘˜å¯æ“ä½œï¼‰</p><ol><li>æ ¡éªŒè¯¥æ¥å£æ˜¯å¦å­˜åœ¨</li><li>åˆ¤æ–­è¯¥æ¥å£æ˜¯å¦å¯ä»¥è°ƒç”¨</li><li>ä¿®æ”¹æ¥å£æ•°æ®åº“ä¸­çš„çŠ¶æ€å­—æ®µä¸º 1</li></ol><p>ä¸‹çº¿æ¥å£ï¼ˆä»…ç®¡ç†å‘˜å¯æ“ä½œï¼‰</p><ol><li>æ ¡éªŒæ¥å£æ˜¯å¦å­˜åœ¨</li><li>ä¿®æ”¹æ¥å£æ•°æ®åº“ä¸­çš„çŠ¶æ€å­—æ®µä¸º 0</li></ol><h2 id="æŸ¥çœ‹æ¥å£æ–‡æ¡£"><a href="#æŸ¥çœ‹æ¥å£æ–‡æ¡£" class="headerlink" title="æŸ¥çœ‹æ¥å£æ–‡æ¡£"></a>æŸ¥çœ‹æ¥å£æ–‡æ¡£</h2><p>åŠ¨æ€è·¯ç”±ï¼Œç”¨ url æ¥ä¼ é€’ id, åŠ è½½ä¸åŒçš„æ¥å£ä¿¡æ¯</p><h2 id="ç”³è¯·ç­¾å"><a href="#ç”³è¯·ç­¾å" class="headerlink" title="ç”³è¯·ç­¾å"></a>ç”³è¯·ç­¾å</h2><p>ç”¨æˆ·åœ¨æ³¨å†ŒæˆåŠŸæ—¶ï¼Œè‡ªåŠ¨åˆ†é… accessKeyã€secretKey </p><p>æ‰©å±•ç‚¹ï¼šç”¨æˆ·å¯ä»¥ç”³è¯·æ›´æ¢ç­¾å</p><h2 id="åœ¨çº¿è°ƒç”¨"><a href="#åœ¨çº¿è°ƒç”¨" class="headerlink" title="åœ¨çº¿è°ƒç”¨"></a>åœ¨çº¿è°ƒç”¨</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;username&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure><p>å…ˆè·‘é€šæ•´ä¸ªæ¥å£æµç¨‹ï¼Œå†å»é’ˆå¯¹ä¸åŒçš„è¯·æ±‚å¤´æˆ–è€…æ¥å£ç±»å‹æ¥è®¾è®¡ç•Œé¢å’Œè¡¨å•ï¼Œç»™ç”¨æˆ·æ›´å¥½çš„ä½“éªŒã€‚ï¼ˆå¯ä»¥å‚è€ƒ swaggerã€postmanã€knife4j)</p><h2 id="è°ƒç”¨æµç¨‹"><a href="#è°ƒç”¨æµç¨‹" class="headerlink" title="è°ƒç”¨æµç¨‹"></a>è°ƒç”¨æµç¨‹</h2><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308042301122.png" alt="202212041910410"></p><p>æµç¨‹ï¼š</p><ol><li>å‰ç«¯å°†ç”¨æˆ·è¾“å…¥çš„è¯·æ±‚å‚æ•°å’Œè¦æµ‹è¯•çš„æ¥å£ id å‘ç»™å¹³å°åç«¯</li><li>åœ¨è°ƒç”¨å‰å¯ä»¥åšä¸€äº›æ ¡éªŒ</li><li>å¹³å°åç«¯å»è°ƒç”¨æ¨¡æ‹Ÿæ¥å£</li></ol><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><ul><li>åˆ¤æ–­è¯¥æ¥å£æ˜¯å¦å¯ä»¥è°ƒç”¨æ—¶æœ‰å›ºå®šæ–¹æ³•åæ”¹ä¸ºæ ¹æ®æµ‹è¯•åœ°å€æ¥è°ƒç”¨</li><li>ç”¨æˆ·æµ‹è¯•æ¥å£å›ºå®šæ–¹æ³•åæ”¹ä¸ºæ ¹æ®æµ‹è¯•åœ°å€æ¥è°ƒç”¨</li><li>æ¨¡æ‹Ÿæ¥å£æ”¹ä¸ºä»æ•°æ®åº“æ ¡éªŒ accessKey</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¸‰ã€æ¥å£å‘å¸ƒ-ä¸‹çº¿-è°ƒç”¨&quot;&gt;&lt;a href=&quot;#ä¸‰ã€æ¥å£å‘å¸ƒ-ä¸‹çº¿-è°ƒç”¨&quot; class=&quot;headerlink&quot; title=&quot;ä¸‰ã€æ¥å£å‘å¸ƒ-ä¸‹çº¿-è°ƒç”¨&quot;&gt;&lt;/a&gt;ä¸‰ã€æ¥å£å‘å¸ƒ-ä¸‹çº¿-è°ƒç”¨&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;å¼€å‘æ¥å£å‘å¸ƒã€ä¸‹çº¿çš„åŠŸèƒ½ï¼ˆç®¡ç†å‘˜ï¼‰&lt;/li&gt;
&lt;</summary>
      
    
    
    
    <category term="API å¼€æ”¾å¹³å°" scheme="http://example.com/categories/API-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0/"/>
    
    
    <category term="æ˜Ÿçƒé¡¹ç›®" scheme="http://example.com/tags/%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>API å¼€æ”¾å¹³å°è®¾è®¡</title>
    <link href="http://example.com/2022/12/22/%E4%B8%80%E3%80%81API%20%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0%E8%AE%BE%E8%AE%A1/"/>
    <id>http://example.com/2022/12/22/%E4%B8%80%E3%80%81API%20%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0%E8%AE%BE%E8%AE%A1/</id>
    <published>2022-12-22T04:04:12.627Z</published>
    <updated>2022-12-22T03:54:19.412Z</updated>
    
    <content type="html"><![CDATA[<h1 id="API-å¼€æ”¾å¹³å°"><a href="#API-å¼€æ”¾å¹³å°" class="headerlink" title="API å¼€æ”¾å¹³å°"></a>API å¼€æ”¾å¹³å°</h1><h2 id="ç¬¬ä¸€æœŸ"><a href="#ç¬¬ä¸€æœŸ" class="headerlink" title="ç¬¬ä¸€æœŸ"></a>ç¬¬ä¸€æœŸ</h2><p>é¡¹ç›®èƒŒæ™¯ï¼š</p><ol><li>å‰ç«¯å¼€å‘éœ€è¦ç”¨åˆ°åç«¯æ¥å£</li><li>ä½¿ç”¨ç°æˆçš„ç³»ç»Ÿçš„åŠŸèƒ½ï¼ˆ<a href="http://api.btstu.cn/%EF%BC%89">http://api.btstu.cn/ï¼‰</a></li></ol><p>API æ¥å£å¹³å°ï¼š</p><ol><li>é˜²æ­¢æ”»å‡»ï¼ˆå®‰å…¨æ€§ï¼‰</li><li>ä¸èƒ½éšä¾¿è°ƒç”¨ï¼ˆé™åˆ¶ã€å¼€é€šï¼‰</li><li><strong>ç»Ÿè®¡è°ƒç”¨æ¬¡æ•°</strong></li><li>è®¡è´¹</li><li>æµé‡ä¿æŠ¤</li><li>API æ¥å£</li></ol><h2 id="é¡¹ç›®ä»‹ç»"><a href="#é¡¹ç›®ä»‹ç»" class="headerlink" title="é¡¹ç›®ä»‹ç»"></a>é¡¹ç›®ä»‹ç»</h2><p>åšä¸€ä¸ªæä¾› API æ¥å£è°ƒç”¨çš„å¹³å°ï¼Œç”¨æˆ·å¯ä»¥æ³¨å†Œç™»å½•ï¼Œå¼€é€šæ¥å£è°ƒç”¨æƒé™ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨æ¥å£ï¼Œå¹¶ä¸”æ¯æ¬¡è°ƒç”¨ä¼šè¿›è¡Œç»Ÿè®¡ã€‚ç®¡ç†å‘˜å¯ä»¥å‘å¸ƒæ¥å£ã€ä¸‹çº¿æ¥å£ã€æ¥å…¥æ¥å£ï¼Œä»¥åŠå¯è§†åŒ–æ¥å£çš„è°ƒç”¨æƒ…å†µã€æ•°æ®ã€‚</p><h2 id="æŠ€æœ¯é€‰å‹"><a href="#æŠ€æœ¯é€‰å‹" class="headerlink" title="æŠ€æœ¯é€‰å‹"></a>æŠ€æœ¯é€‰å‹</h2><h3 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h3><ul><li>Ant Design Pro</li><li>React</li><li>Ant Design Procompoments</li><li>Umi</li><li>Umi Request (Axios çš„å°è£…)</li></ul><h3 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h3><ul><li>Java Spring Boot</li><li>Sring Boot Starter ï¼ˆSDK å¼€å‘ï¼‰</li></ul><h2 id="é¡¹ç›®è®¡åˆ’"><a href="#é¡¹ç›®è®¡åˆ’" class="headerlink" title="é¡¹ç›®è®¡åˆ’"></a>é¡¹ç›®è®¡åˆ’</h2><h3 id="ç¬¬ä¸€æœŸ-â€”-åˆå§‹åŒ–å±•ç¤º"><a href="#ç¬¬ä¸€æœŸ-â€”-åˆå§‹åŒ–å±•ç¤º" class="headerlink" title="ç¬¬ä¸€æœŸ â€”- åˆå§‹åŒ–å±•ç¤º"></a>ç¬¬ä¸€æœŸ â€”- åˆå§‹åŒ–å±•ç¤º</h3><p>é¡¹ç›®ä»‹ç»ã€è®¾è®¡ã€æŠ€æœ¯é€‰å‹</p><p>åŸºç¡€é¡¹ç›®æ­å»º</p><p>æ¥å£ç®¡ç†</p><p>ç”¨æˆ·æŸ¥çœ‹æ¥å£</p><h3 id="ç¬¬äºŒæœŸ-â€”-æ¥å£è°ƒç”¨"><a href="#ç¬¬äºŒæœŸ-â€”-æ¥å£è°ƒç”¨" class="headerlink" title="ç¬¬äºŒæœŸ â€”- æ¥å£è°ƒç”¨"></a>ç¬¬äºŒæœŸ â€”- æ¥å£è°ƒç”¨</h3><ol><li>ç»§ç»­å¼€å‘æ¥å£ç®¡ç†å‰ç«¯é¡µé¢</li><li>å¼€å‘è°ƒç”¨è¿™ä¸ªæ¥å£çš„ä»£ç </li><li>ä¿è¯è°ƒç”¨çš„å®‰å…¨æ€§<strong>ï¼ˆAPI ç­¾åè®¤è¯ï¼‰</strong></li><li>å®¢æˆ·ç«¯ SDK  çš„å¼€å‘</li><li>ç®¡ç†å‘˜æ¥å£ <strong>å‘å¸ƒ</strong> ä¸è°ƒç”¨</li><li>æ¥å£æ–‡æ¡£å±•ç¤ºã€æ¥å£åœ¨çº¿è°ƒç”¨</li></ol><h3 id="ç¬¬ä¸‰æœŸ-â€”â€“-æ¥å£è®¡è´¹ä¸ä¿æŠ¤"><a href="#ç¬¬ä¸‰æœŸ-â€”â€“-æ¥å£è®¡è´¹ä¸ä¿æŠ¤" class="headerlink" title="ç¬¬ä¸‰æœŸ â€”â€“ æ¥å£è®¡è´¹ä¸ä¿æŠ¤"></a>ç¬¬ä¸‰æœŸ â€”â€“ æ¥å£è®¡è´¹ä¸ä¿æŠ¤</h3><p>ç»Ÿè®¡ç”¨æˆ·è°ƒç”¨æ¥å£æ¬¡æ•°</p><p>é™æµ</p><p>è®¡è´¹</p><p>æ—¥å¿—</p><p>å¼€é€š</p><h3 id="ç¬¬å››æœŸ-â€”-ç®¡ç†ã€ç»Ÿè®¡åˆ†æ"><a href="#ç¬¬å››æœŸ-â€”-ç®¡ç†ã€ç»Ÿè®¡åˆ†æ" class="headerlink" title="ç¬¬å››æœŸ â€”- ç®¡ç†ã€ç»Ÿè®¡åˆ†æ"></a>ç¬¬å››æœŸ â€”- ç®¡ç†ã€ç»Ÿè®¡åˆ†æ</h3><p>æä¾›å¯è§†åŒ–å¹³å°ï¼Œç”¨å›¾è¡¨çš„æ–¹å±•ç¤ºæ‰€æœ‰æ¥å£çš„è°ƒç”¨æƒ…å†µï¼Œä¾¿äºè°ƒæ•´ä¸šåŠ¡</p><p><strong>å®ç°é¢„è­¦</strong></p><h2 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h2><ol><li>ç®¡ç†å‘˜å¯ä»¥å¯¹æ¥å£ä¿¡æ¯è¿›è¡Œå¢åˆ æ”¹æŸ¥</li><li>ç”¨æˆ·å¯ä»¥è®¿é—®å‰å°ï¼ŒæŸ¥çœ‹æ¥å£ä¿¡æ¯</li></ol><h2 id="æ•°æ®åº“è¡¨è®¾è®¡"><a href="#æ•°æ®åº“è¡¨è®¾è®¡" class="headerlink" title="æ•°æ®åº“è¡¨è®¾è®¡"></a>æ•°æ®åº“è¡¨è®¾è®¡</h2><h3 id="æ¥å£ä¿¡æ¯è¡¨"><a href="#æ¥å£ä¿¡æ¯è¡¨" class="headerlink" title="æ¥å£ä¿¡æ¯è¡¨"></a>æ¥å£ä¿¡æ¯è¡¨</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æ¥å£ä¿¡æ¯è¡¨</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> mofeng.`interface_info`</span><br><span class="line">(</span><br><span class="line">    `id` <span class="type">bigint</span> <span class="keyword">not</span> <span class="keyword">null</span> auto_increment comment <span class="string">&#x27;ä¸»é”®&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    `name` <span class="type">varchar</span>(<span class="number">256</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>,</span><br><span class="line">    `description` <span class="type">varchar</span>(<span class="number">256</span>) <span class="keyword">null</span> comment <span class="string">&#x27;æè¿°&#x27;</span>,</span><br><span class="line">    `url` <span class="type">varchar</span>(<span class="number">512</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ¥å£åœ°å€&#x27;</span>,</span><br><span class="line">    `requestHeader` text <span class="keyword">null</span> comment <span class="string">&#x27;è¯·æ±‚å¤´&#x27;</span>,</span><br><span class="line">    `responseHeader` text <span class="keyword">null</span> comment <span class="string">&#x27;å“åº”å¤´&#x27;</span>,</span><br><span class="line">    `userId` <span class="type">varchar</span>(<span class="number">256</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `status` <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ¥å£çŠ¶æ€ï¼ˆ0 - å…³é—­ï¼Œ 1 - å¼€å¯ï¼‰ï¼‰&#x27;</span>,</span><br><span class="line">    `<span class="keyword">method</span>` <span class="type">varchar</span>(<span class="number">256</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;è¯·æ±‚ç±»å‹&#x27;</span>,</span><br><span class="line">    `createTime` datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `updateTime` datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    `isDelete` tinyint <span class="keyword">default</span> <span class="number">0</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ˜¯å¦åˆ é™¤(0-æœªåˆ , 1-å·²åˆ )&#x27;</span></span><br><span class="line">    ) comment <span class="string">&#x27;æ¥å£ä¿¡æ¯è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="é¡¹ç›®è„šæ‰‹æ¶"><a href="#é¡¹ç›®è„šæ‰‹æ¶" class="headerlink" title="é¡¹ç›®è„šæ‰‹æ¶"></a>é¡¹ç›®è„šæ‰‹æ¶</h2><p>å‰ç«¯ï¼šAnt Design Pro è„šæ‰‹æ¶</p><p>åç«¯ï¼šSpring Boot é€šç”¨æ¨¡æ¿</p><h2 id="åŸºç¡€åŠŸèƒ½"><a href="#åŸºç¡€åŠŸèƒ½" class="headerlink" title="åŸºç¡€åŠŸèƒ½"></a>åŸºç¡€åŠŸèƒ½</h2><p>å¢åˆ æ”¹æŸ¥ã€ç™»å½•ï¼ˆå¤åˆ¶ã€ç²˜è´´ï¼‰</p><p>å‰ç«¯æ¥å£è°ƒç”¨ï¼šoneapi æ’ä»¶è‡ªåŠ¨ç”Ÿæˆ</p><p>openapi  çš„è§„èŒƒ</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;API-å¼€æ”¾å¹³å°&quot;&gt;&lt;a href=&quot;#API-å¼€æ”¾å¹³å°&quot; class=&quot;headerlink&quot; title=&quot;API å¼€æ”¾å¹³å°&quot;&gt;&lt;/a&gt;API å¼€æ”¾å¹³å°&lt;/h1&gt;&lt;h2 id=&quot;ç¬¬ä¸€æœŸ&quot;&gt;&lt;a href=&quot;#ç¬¬ä¸€æœŸ&quot; class=&quot;headerlink&quot; ti</summary>
      
    
    
    
    <category term="API å¼€æ”¾å¹³å°" scheme="http://example.com/categories/API-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0/"/>
    
    
    <category term="æ˜Ÿçƒé¡¹ç›®" scheme="http://example.com/tags/%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>API å¼€æ”¾å¹³å°å››-ç½‘å…³</title>
    <link href="http://example.com/2022/12/22/%E5%9B%9B%E3%80%81API-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0-%E7%BD%91%E5%85%B3/"/>
    <id>http://example.com/2022/12/22/%E5%9B%9B%E3%80%81API-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0-%E7%BD%91%E5%85%B3/</id>
    <published>2022-12-22T04:04:12.625Z</published>
    <updated>2023-08-04T15:02:01.002Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å››ã€ç½‘å…³"><a href="#å››ã€ç½‘å…³" class="headerlink" title="å››ã€ç½‘å…³"></a>å››ã€ç½‘å…³</h1><ol><li>å¼€å‘æ¥å£è°ƒç”¨æ¬¡æ•°çš„è®¾è®¡</li><li>ä¼˜åŒ–æ•´ä¸ªç³»ç»Ÿçš„æ¶æ„ï¼ˆAPI ç½‘å…³ï¼‰<ol><li>ç½‘å…³æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>ç½‘å…³çš„ä½œç”¨</li><li>ç½‘å…³çš„åº”ç”¨åœºæ™¯åŠå®ç°</li><li>ç»“åˆä¸šåŠ¡åº”ç”¨ç½‘å…³</li></ol></li></ol><h2 id="æ¥å£è°ƒç”¨æ¬¡æ•°ç»Ÿè®¡"><a href="#æ¥å£è°ƒç”¨æ¬¡æ•°ç»Ÿè®¡" class="headerlink" title="æ¥å£è°ƒç”¨æ¬¡æ•°ç»Ÿè®¡"></a>æ¥å£è°ƒç”¨æ¬¡æ•°ç»Ÿè®¡</h2><p>éœ€æ±‚ï¼š</p><ol><li><strong>ç”¨æˆ·æ¯æ¬¡è°ƒç”¨æ¥å£æˆåŠŸï¼Œæ¬¡æ•° + 1</strong></li><li>ç»™ç”¨æˆ·åˆ†é…æˆ–è€…ç”¨æˆ·è‡ªä¸»ç”³è¯·æ¥å£è°ƒç”¨æ¬¡æ•°</li></ol><p>ä¸šåŠ¡æµç¨‹ï¼š</p><ol><li>ç”¨æˆ·è°ƒç”¨æ¥å£</li><li>ä¿®æ”¹æ•°æ®åº“ï¼Œè°ƒç”¨æ¬¡æ•° + 1</li></ol><p>è®¾è®¡åº“è¡¨ï¼š</p><p>å“ªä¸ªç”¨æˆ·ï¼Ÿå“ªä¸ªæ¥å£ï¼Ÿ</p><p>ç”¨æˆ· &#x3D;&gt; æ¥å£ ï¼ˆå¤šå¯¹å¤šå…³ç³»ï¼‰</p><p>ç”¨æˆ·è°ƒç”¨æ¥å£å…³ç³»è¡¨ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ç”¨æˆ·è°ƒç”¨æ¥å£å…³ç³»è¡¨</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> user_interface_info</span><br><span class="line">(</span><br><span class="line">    id            <span class="type">bigint</span> auto_increment comment <span class="string">&#x27;id&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    userId        <span class="type">bigint</span>  comment <span class="string">&#x27;è°ƒç”¨ç”¨æˆ· id&#x27;</span>,</span><br><span class="line">    interfaceInfoId        <span class="type">bigint</span>  comment <span class="string">&#x27;æ¥å£ id&#x27;</span>,</span><br><span class="line">    totalNum       <span class="type">int</span>     <span class="keyword">default</span> <span class="number">0</span> comment <span class="string">&#x27;æ€»è°ƒç”¨æ¬¡æ•°&#x27;</span>,</span><br><span class="line">    leftNum       <span class="type">int</span>     <span class="keyword">default</span> <span class="number">0</span> comment <span class="string">&#x27;å‰©ä½™è°ƒç”¨æ¬¡æ•°&#x27;</span>,</span><br><span class="line">    status       <span class="type">int</span>     <span class="keyword">default</span> <span class="number">0</span> comment <span class="string">&#x27;0-æ­£å¸¸ï¼Œ 1-ç¦ç”¨&#x27;</span>,</span><br><span class="line">    createTime    datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    updateTime    datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    isDelete      tinyint  <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ˜¯å¦åˆ é™¤&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;ç”¨æˆ·è°ƒç”¨æ¥å£å…³ç³»è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure><p>æ­¥éª¤ï¼š</p><ol><li>å¼€å‘åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥ï¼ˆç»™ç®¡ç†å‘˜ç”¨ï¼‰</li><li>å¼€å‘ç”¨æˆ·è°ƒç”¨æ¥å£æ¬¡æ•° + 1 çš„åŠŸèƒ½ï¼ˆserviceï¼‰</li></ol><p>é—®é¢˜ï¼š</p><p>å¦‚æœæ¯ä¸ªæ¥å£çš„æ–¹æ³•éƒ½å†™è°ƒç”¨æ¬¡æ•° + 1ï¼Œ è¿‡äºéº»çƒ¦</p><p>è‡´å‘½é—®é¢˜ï¼šæ¥å£å¼€å‘è€…éœ€è¦è‡ªå·±å»æ·»åŠ ç»Ÿè®¡ä»£ç </p><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308042301249.png" alt="image-20221204192719518"></p><p>ä½¿ç”¨ AOP åˆ‡é¢çš„ä¼˜ç‚¹ï¼šç‹¬ç«‹äºæ¥å£ï¼Œåœ¨æ¯ä¸ªæ¥å£è°ƒç”¨åæ¬¡æ•° + 1</p><p>AOP åˆ‡é¢çš„ç¼ºç‚¹ï¼šåªå­˜åœ¨å•ä¸ªé¡¹ç›®ä¸­ï¼Œå¦‚æœæ¯ä¸ªå›¢é˜Ÿéƒ½è¦å¼€å‘è‡ªå·±çš„æ¨¡æ‹Ÿæ¥å£ï¼Œé‚£ä¹ˆéƒ½è¦å†™ä¸€ä¸ªåˆ‡é¢</p><h2 id="ç½‘å…³"><a href="#ç½‘å…³" class="headerlink" title="ç½‘å…³"></a>ç½‘å…³</h2><h3 id="ç½‘å…³çš„ä½œç”¨"><a href="#ç½‘å…³çš„ä½œç”¨" class="headerlink" title="ç½‘å…³çš„ä½œç”¨"></a>ç½‘å…³çš„ä½œç”¨</h3><ol><li>è·¯ç”±</li><li>è´Ÿè½½å‡è¡¡</li><li>ç»Ÿä¸€é‰´æƒ</li><li>è·¨åŸŸ</li><li>ç»Ÿä¸€ä¸šåŠ¡å¤„ç†ï¼ˆç¼“å­˜ï¼‰</li><li>è®¿é—®æ§åˆ¶</li><li>å‘å¸ƒæ§åˆ¶</li><li>æµé‡æŸ“è‰²</li><li>æ¥å£ä¿æŠ¤<ol><li>é™åˆ¶è¯·æ±‚</li><li>ä¿¡æ¯è„±æ•</li><li>é™çº§ï¼ˆç†”æ–­ï¼‰</li><li>é™æµï¼šå­¦ä¹ ä»¤ç‰Œæ¡¶ç®—æ³•ã€å­¦ä¹ æ¼æ¡¶ç®—æ³•ï¼Œå­¦ä¹ ä¸€ä¸‹ RedisLimitHandler</li><li>è¶…æ—¶æ—¶é—´</li></ol></li><li>ç»Ÿä¸€æ—¥å¿—</li><li>ç»Ÿä¸€æ–‡æ¡£</li></ol><h3 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h3><p>èµ·åˆ°è½¬å‘çš„ä½œç”¨ï¼Œæ¯”å¦‚æœ‰æ¥å£ A å’Œæ¥å£ Bï¼Œ ç½‘å…³ä¼šè®°å½•è¿™äº›ä¿¡æ¯ï¼Œæ ¹æ®ç”¨æˆ·è®¿é—®çš„åœ°å€å’Œå‚æ•°ï¼Œè½¬å‘è¯·æ±‚åˆ°å¯¹åº”çš„æ¥å£ï¼ˆæœåŠ¡å™¨&#x2F;é›†ç¾¤ï¼‰</p><p>&#x2F;a &#x3D;&gt; æ¥å£ A</p><p>&#x2F;b &#x3D;&gt; æ¥å£ B</p><p>Gateway è·¯ç”±ï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gateway-request-predicates-factories">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gateway-request-predicates-factories</a></p><h3 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h3><p>åœ¨è·¯ç”±çš„åŸºç¡€ä¸Š</p><p>&#x2F;c &#x3D;&gt; æœåŠ¡ A &#x2F; é›†ç¾¤ A ï¼ˆéšæœºè½¬å‘åˆ°å…¶ä¸­çš„æŸä¸€ä¸ªæœºå™¨ï¼‰</p><p>uri ä»å›ºå®šåœ°å€æ”¹æˆ lb:xxxx</p><h3 id="ç»Ÿä¸€å¤„ç†è·¨åŸŸ"><a href="#ç»Ÿä¸€å¤„ç†è·¨åŸŸ" class="headerlink" title="ç»Ÿä¸€å¤„ç†è·¨åŸŸ"></a>ç»Ÿä¸€å¤„ç†è·¨åŸŸ</h3><p>ç½‘å…³ç»Ÿä¸€å¤„ç†è·¨åŸŸï¼Œä¸ç”¨åœ¨æ¯ä¸ªé¡¹ç›®é‡Œå•ç‹¬å¤„ç†</p><p>GateWay å¤„ç†è·¨åŸŸï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#cors-configuration">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#cors-configuration</a></p><h3 id="å‘å¸ƒæ§åˆ¶"><a href="#å‘å¸ƒæ§åˆ¶" class="headerlink" title="å‘å¸ƒæ§åˆ¶"></a>å‘å¸ƒæ§åˆ¶</h3><p>ç°åº¦å‘å¸ƒï¼Œæ¯”å¦‚ä¸Šçº¿æ–°æ¥å£ï¼Œå…ˆç»™æ–°æ¥å£åˆ†é… 20% çš„æµé‡ï¼Œè€æ¥å£ 80%ï¼Œ å†æ…¢æ…¢è°ƒæ•´æ¯”ä¾‹</p><p><a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-weight-route-predicate-factory">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-weight-route-predicate-factory</a></p><h3 id="æµé‡æŸ“è‰²"><a href="#æµé‡æŸ“è‰²" class="headerlink" title="æµé‡æŸ“è‰²"></a>æµé‡æŸ“è‰²</h3><p>ç»™è¯·æ±‚ï¼ˆæµé‡ï¼‰æ·»åŠ ä¸€äº›æ ‡è¯†ï¼Œä¸€èˆ¬æ˜¯è®¾ç½®è¯·æ±‚å¤´ä¸­ï¼Œæ·»åŠ æ–°çš„è¯·æ±‚å¤´</p><p><a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-addrequestheader-gatewayfilter-factory">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-addrequestheader-gatewayfilter-factory</a></p><p>å…¨å±€æŸ“è‰²ï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#default-filters">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#default-filters</a></p><h3 id="ç»Ÿä¸€æ¥å£ä¿æŠ¤"><a href="#ç»Ÿä¸€æ¥å£ä¿æŠ¤" class="headerlink" title="ç»Ÿä¸€æ¥å£ä¿æŠ¤"></a>ç»Ÿä¸€æ¥å£ä¿æŠ¤</h3><ol><li>é™åˆ¶è¯·æ±‚ï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#requestheadersize-gatewayfilter-factory">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#requestheadersize-gatewayfilter-factory</a></li><li>ä¿¡æ¯è„±æ•ï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-removerequestheader-gatewayfilter-factory">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-removerequestheader-gatewayfilter-factory</a></li><li>é™çº§ï¼ˆç†”æ–­ï¼‰ï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#fallback-headers">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#fallback-headers</a></li><li>é™æµï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-requestratelimiter-gatewayfilter-factory">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-requestratelimiter-gatewayfilter-factory</a></li><li>è¶…æ—¶æ—¶é—´ï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#http-timeouts-configuration">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#http-timeouts-configuration</a></li><li>é‡è¯•ï¼ˆä¸šåŠ¡ä¿æŠ¤ï¼‰ï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-retry-gatewayfilter-factory">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-retry-gatewayfilter-factory</a></li></ol><h3 id="ç»Ÿä¸€ä¸šåŠ¡å¤„ç†"><a href="#ç»Ÿä¸€ä¸šåŠ¡å¤„ç†" class="headerlink" title="ç»Ÿä¸€ä¸šåŠ¡å¤„ç†"></a>ç»Ÿä¸€ä¸šåŠ¡å¤„ç†</h3><p>æŠŠæ¯ä¸ªé¡¹ç›®ä¸­éƒ½è¦åšçš„é€šç”¨é€»è¾‘æ”¾åˆ°ä¸Šå±‚ï¼ˆç½‘å…³ï¼‰ï¼Œç»Ÿä¸€å¤„ç†ï¼Œæ¯”å¦‚æœ¬é¡¹ç›®çš„æ¬¡æ•°ç»Ÿè®¡</p><h3 id="ç»Ÿä¸€é‰´æƒ"><a href="#ç»Ÿä¸€é‰´æƒ" class="headerlink" title="ç»Ÿä¸€é‰´æƒ"></a>ç»Ÿä¸€é‰´æƒ</h3><p>åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰æƒé™è¿›è¡Œæ“ä½œï¼Œæ— è®ºè®¿é—®ä»€ä¹ˆæ¥å£ï¼Œéƒ½ç»Ÿä¸€éªŒè¯æƒé™ï¼Œé¿å…é‡å¤å†™éªŒè¯æƒé™æ“ä½œã€‚</p><h3 id="è®¿é—®æ§åˆ¶"><a href="#è®¿é—®æ§åˆ¶" class="headerlink" title="è®¿é—®æ§åˆ¶"></a>è®¿é—®æ§åˆ¶</h3><p>é»‘ç™½åå•ï¼Œæ¯”å¦‚é™åˆ¶ DDOS IP</p><h3 id="ç»Ÿä¸€æ—¥å¿—"><a href="#ç»Ÿä¸€æ—¥å¿—" class="headerlink" title="ç»Ÿä¸€æ—¥å¿—"></a>ç»Ÿä¸€æ—¥å¿—</h3><p>ç»Ÿä¸€çš„è¯·æ±‚ã€å“åº”ä¿¡æ¯è®°å½•</p><h3 id="ç»Ÿä¸€æ–‡æ¡£"><a href="#ç»Ÿä¸€æ–‡æ¡£" class="headerlink" title="ç»Ÿä¸€æ–‡æ¡£"></a>ç»Ÿä¸€æ–‡æ¡£</h3><p>å°†ä¸‹æ¸¸é¡¹ç›®çš„æ–‡æ¡£è¿›è¡Œèšåˆï¼Œåœ¨ä¸€ä¸ªé¡µé¢ç»Ÿä¸€æŸ¥çœ‹</p><p>å¯ä»¥ä½¿ç”¨ knife4j : <a href="https://doc.xiaominfo.com/docs/middleware-sources/aggregation-introduction">https://doc.xiaominfo.com/docs/middleware-sources/aggregation-introduction</a></p><h2 id="ç½‘å…³çš„åˆ†ç±»"><a href="#ç½‘å…³çš„åˆ†ç±»" class="headerlink" title="ç½‘å…³çš„åˆ†ç±»"></a>ç½‘å…³çš„åˆ†ç±»</h2><ol><li>å…¨å±€ç½‘å…³ï¼ˆæ¥å…¥å±‚ç½‘å…³ï¼‰ï¼š ä½œç”¨æ˜¯è´Ÿè½½å‡è¡¡ã€è¯·æ±‚æ—¥å¿—ç­‰ï¼Œä¸å’Œä¸šåŠ¡é€»è¾‘ç»‘å®š</li><li>ä¸šåŠ¡ç½‘å…³ï¼ˆå¾®æœåŠ¡ç½‘å…³ï¼‰ï¼š å­˜åœ¨ä¸€äº›ä¸šåŠ¡é€»è¾‘ï¼Œä½œç”¨æ˜¯å°†è¯·æ±‚è½¬å‘åˆ°ä¸åŒçš„ä¸šåŠ¡&#x2F;é¡¹ç›®&#x2F;æ¥å£&#x2F;æœåŠ¡</li></ol><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/qq_21040559/article/details/122961395">https://blog.csdn.net/qq_21040559/article/details/122961395</a></p><h2 id="å®ç°ç½‘å…³"><a href="#å®ç°ç½‘å…³" class="headerlink" title="å®ç°ç½‘å…³"></a>å®ç°ç½‘å…³</h2><ol><li>Nginx ï¼ˆå…¨å±€ç½‘å…³ï¼‰ã€Kong ç½‘å…³ ï¼ˆAPI ç½‘å…³ï¼Œ Kong: <a href="https://github.com/Kong/kong">https://github.com/Kong/kong</a>), ç¼–ç¨‹æˆæœ¬ç›¸å¯¹é«˜ç‚¹</li><li>Spring Cloud GateWay (å–ä»£äº† Zuul ) , æ€§èƒ½é«˜ã€å¯ä»¥ç”¨ Java ä»£ç æ¥å†™é€»è¾‘ï¼Œé€‚åˆå­¦ä¹ </li></ol><p>ç½‘å…³çš„æŠ€æœ¯é€‰å‹ï¼š<a href="https://zhuanlan.zhihu.com/p/500587132">https://zhuanlan.zhihu.com/p/500587132</a></p><h2 id="Spring-Cloud-GateWay-ç”¨æ³•"><a href="#Spring-Cloud-GateWay-ç”¨æ³•" class="headerlink" title="Spring Cloud GateWay ç”¨æ³•"></a>Spring Cloud GateWay ç”¨æ³•</h2><p>å®˜ç½‘ï¼š<a href="https://spring.io/projects/spring-cloud-gateway/">https://spring.io/projects/spring-cloud-gateway/</a></p><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/</a></p><h3 id="æ ¸å¿ƒæ¦‚å¿µ"><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µ"></a>æ ¸å¿ƒæ¦‚å¿µ</h3><p>è·¯ç”±ï¼ˆæ ¹æ®ä»€ä¹ˆæ¡ä»¶ï¼Œè½¬å‘åˆ°å“ªé‡Œå»ï¼‰</p><p>æ–­è¨€ï¼šä¸€ç»„è§„åˆ™ã€æ¡ä»¶ï¼Œ ç”¨æ¥ç¡®å®šå¦‚ä½•è½¬å‘è·¯ç”±</p><p>è¿‡æ»¤å™¨ï¼š å¯¹è¯·æ±‚è¿›è¡Œä¸€ç³»åˆ—çš„å¤„ç†ï¼Œ æ¯”å¦‚æ·»åŠ è¯·æ±‚å¤´ã€æ·»åŠ è¯·æ±‚å‚æ•°</p><p>è¯·æ±‚æµç¨‹ï¼š</p><ol><li>å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚</li><li>Handler Mapping: æ ¹æ®æ–­è¨€ï¼Œå°†è¯·æ±‚è½¬å‘åˆ°å¯¹åº”çš„è·¯ç”±</li><li>Web Handlerï¼š å¤„ç†è¯·æ±‚ï¼ˆä¸€å±‚å±‚ç»è¿‡è¿‡æ»¤å™¨ï¼‰</li><li>å®é™…è°ƒç”¨æœåŠ¡</li></ol><p><img src="https://cdn.jsdelivr.net/gh/lumofeng/blog-img/202308042301246.png" alt="image-20221204202459676"></p><h3 id="ä¸¤ç§é…ç½®æ–¹å¼"><a href="#ä¸¤ç§é…ç½®æ–¹å¼" class="headerlink" title="ä¸¤ç§é…ç½®æ–¹å¼"></a>ä¸¤ç§é…ç½®æ–¹å¼</h3><ol><li>é…ç½®å¼ï¼ˆæ–¹ä¾¿ã€è§„èŒƒï¼‰<ol><li>ç®€åŒ–ç‰ˆ</li><li>å…¨ç§°ç‰ˆ</li></ol></li><li>ç¼–ç¨‹å¼ï¼ˆçµæ´»ã€ç›¸å¯¹éº»çƒ¦ï¼‰</li></ol><h3 id="å¼€å¯æ—¥å¿—"><a href="#å¼€å¯æ—¥å¿—" class="headerlink" title="å¼€å¯æ—¥å¿—"></a>å¼€å¯æ—¥å¿—</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">org:</span></span><br><span class="line">      <span class="attr">springframework:</span></span><br><span class="line">        <span class="attr">cloud:</span></span><br><span class="line">          <span class="attr">gateway:</span> <span class="string">trace</span></span><br></pre></td></tr></table></figure><h3 id="æ–­è¨€"><a href="#æ–­è¨€" class="headerlink" title="æ–­è¨€"></a>æ–­è¨€</h3><ol><li>After åœ¨ xx æ—¶é—´ä¹‹å</li><li>Before åœ¨ xx æ—¶é—´ä¹‹å‰</li><li>Between åœ¨ xx æ—¶é—´ä¹‹é—´</li><li>è¯·æ±‚ç±»åˆ«</li><li>è¯·æ±‚å¤´ï¼ˆåŒ…å« cookieï¼‰</li><li>æŸ¥è¯¢å‚æ•°</li><li>å®¢æˆ·ç«¯åœ°å€</li><li><strong>æƒé‡</strong></li></ol><h3 id="è¿‡æ»¤å™¨"><a href="#è¿‡æ»¤å™¨" class="headerlink" title="è¿‡æ»¤å™¨"></a>è¿‡æ»¤å™¨</h3><p>åŸºæœ¬åŠŸèƒ½ï¼šå¯¹è¯·æ±‚å¤´ã€è¯·æ±‚å‚æ•°ã€å“åº”å¤´çš„å¢åˆ æ”¹æŸ¥</p><ol><li>æ·»åŠ è¯·æ±‚å¤´</li><li>æ·»åŠ è¯·æ±‚å‚æ•°</li><li>æ·»åŠ å“åº”å¤´</li><li>é™çº§</li><li>é™æµ</li><li>é‡è¯•</li></ol><p>å¼•å…¥ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-starter-circuitbreaker-reactor-resilience4j&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å››ã€ç½‘å…³&quot;&gt;&lt;a href=&quot;#å››ã€ç½‘å…³&quot; class=&quot;headerlink&quot; title=&quot;å››ã€ç½‘å…³&quot;&gt;&lt;/a&gt;å››ã€ç½‘å…³&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;å¼€å‘æ¥å£è°ƒç”¨æ¬¡æ•°çš„è®¾è®¡&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–æ•´ä¸ªç³»ç»Ÿçš„æ¶æ„ï¼ˆAPI ç½‘å…³ï¼‰&lt;ol&gt;
&lt;li&gt;ç½‘å…³æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/l</summary>
      
    
    
    
    <category term="API å¼€æ”¾å¹³å°" scheme="http://example.com/categories/API-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0/"/>
    
    
    <category term="æ˜Ÿçƒé¡¹ç›®" scheme="http://example.com/tags/%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>äºŒã€API å¼€æ”¾å¹³å°-æ¨¡æ‹Ÿæ¥å£</title>
    <link href="http://example.com/2022/12/22/%E4%BA%8C%E3%80%81API%20%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0-%E6%A8%A1%E6%8B%9F%E6%8E%A5%E5%8F%A3/"/>
    <id>http://example.com/2022/12/22/%E4%BA%8C%E3%80%81API%20%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0-%E6%A8%A1%E6%8B%9F%E6%8E%A5%E5%8F%A3/</id>
    <published>2022-12-22T04:04:12.619Z</published>
    <updated>2022-12-22T04:01:48.227Z</updated>
    
    <content type="html"><![CDATA[<h1 id="äºŒã€API-å¼€æ”¾å¹³å°-æ¨¡æ‹Ÿæ¥å£"><a href="#äºŒã€API-å¼€æ”¾å¹³å°-æ¨¡æ‹Ÿæ¥å£" class="headerlink" title="äºŒã€API å¼€æ”¾å¹³å°-æ¨¡æ‹Ÿæ¥å£"></a>äºŒã€API å¼€æ”¾å¹³å°-æ¨¡æ‹Ÿæ¥å£</h1><h2 id="æ¨¡æ‹Ÿæ¥å£é¡¹ç›®-mofeng-interface"><a href="#æ¨¡æ‹Ÿæ¥å£é¡¹ç›®-mofeng-interface" class="headerlink" title="æ¨¡æ‹Ÿæ¥å£é¡¹ç›® mofeng-interface"></a>æ¨¡æ‹Ÿæ¥å£é¡¹ç›® mofeng-interface</h2><p>æä¾›ä¸‰ä¸ªæ¨¡æ‹Ÿæ¥å£</p><ol><li>GET æ¥å£</li><li>POST æ¥å£ï¼ˆURL ä¼ å‚ï¼‰</li><li>POST æ¥å£ ï¼ˆRestful)</li></ol><h3 id="è°ƒç”¨æ¥å£"><a href="#è°ƒç”¨æ¥å£" class="headerlink" title="è°ƒç”¨æ¥å£"></a>è°ƒç”¨æ¥å£</h3><p>å‡ ç§ HTTP è°ƒç”¨æ–¹å¼ï¼š</p><ol><li>HttpClient</li><li>RestTemplate</li><li>ç¬¬ä¸‰æ–¹åº“ï¼ˆOKHTTPã€Hutool)</li></ol><p>Hutool:<a href="https://hutool.cn/docs/#/">https://hutool.cn/docs/#/</a></p><p>Http å·¥å…·ç±»ï¼š<a href="https://hutool.cn/docs/#/http/Http%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%B7%A5%E5%85%B7%E7%B1%BB-HttpUtil">https://hutool.cn/docs/#/http/Http%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%B7%A5%E5%85%B7%E7%B1%BB-HttpUtil</a></p><h3 id="API-ç­¾åè®¤è¯"><a href="#API-ç­¾åè®¤è¯" class="headerlink" title="API ç­¾åè®¤è¯"></a>API ç­¾åè®¤è¯</h3><p>æœ¬è´¨ï¼š</p><ol><li>ç­¾åç­¾å‘</li><li>ä½¿ç”¨ç­¾åï¼ˆæ ¡éªŒç­¾åï¼‰</li></ol><p>ä¸ºä»€ä¹ˆéœ€è¦ç­¾åè®¤è¯ï¼Ÿ</p><p>ä¿è¯å®‰å…¨æ€§ï¼Œé˜²æ­¢æ¶æ„è°ƒç”¨</p><h3 id="å¦‚ä½•å®ç°-API-ç­¾åè®¤è¯å‘¢ï¼Ÿ"><a href="#å¦‚ä½•å®ç°-API-ç­¾åè®¤è¯å‘¢ï¼Ÿ" class="headerlink" title="å¦‚ä½•å®ç° API ç­¾åè®¤è¯å‘¢ï¼Ÿ"></a>å¦‚ä½•å®ç° API ç­¾åè®¤è¯å‘¢ï¼Ÿ</h3><p>é€šè¿‡ http request header å¤´ä¼ é€’å‚æ•°</p><ul><li><p>å‚æ•°1ï¼š accessKey è°ƒç”¨çš„æ ‡è¯† userA, userB (å¤æ‚ã€æ— åºã€æ— è§„å¾‹)</p></li><li><p>å‚æ•°2ï¼š secretKey å¯†é’¥ ï¼ˆå¤æ‚ã€æ— åºã€æ— è§„å¾‹ï¼‰ï¼Œ<strong>è¯¥å‚æ•°ä¸èƒ½æ”¾åœ¨è¯·æ±‚å¤´ä¸­</strong></p><p>ç±»ä¼¼äºç”¨æˆ·åå’Œå¯†ç ï¼ŒåŒºåˆ«ï¼šaccessKeyã€ secretKey æ˜¯æ— çŠ¶æ€çš„</p><p>å¯†é’¥ä¸€èˆ¬ä¸ç”¨åœ¨æœåŠ¡å™¨ä¹‹é—´çš„ä¼ é€’ï¼Œå› ä¸ºåœ¨ä¼ é€’è¿‡ç¨‹ä¸­å¯èƒ½è¢«æ‹¦æˆª</p></li><li><p>å‚æ•°3ï¼š ç”¨æˆ·è¯·æ±‚å‚æ•°</p></li><li><p>å‚æ•°4ï¼š sign</p></li><li><p>å‚æ•°5ï¼šåŠ  none éšæœºæ•°ï¼Œ åªèƒ½ç”¨ä¸€æ¬¡ï¼ˆæœåŠ¡ç«¯è¦ä¿å­˜ç”¨è¿‡çš„éšæœºæ•°ï¼‰</p></li><li><p>å‚æ•°6ï¼š åŠ  timestamp æ—¶é—´æˆ³ï¼Œ æ ¡éªŒæ—¶é—´æˆ³æ˜¯å¦è¿‡æœŸ</p></li></ul><p>åŠ å¯†æ–¹å¼ï¼šå¯¹ç§°åŠ å¯†ã€éå¯¹ç§°åŠ å¯†ã€md5 ç­¾åï¼ˆä¸å¯è§£å¯†ï¼‰</p><p>ç”¨æˆ·å‚æ•° + å¯†é’¥ &#x3D;&gt; <strong>ç­¾åç”Ÿæˆç®—æ³•(MD5ã€Hmacã€Sha1)</strong> &#x3D;&gt; ä¸å¯è§£å¯†çš„å€¼</p><p>å¦‚ï¼šabc + abcdefgh &#x3D;&gt; sfasfafffsfsa</p><p>å¦‚ä½•éªŒè¯ç­¾åï¼Ÿ</p><p><strong>æœåŠ¡ç«¯ç”¨ä¸€æ¨¡ä¸€æ ·çš„å‚æ•°å’Œç®—æ³•å»ç”Ÿæˆç­¾åï¼Œåªè¦å’Œç”¨æˆ·ä¼ çš„ä¸€è‡´ï¼Œå°±è¡¨ç¤ºä¸€è‡´ã€‚</strong></p><p>å¦‚æœé˜²æ­¢é‡æ”¾ï¼Ÿ</p><p><strong>æœåŠ¡ç«¯è¦ä¿å­˜ç”¨è¿‡çš„éšæœºæ•°</strong></p><p><strong>API ç­¾åè®¤è¯æ˜¯ä¸€ä¸ªå¾ˆçµæ´»çš„è®¾è®¡ï¼Œå…·ä½“è¦æœ‰å“ªä¸ªå‚æ•°ã€å‚æ•°åå¦‚ä½•éœ€è¦æ ¹æ®åœºæ™¯æ¥è®¾è®¡ã€‚æ¯”å¦‚ï¼š userIdã€ appIdã€versionã€å›ºå®šå€¼ç­‰</strong></p><h2 id="å¼€å‘ä¸€ä¸ªç®€å•æ˜“ç”¨çš„-SDK"><a href="#å¼€å‘ä¸€ä¸ªç®€å•æ˜“ç”¨çš„-SDK" class="headerlink" title="å¼€å‘ä¸€ä¸ªç®€å•æ˜“ç”¨çš„ SDK"></a>å¼€å‘ä¸€ä¸ªç®€å•æ˜“ç”¨çš„ SDK</h2><p>ç†æƒ³çŠ¶æ€ä¸‹ï¼šå¼€å‘è€…åªéœ€è¦å…³å¿ƒè°ƒç”¨å“ªäº›æ¥å£ã€ä¼ é€’å“ªäº›å‚æ•°ã€å°±è·Ÿè°ƒç”¨è‡ªå·±å†™çš„ä»£ç ä¸€æ ·ã€‚</p><p>å¼€å‘ starter çš„å¥½å¤„ï¼šå¼€å‘è€…å¼•å…¥åï¼Œå¯ä»¥ç›´æ¥åœ¨ application.yml ä¸­å†™é…ç½®ï¼Œè‡ªåŠ¨åˆ›å»ºå®¢æˆ·ç«¯</p><p><strong>spring-boot-configuration-processor çš„ä½œç”¨æ˜¯è‡ªåŠ¨ç”Ÿæˆé…ç½®çš„ä»£ç æç¤º</strong></p><h3 id="starter-çš„å¼€å‘æµç¨‹"><a href="#starter-çš„å¼€å‘æµç¨‹" class="headerlink" title="starter çš„å¼€å‘æµç¨‹"></a>starter çš„å¼€å‘æµç¨‹</h3><p>åˆå§‹åŒ–ï¼Œç¯å¢ƒä¾èµ–ï¼ˆä¸€å®šè¦ç§»é™¤ buildï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">   &lt;artifactId&gt;spring-boot-autoconfigure&lt;/artifactId&gt;</span><br><span class="line">   &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">   &lt;dependency&gt;</span><br><span class="line">   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">   &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;</span><br><span class="line">   &lt;optional&gt;<span class="literal">true</span>&lt;/optional&gt;</span><br><span class="line">   &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">   &lt;dependency&gt;</span><br><span class="line">   &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">   &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">   &lt;optional&gt;<span class="literal">true</span>&lt;/optional&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>ç¼–å†™é…ç½®ç±»ï¼ˆå¯åŠ¨ç±»ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">// èƒ½è¯»å– application ä¸­çš„é…ç½®å±æ€§</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(&quot;mofeng.client&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MofengClientConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String accessKey;</span><br><span class="line">    <span class="keyword">private</span> String secretKey;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MofengApiClient <span class="title function_">mofengApiClient</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MofengApiClient</span>(accessKey, secretKey);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨å†Œé…ç½®ç±»</p><p>resources&#x2F;META_INF&#x2F;spring.factories</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># starter</span><br><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration=com.mofeng.mofengclientsdk.MofengClientConfig</span><br></pre></td></tr></table></figure><p>mvn install æ‰“åŒ…ä¸ºæœ¬åœ°é¡¹ç›®</p><p>åˆ›å»ºæ–°é¡¹ç›®ï¼ˆå¤ç”¨ server é¡¹ç›®ï¼‰ã€æµ‹è¯•</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;äºŒã€API-å¼€æ”¾å¹³å°-æ¨¡æ‹Ÿæ¥å£&quot;&gt;&lt;a href=&quot;#äºŒã€API-å¼€æ”¾å¹³å°-æ¨¡æ‹Ÿæ¥å£&quot; class=&quot;headerlink&quot; title=&quot;äºŒã€API å¼€æ”¾å¹³å°-æ¨¡æ‹Ÿæ¥å£&quot;&gt;&lt;/a&gt;äºŒã€API å¼€æ”¾å¹³å°-æ¨¡æ‹Ÿæ¥å£&lt;/h1&gt;&lt;h2 id=&quot;æ¨¡æ‹Ÿæ¥å£é¡¹ç›®-mofeng</summary>
      
    
    
    
    <category term="API å¼€æ”¾å¹³å°" scheme="http://example.com/categories/API-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0/"/>
    
    
    <category term="æ˜Ÿçƒé¡¹ç›®" scheme="http://example.com/tags/%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>åˆ›å»º starter æ­¥éª¤</title>
    <link href="http://example.com/2022/12/22/%E5%88%9B%E5%BB%BAstarter%E6%AD%A5%E9%AA%A4/"/>
    <id>http://example.com/2022/12/22/%E5%88%9B%E5%BB%BAstarter%E6%AD%A5%E9%AA%A4/</id>
    <published>2022-12-22T04:04:12.616Z</published>
    <updated>2023-08-04T14:57:32.822Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åˆ›å»ºstarteræ­¥éª¤"><a href="#åˆ›å»ºstarteræ­¥éª¤" class="headerlink" title="åˆ›å»ºstarteræ­¥éª¤"></a>åˆ›å»ºstarteræ­¥éª¤</h1><p>1.æ–°å»ºä¸€ä¸ª spring boot åˆå§‹åŒ–é¡¹ç›®<br><img src="https://raw.githubusercontent.com/lumofeng/blog-img/main/202308042252973.png" alt="202211230811084"></p><p>2.æ·»åŠ ä¾èµ–ï¼ŒLombok, Spring Configuration Processor</p><p>Spring Configuration Processor çš„ä½œç”¨æ˜¯è‡ªåŠ¨ç”Ÿæˆä»£ç æç¤º<img src="https://raw.githubusercontent.com/lumofeng/blog-img/main/202308042253228.png" alt="202211230812657"></p><p>3.ä¿®æ”¹ pom æ–‡ä»¶çš„ç‰ˆæœ¬å·ï¼Œå¹¶åˆ é™¤ build<br><img src="https://raw.githubusercontent.com/lumofeng/blog-img/main/202308042254485.png" alt="202211230816110"></p><p>â€‹<img src="https://raw.githubusercontent.com/lumofeng/blog-img/main/202308042254613.png" alt="202211230817635"></p><p>4.åˆ é™¤åŸæœ¬è‡ªåŠ¨åˆ›å»ºçš„ä¸»ç±»ï¼Œæ–°å»ºä¸€ä¸ªç±», å¹¶æ·»åŠ éœ€è¦ç”¨åˆ°çš„ä¾èµ–</p><p><img src="https://raw.githubusercontent.com/lumofeng/blog-img/main/202308042254929.png" alt="202211230823121"></p><p>5.åœ¨ resources ç›®å½•ä¸‹æ–°å»º META-INF ç›®å½•ï¼Œå¹¶åˆ›å»º spring.factories æ–‡ä»¶ï¼Œå¹¶æŒ‡å®šé…ç½®ç±»çš„ç›®å½•</p><p><img src="https://raw.githubusercontent.com/lumofeng/blog-img/main/202308042255372.png" alt="202211230828618"></p><p>6.install æ‰“åŒ…æ„å»ºåœ¨æœ¬åœ°çš„ä»“åº“</p><p><img src="https://raw.githubusercontent.com/lumofeng/blog-img/main/202308042255073.png" alt="202211230831488"></p><p>7.å¤åˆ¶ groupId, artifactId, version,å¯ä»¥åœ¨å…¶ä»–é¡¹ç›®ä¸­æ·»åŠ ä¸ºä¾èµ–</p><p><img src="https://raw.githubusercontent.com/lumofeng/blog-img/main/202308042256335.png" alt="202211230833985"></p><p><img src="https://raw.githubusercontent.com/lumofeng/blog-img/main/202308042256790.png" alt="202211230834598"></p><p>8.åœ¨é…ç½®æ–‡ä»¶å½“ä¸­å°±å¯ä»¥å¼•ç”¨ starter å½“ä¸­è®¾ç½®çš„å±æ€§</p><p><img src="https://raw.githubusercontent.com/lumofeng/blog-img/main/202308042256332.png" alt="202211230836055"></p><p>åˆšæ‰åœ¨ starter é…ç½®ç±»ä¸­å®šä¹‰çš„å±æ€§</p><p><img src="https://raw.githubusercontent.com/lumofeng/blog-img/main/202308042257631.png" alt="202211230838324"></p><p>å¯ä»¥å¼•å…¥ starter å½“ä¸­çš„ç±»æˆ–è€…å±æ€§</p><p><img src="https://raw.githubusercontent.com/lumofeng/blog-img/main/202308042257154.png" alt="202211230839280"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åˆ›å»ºstarteræ­¥éª¤&quot;&gt;&lt;a href=&quot;#åˆ›å»ºstarteræ­¥éª¤&quot; class=&quot;headerlink&quot; title=&quot;åˆ›å»ºstarteræ­¥éª¤&quot;&gt;&lt;/a&gt;åˆ›å»ºstarteræ­¥éª¤&lt;/h1&gt;&lt;p&gt;1.æ–°å»ºä¸€ä¸ª spring boot åˆå§‹åŒ–é¡¹ç›®&lt;br&gt;&lt;img s</summary>
      
    
    
    
    <category term="API å¼€æ”¾å¹³å°" scheme="http://example.com/categories/API-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0/"/>
    
    
    <category term="æ˜Ÿçƒé¡¹ç›®" scheme="http://example.com/tags/%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>GateWay è½¬å‘è¯·æ±‚</title>
    <link href="http://example.com/2022/12/22/GateWay-%E8%BD%AC%E5%8F%91%E8%AF%B7%E6%B1%82/"/>
    <id>http://example.com/2022/12/22/GateWay-%E8%BD%AC%E5%8F%91%E8%AF%B7%E6%B1%82/</id>
    <published>2022-12-22T04:04:12.611Z</published>
    <updated>2022-12-22T03:57:33.804Z</updated>
    
    <content type="html"><![CDATA[<h1 id="äº”ã€Gateway-è½¬å‘è¯·æ±‚"><a href="#äº”ã€Gateway-è½¬å‘è¯·æ±‚" class="headerlink" title="äº”ã€Gateway è½¬å‘è¯·æ±‚"></a>äº”ã€Gateway è½¬å‘è¯·æ±‚</h1><h2 id="ä½¿ç”¨åˆ°çš„ç‰¹æ€§"><a href="#ä½¿ç”¨åˆ°çš„ç‰¹æ€§" class="headerlink" title="ä½¿ç”¨åˆ°çš„ç‰¹æ€§"></a>ä½¿ç”¨åˆ°çš„ç‰¹æ€§</h2><ol><li>è·¯ç”±</li><li><del>è´Ÿè½½å‡è¡¡ï¼ˆéœ€è¦ç”¨åˆ°æ³¨å†Œä¸­å¿ƒï¼‰</del></li><li>ç»Ÿä¸€é‰´æƒ</li><li><del>è·¨åŸŸ</del></li><li>ç»Ÿä¸€ä¸šåŠ¡å¤„ç†ï¼ˆç¼“å­˜ï¼‰</li><li>è®¿é—®æ§åˆ¶</li><li><del>å‘å¸ƒæ§åˆ¶</del></li><li>æµé‡æŸ“è‰²</li><li><del>æ¥å£ä¿æŠ¤</del><ol><li>é™åˆ¶è¯·æ±‚</li><li>ä¿¡æ¯è„±æ•</li><li>é™çº§ï¼ˆç†”æ–­ï¼‰</li><li>é™æµï¼šå­¦ä¹ ä»¤ç‰Œæ¡¶ç®—æ³•ã€å­¦ä¹ æ¼æ¡¶ç®—æ³•ï¼Œå­¦ä¹ ä¸€ä¸‹ RedisLimitHandler</li><li>è¶…æ—¶æ—¶é—´</li></ol></li><li>ç»Ÿä¸€æ—¥å¿—</li><li><del>ç»Ÿä¸€æ–‡æ¡£</del></li></ol><h2 id="ä¸šåŠ¡é€»è¾‘"><a href="#ä¸šåŠ¡é€»è¾‘" class="headerlink" title="ä¸šåŠ¡é€»è¾‘"></a>ä¸šåŠ¡é€»è¾‘</h2><ol><li>ç”¨æˆ·å‘é€è¯·æ±‚åˆ° API ç½‘å…³</li><li>è¯·æ±‚æ—¥å¿—</li><li>ï¼ˆé»‘ç™½åå•ï¼‰</li><li>ç”¨æˆ·é‰´æƒï¼ˆåˆ¤æ–­ accessKey, secretKey æ˜¯å¦åˆæ³•ï¼‰</li><li>è¯·æ±‚çš„æ¨¡æ‹Ÿæ¥å£æ˜¯å¦å­˜åœ¨</li><li><strong>è¯·æ±‚è½¬å‘ï¼Œè°ƒç”¨æ¨¡æ‹Ÿæ¥å£</strong></li><li>å“åº”æ—¥å¿—</li><li>è°ƒç”¨æˆåŠŸï¼Œæ¬¡æ•° + 1</li><li>è°ƒç”¨å¤±è´¥ï¼Œè¿”å›ä¸€ä¸ªè§„èŒƒçš„é”™è¯¯ç </li></ol><h2 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h2><h3 id="1-è¯·æ±‚è½¬å‘"><a href="#1-è¯·æ±‚è½¬å‘" class="headerlink" title="1.è¯·æ±‚è½¬å‘"></a>1.è¯·æ±‚è½¬å‘</h3><p>ä½¿ç”¨å‰ç¼€åŒ¹é…æ–­è¨€ï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-path-route-predicate-factory">https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-path-route-predicate-factory</a></p><p>æ‰€æœ‰è·¯å¾„ä¸ºï¼š &#x2F;api&#x2F;** çš„è¯·æ±‚è¿›è¡Œè½¬å‘ï¼Œè½¬å‘åˆ° <a href="http://localhost:8123/api/">http://localhost:8123/api/</a>**</p><p>æ¯”å¦‚è¯·æ±‚ç½‘å…³ï¼š <a href="http://localhost:8090/api/name/get/?name=mofeng">http://localhost:8090/api/name/get/?name=mofeng</a></p><p>è½¬å‘åˆ°ï¼š<a href="http://localhost:8123/api/name/get/?name=mofeng">http://localhost:8123/api/name/get/?name=mofeng</a></p><p>é…ç½®æ–‡ä»¶æ·»åŠ å†…å®¹ï¼Œ application.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">api_route</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">http://localhost:8123</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/api/**</span></span><br></pre></td></tr></table></figure><h3 id="2-ç¼–å†™ä¸šåŠ¡é€»è¾‘"><a href="#2-ç¼–å†™ä¸šåŠ¡é€»è¾‘" class="headerlink" title="2.ç¼–å†™ä¸šåŠ¡é€»è¾‘"></a>2.ç¼–å†™ä¸šåŠ¡é€»è¾‘</h3><p>ä½¿ç”¨äº† GlobalFilter ï¼ˆç¼–ç¨‹å¼ï¼‰ï¼Œå…¨å±€è¯·æ±‚æ‹¦æˆªå¤„ç†ï¼ˆç±»ä¼¼ AOPï¼‰</p><p>å› ä¸ºç½‘å…³é¡¹ç›®æ²¡å¼•å…¥ MyBatis ç­‰æ“ä½œæ•°æ®åº“çš„ç±»åº“ï¼Œå¦‚æœè¯¥æ“ä½œè¾ƒä¸ºå¤æ‚ï¼Œå¯ä»¥æœ‰ backend å¢åˆ æ”¹æŸ¥é¡¹ç›®æä¾›æ¥å£ï¼Œç›´æ¥è°ƒç”¨ï¼Œä¸éœ€è¦é‡å¤å†™é€»è¾‘ã€‚</p><ul><li>HTTP è¯·æ±‚ï¼ˆHTTPClientã€ ç”¨ RestTemplateã€ Feignï¼‰</li><li>RPCï¼ˆDubbo)</li></ul><h3 id="å­˜åœ¨çš„é—®é¢˜"><a href="#å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="å­˜åœ¨çš„é—®é¢˜"></a>å­˜åœ¨çš„é—®é¢˜</h3><p>é¢„æœŸç­‰æ¨¡æ‹Ÿæ¥å£è°ƒç”¨å®Œæˆï¼Œæ‰è®°å½•å“åº”æ—¥å¿—ã€ç»Ÿè®¡è°ƒç”¨æ¬¡æ•°</p><p>ä½†ç°å®æ˜¯ chain.filter æ–¹æ³•ç«‹å³è¿”å›äº†ï¼ŒçŸ¥é“ filter è¿‡æ»¤å™¨ return åæ‰è°ƒç”¨æ¨¡æ‹Ÿæ¥å£</p><p>åŸå› æ˜¯ï¼šchain.filter æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œç†è§£ä¸ºå‰ç«¯çš„ promise</p><p>è§£å†³æ–¹æ¡ˆï¼šåˆ©ç”¨ response è£…é¥°è€…ï¼Œå¢å¼ºåŸæœ‰ response çš„å¤„ç†èƒ½åŠ›</p><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.csdn.net/qq_19636353/article/details/126759522">https://blog.csdn.net/qq_19636353/article/details/126759522</a></p><p>å…¶ä»–å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/zx156955/article/details/121670681">https://blog.csdn.net/zx156955/article/details/121670681</a></p><p><a href="https://blog.csdn.net/weixin_43933728/article/details/121359727?spm=1001.2014.3001.5501">https://blog.csdn.net/weixin_43933728/article/details/121359727?spm=1001.2014.3001.5501</a></p><p><a href="https://blog.csdn.net/qq_39529562/article/details/108911983">https://blog.csdn.net/qq_39529562/article/details/108911983</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;äº”ã€Gateway-è½¬å‘è¯·æ±‚&quot;&gt;&lt;a href=&quot;#äº”ã€Gateway-è½¬å‘è¯·æ±‚&quot; class=&quot;headerlink&quot; title=&quot;äº”ã€Gateway è½¬å‘è¯·æ±‚&quot;&gt;&lt;/a&gt;äº”ã€Gateway è½¬å‘è¯·æ±‚&lt;/h1&gt;&lt;h2 id=&quot;ä½¿ç”¨åˆ°çš„ç‰¹æ€§&quot;&gt;&lt;a href=&quot;</summary>
      
    
    
    
    <category term="API å¼€æ”¾å¹³å°" scheme="http://example.com/categories/API-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0/"/>
    
    
    <category term="æ˜Ÿçƒé¡¹ç›®" scheme="http://example.com/tags/%E6%98%9F%E7%90%83%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>ç»„é˜ŸåŠŸèƒ½è®¾è®¡</title>
    <link href="http://example.com/2022/12/08/%E7%BB%84%E9%98%9F%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/"/>
    <id>http://example.com/2022/12/08/%E7%BB%84%E9%98%9F%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/</id>
    <published>2022-12-08T08:06:28.952Z</published>
    <updated>2022-12-08T08:03:03.990Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç»„é˜ŸåŠŸèƒ½"><a href="#ç»„é˜ŸåŠŸèƒ½" class="headerlink" title="ç»„é˜ŸåŠŸèƒ½"></a>ç»„é˜ŸåŠŸèƒ½</h1><h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><p>éœ€è¦è·Ÿè‡ªå·±ä¸€èµ·å‚åŠ ç«èµ›ã€åšé¡¹ç›®ã€å­¦ä¹ ï¼Œå¯ä»¥å‘èµ·é˜Ÿä¼æˆ–è€…åŠ å…¥åˆ«äººçš„é˜Ÿä¼</p><h3 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h3><ol><li><p>ç”¨æˆ·å¯ä»¥<strong>åˆ›å»º</strong>é˜Ÿä¼ï¼Œè®¾ç½®é˜Ÿä¼çš„äººæ•°ã€é˜Ÿä¼åç§°ï¼ˆæ ‡é¢˜ï¼‰ã€æè¿°ã€è¶…æ—¶æ—¶é—´ P0<br>é˜Ÿé•¿ã€å‰©ä½™çš„äººæ•°</p><p>èŠå¤©</p><p>å…¬å¼€æˆ–ç§å¯†æˆ–åŠ å¯†</p><p>ç”¨æˆ·æœ€å¤šåˆ›å»º 5 ä¸ªé˜Ÿä¼</p></li><li><p>å±•ç¤ºé˜Ÿä¼åˆ—è¡¨ï¼Œæ ¹æ®åç§°æœç´¢é˜Ÿä¼ P0ï¼Œä¿¡æ¯æµä¸­ä¸å±•ç¤ºå·²è¿‡æœŸçš„é˜Ÿä¼</p></li><li><p>ä¿®æ”¹é˜Ÿä¼ä¿¡æ¯  P0~P1</p></li><li><p>ç”¨æˆ·å¯ä»¥åŠ å…¥é˜Ÿä¼ï¼ˆå…¶ä»–äººã€æœªæ»¡äººã€æœªè¿‡æœŸï¼‰ï¼Œå…è®¸åŠ å…¥å¤šä¸ªé˜Ÿä¼ï¼Œä½†æ˜¯æœ‰ä¸Šé™ P0 </p></li><li><p>æ˜¯å¦éœ€è¦é˜Ÿé•¿åŒæ„ï¼Ÿç­›é€‰å®¡æ‰¹ï¼Ÿ</p></li><li><p>ç”¨æˆ·å¯ä»¥é€€å‡ºé˜Ÿä¼ï¼ˆå¦‚æœé˜Ÿé•¿é€€å‡ºï¼Œæƒé™è½¬ç§»ç»™ç¬¬äºŒæ—©åŠ å…¥çš„ç”¨æˆ· â€“ å…ˆæ¥å…ˆåˆ°ï¼‰P1</p></li><li><p>é˜Ÿé•¿å¯ä»¥è§£æ•£é˜Ÿä¼ P0</p></li><li><p>åˆ†äº«é˜Ÿä¼ &#x3D;&gt; é‚€è¯·å…¶ä»–ç”¨æˆ·åŠ å…¥é˜Ÿä¼ P1 </p><p>ä¸šåŠ¡æµç¨‹ï¼š<br>ï¼ˆ1ï¼‰ç”Ÿæˆåˆ†äº«è¿æ¥ï¼ˆåˆ†äº«äºŒç»´ç ï¼‰<br>ï¼ˆ2ï¼‰ç”¨æˆ·è®¿é—®é“¾æ¥ï¼Œå¯ä»¥ç‚¹å‡»åŠ å…¥</p></li></ol><p></p><h3 id="ç³»ç»Ÿï¼ˆæ¥å£ï¼‰è®¾è®¡"><a href="#ç³»ç»Ÿï¼ˆæ¥å£ï¼‰è®¾è®¡" class="headerlink" title="ç³»ç»Ÿï¼ˆæ¥å£ï¼‰è®¾è®¡"></a>ç³»ç»Ÿï¼ˆæ¥å£ï¼‰è®¾è®¡</h3><h4 id="1-åˆ›å»ºé˜Ÿä¼"><a href="#1-åˆ›å»ºé˜Ÿä¼" class="headerlink" title="1.åˆ›å»ºé˜Ÿä¼"></a>1.åˆ›å»ºé˜Ÿä¼</h4><p>ç”¨æˆ·å¯ä»¥<strong>åˆ›å»º</strong>é˜Ÿä¼ï¼Œè®¾ç½®é˜Ÿä¼çš„äººæ•°ã€é˜Ÿä¼åç§°ï¼ˆæ ‡é¢˜ï¼‰ã€æè¿°ã€è¶…æ—¶æ—¶é—´ P0<br>é˜Ÿé•¿ã€å‰©ä½™çš„äººæ•°</p><p>èŠå¤©</p><p>å…¬å¼€æˆ–ç§å¯†æˆ–åŠ å¯†</p><p>ç”¨æˆ·æœ€å¤šåˆ›å»º 5 ä¸ªé˜Ÿä¼</p><ol><li>è¯·æ±‚å‚æ•°æ˜¯å¦ä¸ºç©º</li><li>æ˜¯å¦ç™»å½•ï¼Œä¸ºç™»å½•ä¸å…è®¸åˆ›å»º</li><li>æ ¡éªŒä¿¡æ¯<br>a. é˜Ÿä¼äººæ•° &gt; 1 ä¸” &lt;&#x3D; 20<br>b. é˜Ÿä¼æ ‡é¢˜å°äº 20<br>c. æè¿° &lt;&#x3D; 512<br>d. status æ˜¯å¦å…¬å¼€ï¼ˆintï¼‰ä¸ä¼ é»˜è®¤ä¸º0ï¼ˆå…¬å¼€ï¼‰<br>e. å¦‚æœ status æ˜¯åŠ å¯†çŠ¶æ€ï¼Œä¸€å®šè¦æœ‰å¯†ç ï¼Œä¸”å¯†ç  &lt;&#x3D; 32<br>f. è¶…æ—¶æ—¶é—´ &gt; å½“å‰æ—¶é—´<br>g.æ ¡éªŒç”¨æˆ·æœ€å¤šåˆ›å»º 5 ä¸ªé˜Ÿä¼</li><li>æ’å…¥é˜Ÿä¼ä¿¡æ¯åˆ°é˜Ÿä¼è¡¨</li><li>æ’å…¥ç”¨æˆ· &#x3D;&gt; é˜Ÿä¼å…³ç³»åˆ°å…³ç³»è¡¨</li></ol><h4 id="2-æŸ¥è¯¢é˜Ÿä¼åˆ—è¡¨"><a href="#2-æŸ¥è¯¢é˜Ÿä¼åˆ—è¡¨" class="headerlink" title="2.æŸ¥è¯¢é˜Ÿä¼åˆ—è¡¨"></a>2.æŸ¥è¯¢é˜Ÿä¼åˆ—è¡¨</h4><p>å±•ç¤ºé˜Ÿä¼åˆ—è¡¨ï¼Œæ ¹æ®åç§°æœç´¢é˜Ÿä¼ P0ï¼Œä¿¡æ¯æµä¸­ä¸å±•ç¤ºå·²è¿‡æœŸçš„é˜Ÿä¼</p><ol><li>ä»è¯·æ±‚å‚æ•°ä¸­å–å‡ºé˜Ÿä¼åç§°ç­‰æŸ¥è¯¢æ¡ä»¶ï¼Œå¦‚æœå­˜åœ¨åˆ™ä½œä¸ºæŸ¥è¯¢æ¡ä»¶</li><li>ä¸å±•ç¤ºå·²è¿‡æœŸçš„é˜Ÿä¼ï¼ˆæ ¹æ®è¿‡æœŸæ—¶é—´ç­›é€‰ï¼‰</li><li>å¯ä»¥é€šè¿‡æŸä¸ª<strong>å…³é”®å­—</strong>åŒæ—¶å¯¹åç§°å’Œæè¿°æŸ¥è¯¢</li><li><strong>åªæœ‰ç®¡ç†å‘˜æ‰èƒ½æŸ¥çœ‹åŠ å¯†è¿˜æœ‰éå…¬å¼€çš„é˜Ÿä¼</strong></li><li>å…³è”æŸ¥è¯¢å·²åŠ å…¥é˜Ÿä¼çš„ç”¨æˆ·ä¿¡æ¯</li><li><strong>å…³è”æŸ¥è¯¢å·²åŠ å…¥é˜Ÿä¼çš„ç”¨æˆ·ä¿¡æ¯ï¼ˆå¯èƒ½è€—è´¹æ€§èƒ½ï¼Œå»ºè®®ç”¨ SQL å®ç°ï¼‰</strong></li></ol><p>å®ç°æ–¹å¼ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span> æŸ¥è¯¢é˜Ÿä¼å’Œåˆ›å»ºäººä¿¡æ¯</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> team t <span class="keyword">left</span> <span class="keyword">join</span> <span class="keyword">user</span> u <span class="keyword">on</span> t.userId <span class="operator">=</span> u.id</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> æŸ¥è¯¢é˜Ÿä¼å’Œå·²åŠ å…¥é˜Ÿä¼æˆå‘˜çš„ä¿¡æ¯</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> team t</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> user_team ut <span class="keyword">on</span> t.id <span class="operator">=</span> ut.teamId</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> <span class="keyword">user</span> u <span class="keyword">on</span> ut.userId <span class="operator">=</span> u.id</span><br></pre></td></tr></table></figure><h4 id="3-ä¿®æ”¹é˜Ÿä¼ä¿¡æ¯"><a href="#3-ä¿®æ”¹é˜Ÿä¼ä¿¡æ¯" class="headerlink" title="3.ä¿®æ”¹é˜Ÿä¼ä¿¡æ¯"></a>3.ä¿®æ”¹é˜Ÿä¼ä¿¡æ¯</h4><ol><li>åˆ¤æ–­è¯·æ±‚å‚æ•°æ˜¯å¦ä¸ºç©º</li><li>æŸ¥è¯¢é˜Ÿä¼æ˜¯å¦å­˜åœ¨</li><li>åªæœ‰ç®¡ç†å‘˜æˆ–è€…é˜Ÿä¼çš„åˆ›å»ºè€…å¯ä»¥ä¿®æ”¹</li><li>å¦‚æœä¼ å…¥çš„æ–°å€¼å’Œè€å€¼ä¸€è‡´ï¼Œåˆ™ä¸éœ€è¦ update ï¼ˆé™ä½æ•°æ®åº“ä½¿ç”¨æ¬¡æ•°ï¼‰</li><li><strong>å¦‚æœé˜Ÿä¼çŠ¶æ€ä¸ºåŠ å¯†ï¼Œä¿®æ”¹æ—¶å¿…é¡»å¸¦å¯†ç </strong></li><li>æ›´æ–°é˜Ÿä¼ä¿¡æ¯</li></ol><h4 id="4-ç”¨æˆ·å¯ä»¥åŠ å…¥é˜Ÿä¼"><a href="#4-ç”¨æˆ·å¯ä»¥åŠ å…¥é˜Ÿä¼" class="headerlink" title="4.ç”¨æˆ·å¯ä»¥åŠ å…¥é˜Ÿä¼"></a>4.ç”¨æˆ·å¯ä»¥åŠ å…¥é˜Ÿä¼</h4><p>å…¶ä»–äººã€é˜Ÿä¼æœªæ»¡ã€æœªè¿‡æœŸã€å…è®¸åŠ å…¥è¿‡ä¸ªé˜Ÿä¼ï¼Œä½†æ˜¯æœ‰ä¸Šçº¿ P0</p><ol><li>ç”¨æˆ·æœ€å¤šåŠ å…¥ 5 ä¸ªé˜Ÿä¼</li><li>é˜Ÿä¼å¿…é¡»å­˜åœ¨ï¼Œåªèƒ½åŠ å…¥æœªæ»¡å‘˜ã€æœªè¿‡æœŸçš„é˜Ÿä¼</li><li>ä¸èƒ½åŠ å…¥è‡ªå·±çš„é˜Ÿä¼ï¼Œä¸èƒ½é‡å¤åŠ å…¥å·²åŠ å…¥çš„é˜Ÿä¼ï¼ˆå¹‚ç­‰æ€§ï¼‰</li><li>ç¦æ­¢åŠ å…¥ç§æœ‰çš„é˜Ÿä¼</li><li>å¦‚æœåŠ å…¥çš„é˜Ÿä¼æ˜¯åŠ å¯†çš„ï¼Œéœ€è¦åŒ¹é…å¯†ç </li><li>ä¿®æ”¹é˜Ÿä¼ä¿¡æ¯ï¼Œè¡¥å……äººæ•°</li><li>æ–°å¢é˜Ÿä¼-ç”¨æˆ·å…³è”ä¿¡æ¯</li></ol><p><strong>æ³¨æ„ï¼ŒåŠ ä¸Šäº‹åŠ¡æ³¨è§£ @Trancational</strong></p><h4 id="5-ç”¨æˆ·é€€å‡ºé˜Ÿä¼"><a href="#5-ç”¨æˆ·é€€å‡ºé˜Ÿä¼" class="headerlink" title="5.ç”¨æˆ·é€€å‡ºé˜Ÿä¼"></a>5.ç”¨æˆ·é€€å‡ºé˜Ÿä¼</h4><p>è¯·æ±‚å‚æ•°ï¼šé˜Ÿä¼ id</p><ol><li>æ ¡éªŒè¯·æ±‚å‚æ•°</li><li>æ ¡éªŒé˜Ÿä¼æ˜¯å¦å­˜åœ¨</li><li>æ ¡éªŒæˆ‘æ˜¯å¦å·²åŠ å…¥é˜Ÿä¼</li><li>å¦‚æœé˜Ÿä¼<ol><li>åªå‰©ä¸‹ä¸€äººï¼Œè§£æ•£é˜Ÿä¼</li><li>å¦‚æœæ˜¯é˜Ÿé•¿é€€å‡ºï¼Œæƒé™è½¬ç§»ç»™ç¬¬äºŒä¸ªäººï¼ˆæ ¹æ® JoinTime)</li><li>éé˜Ÿé•¿ï¼Œè‡ªå·±é€€å‡ºé˜Ÿä¼ï¼Œé˜Ÿä¼äººæ•° -1</li></ol></li></ol><h4 id="6-é˜Ÿé•¿è§£æ•£é˜Ÿä¼"><a href="#6-é˜Ÿé•¿è§£æ•£é˜Ÿä¼" class="headerlink" title="6.é˜Ÿé•¿è§£æ•£é˜Ÿä¼"></a>6.é˜Ÿé•¿è§£æ•£é˜Ÿä¼</h4><p>è¯·æ±‚å‚æ•°ï¼šé˜Ÿä¼ id</p><ol><li>æ ¡éªŒè¯·æ±‚å‚æ•°</li><li>æ ¡éªŒé˜Ÿä¼æ˜¯å¦å­˜åœ¨</li><li>æ ¡éªŒæ˜¯å¦ä¸ºé˜Ÿé•¿</li><li>ç§»é™¤æ‰€æœ‰åŠ å…¥é˜Ÿä¼çš„å…³è”ä¿¡æ¯</li><li>åˆ é™¤é˜Ÿä¼</li></ol><p><strong>æ³¨æ„ï¼šä¸€å®šè¦åŠ ä¸Šäº‹åŠ¡æ³¨è§£ï¼</strong></p><h4 id="7-è·å–å½“å‰ç”¨æˆ·å·²åŠ å…¥çš„é˜Ÿä¼"><a href="#7-è·å–å½“å‰ç”¨æˆ·å·²åŠ å…¥çš„é˜Ÿä¼" class="headerlink" title="7.è·å–å½“å‰ç”¨æˆ·å·²åŠ å…¥çš„é˜Ÿä¼"></a>7.è·å–å½“å‰ç”¨æˆ·å·²åŠ å…¥çš„é˜Ÿä¼</h4><h4 id="8-è·å–å½“å‰ç”¨æˆ·åˆ›å»ºçš„é˜Ÿä¼"><a href="#8-è·å–å½“å‰ç”¨æˆ·åˆ›å»ºçš„é˜Ÿä¼" class="headerlink" title="8.è·å–å½“å‰ç”¨æˆ·åˆ›å»ºçš„é˜Ÿä¼"></a>8.è·å–å½“å‰ç”¨æˆ·åˆ›å»ºçš„é˜Ÿä¼</h4><p>å¤ç”¨ listTeam æ–¹æ³•ï¼Œåªæ–°å¢æŸ¥è¯¢æ¡ä»¶ï¼Œä¸åšä¿®æ”¹ï¼ˆå¼€é—­åŸåˆ™ï¼‰</p><h3 id="ä½¿ç”¨äº‹åŠ¡æ³¨è§£"><a href="#ä½¿ç”¨äº‹åŠ¡æ³¨è§£" class="headerlink" title="ä½¿ç”¨äº‹åŠ¡æ³¨è§£"></a>ä½¿ç”¨äº‹åŠ¡æ³¨è§£</h3><p>@Trancational(rollbackFor &#x3D; Exception.class)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç»„é˜ŸåŠŸèƒ½&quot;&gt;&lt;a href=&quot;#ç»„é˜ŸåŠŸèƒ½&quot; class=&quot;headerlink&quot; title=&quot;ç»„é˜ŸåŠŸèƒ½&quot;&gt;&lt;/a&gt;ç»„é˜ŸåŠŸèƒ½&lt;/h1&gt;&lt;h3 id=&quot;åº”ç”¨åœºæ™¯&quot;&gt;&lt;a href=&quot;#åº”ç”¨åœºæ™¯&quot; class=&quot;headerlink&quot; title=&quot;åº”ç”¨åœºæ™¯&quot;&gt;&lt;/a</summary>
      
    
    
    
    <category term="ä¼™ä¼´åŒ¹é…ç³»ç»Ÿ" scheme="http://example.com/categories/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%B3%BB%E7%BB%9F/"/>
    
    
  </entry>
  
  <entry>
    <title>æ•°æ®åº“è¡¨è®¾è®¡</title>
    <link href="http://example.com/2022/12/08/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E8%AE%BE%E8%AE%A1/"/>
    <id>http://example.com/2022/12/08/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E8%AE%BE%E8%AE%A1/</id>
    <published>2022-12-08T08:06:28.949Z</published>
    <updated>2022-12-08T08:01:55.563Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ•°æ®åº“è¡¨è®¾è®¡"><a href="#æ•°æ®åº“è¡¨è®¾è®¡" class="headerlink" title="æ•°æ®åº“è¡¨è®¾è®¡"></a>æ•°æ®åº“è¡¨è®¾è®¡</h3><h4 id="é˜Ÿä¼è¡¨-team"><a href="#é˜Ÿä¼è¡¨-team" class="headerlink" title="é˜Ÿä¼è¡¨ team"></a>é˜Ÿä¼è¡¨ team</h4><p>å­—æ®µï¼š</p><ul><li>id ä¸»é”® bigint ï¼ˆæœ€ç®€å•ã€è¿ç»­ï¼Œæ”¾ URL ä¸Šæ¯”è¾ƒç®€çŸ­ï¼Œä½†ç¼ºç‚¹æ˜¯çˆ¬è™«ï¼‰</li><li>name é˜Ÿä¼åç§°</li><li>decription æè¿°</li><li>maxNum æœ€å¤§äººæ•°</li><li>expireTime è¿‡æœŸæ—¶é—´</li><li>userId åˆ›å»ºäºº</li><li>status 0 - å…¬å¼€ï¼Œ 1- ç§å¯†ï¼Œ 2 - åŠ å¯†</li><li>password é˜Ÿä¼å¯†ç </li><li>createTime åˆ›å»ºæ—¶é—´</li><li>updateTime æ›´æ–°æ—¶é—´</li><li>isDelete æ˜¯å¦åˆ é™¤</li></ul><h4 id="ç”¨æˆ·-é˜Ÿä¼è¡¨-user-team"><a href="#ç”¨æˆ·-é˜Ÿä¼è¡¨-user-team" class="headerlink" title="ç”¨æˆ·-é˜Ÿä¼è¡¨ user_team"></a>ç”¨æˆ·-é˜Ÿä¼è¡¨ user_team</h4><p>å…³ç³»ï¼š</p><ol><li>ç”¨æˆ·åŠ å…¥äº†å“ªäº›é˜Ÿä¼ï¼Ÿ</li><li>é˜Ÿä¼æœ‰å“ªäº›ç”¨æˆ·ï¼Ÿ</li></ol><p>ä¸¤ç§å®ç°æ–¹å¼ï¼š</p><ol><li>å»ºç«‹ç”¨æˆ·-é˜Ÿä¼å…³ç³»è¡¨ teamId userId ï¼ˆä¾¿äºä¿®æ”¹ï¼ŒæŸ¥è¯¢æ€§èƒ½é«˜ä¸€ç‚¹ï¼Œä¸ç”¨å…¨è¡¨éå†ï¼‰</li><li>ç”¨æˆ·è¡¨è¡¥å……å·²åŠ å…¥çš„é˜Ÿä¼å­—æ®µï¼Œé˜Ÿä¼è¡¨è¡¥å……å·²åŠ å…¥çš„ç”¨æˆ·å­—æ®µï¼ˆä¾¿äºæŸ¥è¯¢ï¼Œä¸ç”¨å†™å¤šå¯¹å¤šè¿è¡¨æŸ¥è¯¢ä»£ç ï¼Œå¯ä»¥ç›´æ¥æ ¹æ®é˜Ÿä¼æŸ¥ç”¨æˆ·ã€æ ¹æ®ç”¨æˆ·æŸ¥é˜Ÿä¼ï¼‰</li></ol><p>å­—æ®µï¼š</p><ul><li>id ä¸»é”®</li><li>userId ç”¨æˆ· id</li><li>teamId é˜Ÿä¼ id</li><li>joinTime åŠ å…¥æ—¶é—´</li><li>createTime åˆ›å»ºæ—¶é—´</li><li>updateTime æ›´æ–°æ—¶é—´</li><li>isDelete æ˜¯å¦åˆ é™¤</li></ul><h3 id="ä¸ºä»€ä¹ˆéœ€è¦è¯·æ±‚å‚æ•°åŒ…è£…ç±»ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆéœ€è¦è¯·æ±‚å‚æ•°åŒ…è£…ç±»ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦è¯·æ±‚å‚æ•°åŒ…è£…ç±»ï¼Ÿ"></a>ä¸ºä»€ä¹ˆéœ€è¦è¯·æ±‚å‚æ•°åŒ…è£…ç±»ï¼Ÿ</h3><ol><li>è¯·æ±‚å‚æ•°åç§° &#x2F; ç±»å‹å’Œå®ä½“ç±»ä¸ä¸€æ ·</li><li>æœ‰ä¸€äº›å‚æ•°ç”¨ä¸åˆ°ï¼Œå¦‚æœè¦è‡ªåŠ¨ç”Ÿæˆæ¥å£æ–‡æ¡£ï¼Œä¼šå¢åŠ ç†è§£æˆæœ¬ï¼ˆå‚æ•°å¤ªå¤šï¼Œå†—ä½™ï¼‰</li><li>å¯¹ä¸ªå®ä½“ç±»æ˜ å°„åˆ°åŒä¸€ä¸ªå¯¹è±¡</li></ol><h3 id="ä¸ºä»€ä¹ˆéœ€è¦åŒ…è£…ç±»ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆéœ€è¦åŒ…è£…ç±»ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦åŒ…è£…ç±»ï¼Ÿ"></a>ä¸ºä»€ä¹ˆéœ€è¦åŒ…è£…ç±»ï¼Ÿ</h3><ol><li>å­˜åœ¨æœ‰äº›å­—æ®µéœ€è¦éšè—ï¼Œä¸èƒ½è¿”å›ç»™å‰ç«¯ï¼Œå¦‚ç”¨æˆ·å¯†ç </li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;æ•°æ®åº“è¡¨è®¾è®¡&quot;&gt;&lt;a href=&quot;#æ•°æ®åº“è¡¨è®¾è®¡&quot; class=&quot;headerlink&quot; title=&quot;æ•°æ®åº“è¡¨è®¾è®¡&quot;&gt;&lt;/a&gt;æ•°æ®åº“è¡¨è®¾è®¡&lt;/h3&gt;&lt;h4 id=&quot;é˜Ÿä¼è¡¨-team&quot;&gt;&lt;a href=&quot;#é˜Ÿä¼è¡¨-team&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    <category term="ä¼™ä¼´åŒ¹é…ç³»ç»Ÿ" scheme="http://example.com/categories/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%B3%BB%E7%BB%9F/"/>
    
    <category term="æ•°æ®åº“" scheme="http://example.com/categories/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
  </entry>
  
</feed>
